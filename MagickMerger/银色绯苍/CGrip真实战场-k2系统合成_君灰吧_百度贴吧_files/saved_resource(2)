_.Module.define({path:"pb/component/Passive",sub:{initial:function(a){this.loaded_count=0,this.jdom=$("#j_p_postlist");this.area_list=this.jdom.find("div.l_post");this.callback=a;this.loadInViewArea();this.bindEventOnWindowScroll()},bindEventOnWindowScroll:function(){var a=this;this.scroll_handler=function(b){a.loadInViewArea()};$(window).bind("scroll",this.scroll_handler)},unbindEventOnWindowScroll:function(){$(window).unbind("scroll",this.scroll_handler)},loadInViewArea:function(){var e=$(window).scrollTop();var g=$(window).height()+10;var f={min:Math.max((e-g),0),max:e+g};var a=null;for(var d=0;d<this.area_list.length;d++){var b=$(this.area_list[d]);var c={min:b.offset().top,max:b.offset().top+b.height()};if(b.attr("data-passive")==="loaded"){continue}else{if(Math.max(f.min,c.min)<Math.min(f.max,c.max)){b.attr("data-passive","loaded");this.loaded_count++;this.callback(b)}}}if(this.loaded_count===this.area_list.length){this.unbindEventOnWindowScroll()}}}});_.Module.define({path:"pb/widget/ForumListV3/Lzl",requires:["pb/component/Admin"],sub:{editor_entry:null,_reach_limit:false,_new_reply_num:0,initial:function(a){this.postJdom=a;this.jdom=null;this.mainDom=null;this.tailDom=null;this.mainData=null;this.tailData=null;this._init()},_init:function(){this._loadLzlContent();this._showJubao();this._bindEditorEntry();this._bindFoldClick();this._bindClick();this._closeForbiddenTip()},_bindFoldClick:function(){var a=this;this.tailDom.bind("click",function(b){var c=$(b.target);switch(c[0].tagName){case"A":if(PageData.user.is_login){a._unfoldLzl(c)}else{TbCom.process("User","buildLoginFrame",null,null,null,"lzl_reply")}break;case"SPAN":a._foldLzl(c);break;default:break}return false})},_closeForbiddenTip:function(){$(".j_lzl_thread_forbidden_tip").find(".j_lzl_forbidden_tip_close").on("click",function(){$(this).parent().parent().slideUp()})},_loadLzlContent:function(){var postJdom=this.postJdom;var lzlContent=postJdom.find(".j_lazy_lzl");this.jdom=this.postJdom.find(".j_lzl_wrapper");this.mainDom=this.jdom.find("div.j_lzl_container");this.tailDom=this.jdom.find("div.j_lzl_r");this.mainData=eval("("+this.mainDom.attr("data-field")+")");this.tailData=eval("("+this.tailDom.attr("data-field")+")");AntiAnswerLzl=new CaptchaReqCom({forumName:PageData.forum_name_u,forumId:PageData.forum_id,tid:PageData.thread.id,postType:"reply"})},_updateReplyNum:function(a){var b=0;if(a){b=a}else{this._new_reply_num++;var b=this.tailData.total_num*1+this._new_reply_num}this.tailDom.find("a.lzl_link_unfold").html("\u56de\u590d("+b+")")},_foldLzl:function(c){var a=this;if(LzlEditor.cur_sec){var b=LzlEditor.cur_sec;b.find("span.close").click();LzlEditor._s_p._ie6RelativeHack()}a.mainDom.slideUp("normal",function(){c.hide();a.tailDom.find("a.lzl_link_unfold").show()});$.stats.sendRequest("fr=tb0_forum&st_type=lzl_fold")},_unfoldLzl:function(c){var b=this;c.hide();this.tailDom.find("span.lzl_link_fold").show();if(LzlEditor._lzl==b){var a="";if(LzlEditor._s_p._se){a=LzlEditor._s_p._se.getHtml()}LzlEditor._lzl=null;LzlEditor._hide();LzlEditor.cur_sec.empty();LzlEditor.init(b);if(LzlEditor._s_p._se){LzlEditor._s_p._se.on("initcomplete",function(){LzlEditor._s_p._se.execCommand("inserthtml",a)})}LzlEditor._s_p._ie6RelativeHack();if(CaptchaLzl&&!CaptchaLzl.needUpdate){CaptchaLzl.reload()}LzlEditor.cur_sec.parent().show();b.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover()})}else{LzlEditor.init(b);LzlEditor._s_p._ie6RelativeHack();LzlEditor.cur_sec.parent().show();b.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover()})}$.stats.sendRequest("fr=tb0_forum&st_type=lzl_unfold")},_ajaxRefresh:function(){this._showJubao();this._bindEditorEntry();this._bindClick();this._closeForbiddenTip();if(PageData.is_posts_admin){var a=this.use("pb/component/Admin");a.loadLzlAdmin(this.mainDom)}},_showJubao:function(){if(!(PageData.power["delete"]||PageData.power["vipdel"])){var a="",b,c=PageData.power["vip_complain"]?"vip\u4e3e\u62a5":"\u4e3e\u62a5";if($.browser.msie&&$.browser.version<8){var b=$("div .lzl_cnt")}else{var b=this.jdom.find("li.j_lzl_s_p")}b.each(function(){var f=$(this).find("a").filter(function(){return $(this).attr("username")}).attr("username");var e="";if(PageData.user.name==f){var h="\u5220\u9664";var e=$.json.encode({delete_mine:1,user_name:f});var d='<a href="#" class="lzl_jb_in" data-checkun="un">'+h+"</a>&nbsp;|&nbsp;"}else{var g=$(this).data("field");if(!!g){var h=PageData.power["vip_complain"]?"vip\u4e3e\u62a5":"\u4e3e\u62a5";var i="window.open('http://tieba.baidu.com/complaint/info?type={type}&tid="+PageData.thread.id+"&pid="+g.pid+"&cid="+g.spid+"','newwindow', 'height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no');return false;";var d='<a href="#" class="lzl_jb_in" onclick="'+i.replace("{type}",0)+'">'+h+"</a>&nbsp;|&nbsp;"}else{d=""}}$(this).on("mouseover",function(){$(this).find(".lzl_jb").show()}).on("mouseout",function(){$(this).find(".lzl_jb").hide()}).find(".lzl_jb").hide().html(d).attr("delete-data",e)})}},asyncImage:function(c,b){var a=c.find("img."+b);if(a.length==0){return false}$.each(a,function(d,e){e.src=(e.getAttribute("data-passive")||e.getAttribute("src"))})},_bindClick:function(){var self=this;var ul=this.mainDom.find("ul.j_lzl_m_w");ul.unbind("click");ul.bind("click",function(event){var jTar=$(event.target);if(jTar[0].tagName==="A"){switch(jTar[0].className){case"j_lzl_m":self.asyncImage($("#"+jTar.attr("data-field")),"forasync");ul.find(".lzl_post_hidden").slideDown();ul.find(".j_pager").show();ul.find(".lzl_more").hide();$.stats.sendRequest("fr=tb0_forum&st_type=lzl_more");return false;case"lzl_s_r":if(PageData.user.is_login){self._fastReply(jTar)}else{TbCom.process("User","buildLoginFrame",null,null,null,"lzl_interact")}return false;case"":if(jTar.parent().hasClass("j_pager")){window.global.shieldPost();var data=eval("("+jTar.parent().parent().attr("data-field")+")");var pars=jTar.attr("href").split("#");var pn=parseInt(pars[1]);var _pars="fr=tb0_forum&st_type=lzl_pager&pn="+pn;if(pn==data.total_page){_pars+="&st_value=last"}$.stats.sendRequest(_pars);self._turnPage(self,pn);return false}break;default:break}}})},_bindEditorEntry:function(){var a=this;this.editor_entry=this.mainDom.find("p.j_lzl_p").bind("click",function(){if(!PageData.user.is_login){TbCom.process("User","buildLoginFrame",null,null,null,"too_reply");return false}if(LzlEditor._lzl==a&&LzlEditor.cur_sec.css("display")!="none"){if(!LzlEditor._s_p._getHtml()){LzlEditor._hide()}else{LzlEditor._s_p._se.setHtml("")}}else{LzlEditor.init(a)}return false})},_fastReply:function(jTar){var li=jTar.parents(".j_lzl_s_p");var data=eval("("+li.attr("data-field")+")");var _html="\u56de\u590d&nbsp;"+data.user_name+"&nbsp;:";if(LzlEditor._lzl!=this){LzlEditor.init(this);if(LzlEditor._s_p._se){LzlEditor._s_p._se.on("initcomplete",function(){LzlEditor._s_p._se.execCommand("inserthtml",_html)})}}else{if(LzlEditor._s_p._se){LzlEditor._s_p._se.empty();LzlEditor._show();LzlEditor._s_p._se.execCommand("inserthtml",_html)}}LzlEditor._s_p._setData(data);$.stats.sendRequest("fr=tb0_forum&st_type=lzl_interact")},_turnPage:function(c,a){var b=new Date();b=b.getTime();$.ajax({url:"/p/comment",data:{tid:PageData.thread.id,pid:c.mainData.pid,pn:a,t:b},dataType:"html",success:function(d){c._ajaxSucc(d);window.location.hash="noExistHash";window.location.hash=c.mainData.pid+"l"},error:function(d){c._ajaxErr(d)}})},_ajaxSucc:function(a){if(a&&a.length>200){this.mainDom.find("ul.j_lzl_m_w").html(a);this._ajaxRefresh()}else{var c='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5b8b\u4f53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ed1\u4f53&quot;;">\u670d\u52a1\u5668\u5f88\u5fd9</td></tr></tbody></table>\u8bf7\u5237\u65b0\u9875\u9762\uff0c\u7a0d\u540e\u518d\u8bd5</div>';var b=$.dialog.alert(c,{width:410,height:95,title:"\u9519\u8bef\u63d0\u793a"});b.bind("onclose",function(){return true})}},_ajaxErr:function(a){var c='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5b8b\u4f53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ed1\u4f53&quot;;">\u670d\u52a1\u5668\u5f88\u5fd9</td></tr></tbody></table>\u8bf7\u5237\u65b0\u9875\u9762\uff0c\u7a0d\u540e\u518d\u8bd5</div>';var b=$.dialog.alert(c,{width:410,height:95,title:"\u9519\u8bef\u63d0\u793a"});b.bind("onclose",function(){return true})}}});var LzlEditor={_lzl:null,default_options:{autoFocus:true,autoEnable:true,height:"40px",width:"527px",maxHeight:"40",wrapperClassName:"lzl_simple_wrapper",enableRefer:true},options:{},cur_sec:null,_s_p:null,init:function(a,b){LzlEditor.options={};$.extend(LzlEditor.options,LzlEditor.default_options);if(b){$.extend(LzlEditor.options,b)}LzlEditor._buildEditor(a)},_buildEditor:function(lzl){if(LzlEditor._lzl){if(LzlEditor._lzl!=lzl){var cur_sec=LzlEditor.cur_sec;cur_sec.find("span.close").click();var editor=cur_sec.find(".tb-editor-editarea");if(editor[0]&&editor.html().length>0){cur_sec.attr("data-field","{txt:'"+editor.html()+"'}")}LzlEditor._hide();LzlEditor.cur_sec.empty();LzlEditor._s_p=null;var lis=LzlEditor._lzl.mainDom.find("li.j_lzl_s_p");if(lis.length==0){LzlEditor._lzl.tailDom.find(".lzl_link_fold").hide();LzlEditor._lzl.tailDom.find(".lzl_link_unfold").show();LzlEditor._lzl.mainDom.hide()}}else{LzlEditor.cur_sec.show();LzlEditor._s_p._se&&LzlEditor._s_p._se.focus();return false}}LzlEditor._lzl=lzl;var cur_sec=lzl.jdom.find("div.j_lzl_e_c"),topic_thread_type=PageData.thread.topic;LzlEditor.cur_sec=cur_sec;var options=$.extend({container:cur_sec[0],uid:PageData.user.id},LzlEditor.options);if(LzlEditor._limitCheck()||LzlEditor._lzl._reach_limit){LzlEditor._lzl._reach_limit=true}else{LzlEditor._lzl._reach_limit=false}var op={_can_post:PageData.can_post,_forum_type:PageData.forum_type,_no_un:PageData.user.no_un,_is_block:PageData.user.balv.is_block?true:false,_reach_limit:LzlEditor._lzl._reach_limit,_login:PageData.user.is_login,_thread_topic_type:topic_thread_type.is_topic?"1":"0",_thread_topic_subtype:(topic_thread_type.is_topic&&topic_thread_type.topic_type=="2")?"3":"0",data:LzlEditor._lzl.mainData,tpl_id:"j_simpleeditor_tpl"};var simplePostor=new SimplePostor(op,options);simplePostor.bind("toTop",function(){$(window).scrollTop(0)},true);simplePostor.bind("onsuccess",function(){LzlPostor._appendNew()},true);simplePostor.bind("onclose",function(){LzlEditor._lzl._updateReplyNum(20000);LzlEditor._lzl._reach_limit=true;LzlEditor.init(LzlEditor._lzl)},true);simplePostor.bind("hide",function(){LzlEditor._hide()},true);LzlEditor._s_p=simplePostor;if(cur_sec.attr("data-field")){var dataObj=eval("("+cur_sec.attr("data-field")+")");var editor=cur_sec.find(".tb-editor-editarea");editor.html(dataObj.txt)}cur_sec.show();cur_sec.parent().find("input.j_lzl_e_f_h").show().focus().hide()},_limitCheck:function(){var rslt=false;var jTar=LzlEditor._lzl.jdom.find("li.j_lzl_l_p");if(jTar.length==0){return rslt}var data=eval("("+jTar.attr("data-field")+")");if(data.total_num>=20000){rslt=true}return rslt},_hide:function(){if(LzlEditor.cur_sec){LzlEditor.cur_sec.find("span.close").click();LzlEditor.cur_sec.hide()}if(LzlEditor._lzl){LzlEditor._lzl.editor_entry.show()}},_show:function(){if(LzlEditor.cur_sec){LzlEditor.cur_sec.show()}}};var LzlPostor={_appendNew:function(){var e=LzlEditor._lzl.jdom.find("ul.j_lzl_m_w");if(e.length==0){var c=LzlEditor._lzl.jdom.find("div.j_lzl_c_b_a");c.prepend($('<div class="lzl_big_splitline"></div>'));e=$('<ul class="j_lzl_m_w"></ul>');c.prepend(e);LzlEditor._lzl._bindClick()}e.show();var a=$('<li class="lzl_single_post j_lzl_s_p"></li>');a.attr("data-field",'{user_name:"'+PageData.user.name+'"}');var f=' username="'+PageData.user.name+'" onmouseover="showattip(this);" onmouseout="hideattip(this);"';var b="/i/sys/jump?un="+PageData.user.name;var d="";d+='<div class="lzl_p_p">';d+='  <a href="'+b+'" '+f+'><img src="http://tb.himg.baidu.com/sys/portrait/item/'+PageData.user.portrait+'" style="visibility:hidden;" onload="Page.resizePic(this, 32, 32, true);"/></a>';d+="</div>";d+='<div class="lzl_cnt">';d+='  <a class="at" href="'+b+'" '+f+">"+PageData.user.name+"</a>:";d+='    <span class="lzl_content_main">';d+=LzlEditor._s_p._getHtml();d+="    </span>";d+='  <div class="lzl_content_reply">';d+='    <span class="lzl_time">'+LzlPostor.getCurrentTime()+"</span>";d+='    <a href="#" class="lzl_s_r">\u56de\u590d</a>';d+="  </div>";d+="</div>";a.html(d);a.insertBefore(e.find("li.j_lzl_l_p"));LzlEditor._lzl._updateReplyNum()},getCurrentTime:function(){function c(d){return d*1<10?"0"+d:d}var a=new Date();var b="";b+=a.getFullYear()+"-";b+=(a.getMonth()+1)+"-";b+=a.getDate()+"&nbsp;";b+=c(a.getHours())+":";b+=c(a.getMinutes());return b}};var AntiAnswerLzl;var CaptchaLzl;;_.Module.define({path:"pb/widget/ForumListV3",requires:["pb/widget/ForumListV3/Lzl","pb/component/Passive","pb/component/Posts","pb/component/Admin"],sub:{initial:function(){var a=this;this.admin=null;this.posts=a.use("pb/component/Posts");this.loadList={};if(PageData.is_thread_admin||PageData.is_posts_admin){this.admin=a.use("pb/component/Admin");this.admin.loadThreadManage();this.admin.bindAdminEvents();this.admin.bindLzlAdminEvents()}this.use("pb/component/Passive",function(b){a._loadPost(b)});this._bindEvents();if(!PageData.special.lz_only){this._foldLongPic()}this._antiSpamming();this._closeForbiddenTip();this._locatePost();this._lightUpPost();this._showLightPost();this._shieldPost()},_shieldPost:function(){if(PageData.forum.shield_post!=1){return false}var b=$('<div class="user-hide-post-down"></div>'),c=$('<div class="user-hide-post-action"><a href="javascript:void(0)" class="hide-post">\u5bf9\u6211\u9690\u85cf\u8fd9\u6761\u8d34\u5b50</a><a href="javascript:void(0)" class="hide-author"></a></div>'),e,d,i,j,g=false,a=false,h={"110000":"\u4f60\u8fd8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u5148\u767b\u5f55\u3002","210009":"\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\u3002","210004":"\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\u3002","000000":"\u64cd\u4f5c\u6210\u529f\u3002"},f=function(l){var m={},k=a?undefined:j.content.floor;if(k==1){if(l=="hide-post"){m.type=2;m.fname=PageData.forum.name;m.tid=PageData.thread.id}else{m.type=1;m.hide_un=d}}else{if(l=="hide-post"){m.type=3;m.pid=a?j.spid:j.content.id;m.tid=PageData.thread.id}else{m.type=1;m.hide_un=d}}m.ie="utf-8";$.ajax({url:"/tphide/add",data:m,type:"post",dataType:"json",success:function(o){if(o.no==0){g=false;if(k==1){$.tb.location.setHref("/f?kw="+PageData.forum.name)}else{if(l=="hide-post"){i.close();b.hide();c.hide();$("body").append(b).append(c);if(a===false){e.parents("div.l_post").remove()}else{var n=e.parent().find("li.lzl_single_post");if(n.length<2){e.parents("div.j_lzl_container").hide().find("li.lzl_li_pager").remove();var r=e.parents("div.j_lzl_wrapper");r.find("a.lzl_link_unfold").show().text("\u56de\u590d");r.find("span.lzl_link_fold").hide()}e.remove()}}else{if(d==PageData.thread.author){$.tb.location.setHref("/f?kw="+PageData.forum.name)}else{$.tb.location.reload()}}}}else{i.close();var q=new $.dialog({html:'<div class="user-hide-post-tip">'+(h[o.no]||"\u7cfb\u7edf\u51fa\u73b0\u9519\u8bef\u3002")+"</div>",title:"\u63d0\u793a",width:400,closeable:true,draggable:false,show:true});setTimeout(function(){q.close();g=false},4500)}}})};c.click(function(n){var m=$(n.target).attr("class");var k;var l=a?undefined:j.content.floor;if(m=="hide-post"){if(l==1){k="\u9690\u85cf1\u697c\u8d34\u5b50\uff0c\u8be5\u4e3b\u9898\u7684\u5168\u90e8\u56de\u590d\u4e5f\u5c06\u88ab\u9690\u85cf<br />\u786e\u8ba4\u8981\u9690\u85cf\u8fd9\u4e2a\u8d34\u5b50\u5417\uff1f"}else{k="\u64cd\u4f5c\u4e4b\u540e\uff0c\u5c06\u65e0\u6cd5\u6062\u590d\u8fd9\u6761\u8d34\u5b50\u7684\u9690\u85cf\u72b6\u6001<br />\u786e\u8ba4\u8981\u9690\u85cf\u8fd9\u6761\u8d34\u5b50\u5417\uff1f"}}else{if(m=="hide-author"){if(d==PageData.thread.author){k='\u9690\u85cf\u7684\u7528\u6237\u4e3a\u672c\u8d34\u7684\u697c\u4e3b\uff0c\u64cd\u4f5c\u4e4b\u540e\uff1a\u8be5\u4e3b\u9898\u7684\u5168\u90e8\u56de\u590d\u4e5f\u5c06\u88ab\u9690\u85cf\uff0c\u4e14<span style="color:red">3\u5929\u5185</span>\u5c06\u65e0\u6cd5\u770b\u5230\u8be5\u7528\u6237\u53d1\u5e03\u7684\u6240\u6709\u8d34\u5b50<br />\u786e\u8ba4\u8981\u9690\u85cf'+d+"\u7684\u6240\u6709\u8d34\u5b50\u5417\uff1f"}else{k='\u64cd\u4f5c\u4e4b\u540e\uff0c<span style="color:red">3\u5929\u5185</span>\u5c06\u65e0\u6cd5\u770b\u5230\u8be5\u7528\u6237\u53d1\u5e03\u7684\u6240\u6709\u8d34\u5b50<br />\u786e\u8ba4\u8981\u9690\u85cf'+d+"\u7684\u6240\u6709\u8d34\u5b50\u5417\uff1f"}}else{return}}k+='<div class="user-hide-post-confirm"><button class="confirm">\u786e\u8ba4</button>&nbsp;&nbsp;<button class="cancel">\u53d6\u6d88</button></div>';i=new $.dialog({html:'<div class="user-hide-post-tip">'+k+"</div>",title:"\u63d0\u793a",width:400,closeable:false,draggable:false,show:true});$("div.user-hide-post-confirm").click(function(o){var p=$(o.target).attr("class");if(p=="cancel"){i.close()}else{if(p=="confirm"){if(g===false){g=true;f(m)}}}})});b.click(function(){var k;if(b.hasClass("user-hide-post-up")){$(this).attr("class","user-hide-post-down");c.hide()}else{$(this).attr("class","user-hide-post-up");e.append(c);if(a===false){j=$.parseJSON(e.parents("div.l_post").attr("data-field"));d=j.author.name}else{j=$.parseJSON(e.attr("data-field"));d=j.user_name}k="\u5bf9\u6211\u9690\u85cf\u8be5\u7528\u6237\u7684\u6240\u6709\u8d34\u5b503\u5929";c.show().find("a.hide-author").html(k)}});$("div.p_content").hover(function(){var l=$(this).parents("div.l_post");var k=$.parseJSON(l.attr("data-field"));if(PageData.user.name==""||PageData.user.name==k.author.name){return false}e=$(this);e.append(b);b.show();a=false},function(){if(b.hasClass("user-hide-post-up")){b.attr("class","user-hide-post-down")}b.hide();c.hide()});$("div.j_lzl_wrapper").on("mouseenter","li.lzl_single_post",function(){e=$(this);var k=$.parseJSON(e.attr("data-field"));if(PageData.user.name==""||PageData.user.name==k.user_name){return false}e.append(b);b.show();a=true});$("div.j_lzl_wrapper").on("mouseleave","li.lzl_single_post",function(){if(b.hasClass("user-hide-post-up")){b.attr("class","user-hide-post-down")}b.hide();c.hide()});window.global=window.global||{};window.global.shieldPost=function(){$("body").append(b).append(c)}},_antiSpamming:function(){$.stats.sendRequest(" fr=tb0_forum_ns&st_mod=caz&st_source=pb")},_closeForbiddenTip:function(){$(".j_lzl_thread_forbidden_tip").find(".j_lzl_forbidden_tip_close").on("click",function(){$(this).parent().parent().slideUp()})},_lightUpPost:function(){$("#j_p_postlist").find(".j_light_up_post").on("click",function(){var b=$(this);var a=$.parseJSON($(this).parents("div.l_post").attr("data-field"));b.siblings(".j_light_up_tip").empty().append('<div class="light_up_tip_wrap"><img class="light_up_tip_img j_light_up_tip_img" src="http://static.tieba.baidu.com/tb/static-pb/img/lightuptip.gif?t='+new Date().getTime()+'" /></div>');$.post("/light/cm/light",{fid:PageData.forum_id,tid:PageData.thread.id,pid:a.content.id,uid:a.author.id,tbs:PageData.tbs,ie:"gbk",op_uid:PageData.user.id,fname:PageData.forum_name},function(d){var c="";if(d.errno==0){b.addClass("p_support_up");b.find(".j_light_num").text(d.data+"")}else{switch(d.errno){case 1:c="\u7cfb\u7edf\u51fa\u9519\u4e86\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u518d\u8bd5\u8bd5";break;case 2:c="\u60a8\u8fd8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u70b9\u201c\u652f\u6301\u201d";break;case 3:c="\u53c2\u6570\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5";break;case 4:c="\u60a8\u4eca\u5929\u5df2\u7ecf\u201c\u652f\u6301\u201d\u5f88\u591a\u604b\u7231\u5723\u5730\u4e86\uff0c\u4f11\u606f\u4f1a\u660e\u5929\u518d\u6765\u652f\u6301\u5427!";break;case 5:c="\u60a8\u5df2\u201c\u652f\u6301\u201d\u6b64\u604b\u7231\u5723\u5730\uff01";break;case 6:c="\u7cfb\u7edf\u51fa\u9519\u4e86\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u518d\u8bd5\u8bd5";break;case 8:c="\u60a8\u63d0\u540d\u7684\u604b\u7231\u5723\u5730\u53ea\u80fd\u7531TA\u6765\u63d0\u540d\u54e6";break;default:c="\u7cfb\u7edf\u51fa\u9519\u4e86\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u518d\u8bd5\u8bd5";break}window.obj=new $.dialog({html:c,title:"\u8d34\u5427\u63d0\u793a",width:400,closeable:true,draggable:false,show:true});var e=setTimeout("window.obj.close()",1000)}},"json");return false})},_showLightPost:function(){$(".j_light_post_wrap").find(".j_light_post_show").on("click",function(){if($(".j_light_post_hidden_wrap:visible").length==0){$(this).addClass("light_post_need_hidden");$(this).find("span").text("\u6536\u8d77\u66f4\u591a\u652f\u6301\u8d34");$(".j_light_post_wrap").find(".j_light_post_hidden_wrap").slideDown()}else{$(this).removeClass("light_post_need_hidden");$(this).find("span").text("\u5c55\u793a\u66f4\u591a\u652f\u6301\u8d34");$(".j_light_post_wrap").find(".j_light_post_hidden_wrap").slideUp()}return false})},_foldLongPic:function(){var b=$("#j_p_postlist"),d=PageData&&PageData.thread?PageData.thread.author:"1",c=b.find("div.p_content"),a=this;$.each(c,function(h,j){var k=$(j),i=k.parents("div.l_post"),f=$.json.decode(i.attr("data-field")||"{}"),e=f&&f.author?f.author.name:"0";if(e!=d){var l=k.find("img"),g;$.each(l,function(n,m){a.clipLongImg($(m))})}});b.delegate(".replace_tip","click",function(f){$(this).hide().parent(".replace_div").css("height","auto")}).delegate(".replace_tip","mouseover",function(f){$(this).addClass("replace_tip_hover")}).delegate(".replace_tip","mouseout",function(f){$(this).removeClass("replace_tip_hover")})},clipLongImg:function(d){var f,e,d,c,b,a;a=d.height();if(a>999){c=d.width(),replaceEle=$(document.createElement("div"));e=$(document.createElement("div"));if(c>160){b='<em class="expand"></em><span class="txt">\u70b9\u51fb\u5c55\u5f00\uff0c\u67e5\u770b\u5b8c\u6574\u56fe\u7247</span>'}else{b='<em class="expand"></em><span class="txt-empty"></span>'}e.html(b);replaceEle.addClass("replace_div").css("width",c);e.addClass("replace_tip").css("width",c-2);f=d.clone(true);replaceEle.append(f);replaceEle.append(e);d.replaceWith(replaceEle)}},initial_old:function(){var d=this;this.admin=null;this.posts=d.use("pb/component/Posts");this.loadList={};if(PageData.is_thread_admin||PageData.is_posts_admin){this.admin=d.use("pb/component/Admin");this.admin.loadThreadManage();this.admin.bindAdminEvents();this.admin.bindLzlAdminEvents()}var c=window.location.hash;if(!c||isNaN(c.replace("#",""))){this.use("pb/component/Passive",function(f){d._loadPost(f)})}else{var b=$("#j_p_postlist").find("div.l_post");for(var e=0,a=b.length;e<a;e++){d._loadPost($(b[e]))}window.location.hash="noExistHash";window.location.hash=c}this._bindEvents()},_bindEvents:function(){var a=this;$("#quick_reply,a.p_reply_first").bind("click",function(c){if(PageData.user.is_login){$(window).scrollTop($("#edit_parent").offset().top);var b=$(c.target).hasClass("p_reply_first")?"is_p_reply_first":"quick_reply";rich_postor.reply("0",b)}else{TbCom.process("User","buildLoginFrame",null,null,null,"quick_reply")}return false});$("#j_p_postlist").on({mousedown:function(b){$.stats.sendRequest("fr=tb0_forum&st_type=lzonly&st_value=activate")},mouseenter:function(f){var d=$(this);var g=d.position();var c={content:"\u70b9\u51fb\u5373\u53ef\u201c\u53ea\u770b\u697c\u4e3b\u201d\u54df~",arrow_dir:"up",arrow_pos:{left:20},bubble_css:{top:g.top+36,left:g.left,width:140},wrap:d.parent(),closeBtn:false};var b=new UiBubbleTipBase(c);b.showBubble({zIndex:$.getcurzIndex()});d.one("mouseleave",function(h){b.closeBubble()})}},".j_louzhubiaoshi")},_loadPost:function(c){var b=this.posts.initPostData(c);if(!b.content.floor){var a=this.use("pb/widget/ForumListV3/Lzl",c);b.lzl=a;this.posts.loadComponent(b);if(PageData.is_posts_admin){this.admin.loadAdmin(b.jdom,b.author,b.content);this.admin.loadLzlAdmin(b.jdom)}}else{if(!this.loadList[b.content.floor]){this.loadList[b.content.floor]="loaded";var a=this.use("pb/widget/ForumListV3/Lzl",c);b.lzl=a;this.posts.loadComponent(b);if(PageData.is_posts_admin){this.admin.loadAdmin(b.jdom,b.author,b.content);this.admin.loadLzlAdmin(b.jdom)}}}},_locatePost:function(){if(!$.support.style){var a=window.location.toString();var c=a.split("#")[1];if(c){var b=$('[name="'+c+'"]').offset().top;$(window).scrollTop(b)}}}}});;var Sign_rank={sign_url:"/sign/add",sign_forum:"/sign/info",get_url:"/sign/loadmonth",month_url:"/sign/month",sign_year:null,sign_month:null,orign_year:null,orign_month:null,rights_tips:[null,null,null,null,null],mouseEventTimer:null,rightsTipsTimer:null,options:{modVersion:"common"},sign_init:function(k){var j=this;var c=$("#sign_mod");this.options=$.extend(this.options,k);if($.cookie("add_sign")=="sign_rank"){if(PageData.user.is_black){j.show_block_sign_dialog()}else{if(!PageData.is_sign_in){j.sign_add()}}$.cookie("add_sign",null)}if($.cookie("sign_not_now")=="true"){if(PageData.forum.version=="1"){$("#sign_mod").find(".j_signbtn").removeClass("j_cansign").addClass("sign_ing")}else{$("#sign_mod").find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing")}setTimeout(function(){if(PageData.forum.version=="1"){$("#sign_mod").find(".j_signbtn").removeClass("sign_ing").addClass("j_cansign")}else{$("#sign_mod").find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}},10000)}j.mobile_sign_tip();if(PageData.is_sign_in){j.sign_resetdate();j.sign_load_month(0);j.cal_mouseEnterOut();setInterval(j.refresh_sign_rank,300000)}else{if(PageData.user.is_block){if(PageData.forum.version=="1"){c.find(".j_signbtn").addClass("sign_block")}else{c.find(".j_signbtn").addClass("signstar_block")}}else{var f=new Date(Env.server_time);var g=f.getDay();if(PageData.forum.version=="1"){c.find(".j_signbtn").addClass("j_cansign sign"+g)}else{c.find(".j_signbtn").addClass("j_cansign")}}}c.find(".fdir_rank a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_fdir_entr")});c.on("click",".j_cansign",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_btn_click"});if(PageData.user.is_login){if(PageData.user.is_black){j.show_block_sign_dialog()}else{j.sign_add()}}else{$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_login_display"});_.Module.use("common/component/LoginDialog",["",""]);TbCom.addEvent("PassportSign","afterLogined",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_login_succ",bduid:PageData.user.bduid});$.cookie("add_sign","sign_rank",{expires:14})})}});c.find(".j_calendar_month_prev").click(function(){var m=new Date(j.sign_year,j.sign_month-1,1);var l=new Date(j.orign_year-2,j.orign_month-1,1);var n=new Date(2012,6,1);if(m.getTime()<=l.getTime()||m.getTime()<=n.getTime()){return}else{j.set_sign_calendar("",j.sign_year,j.sign_month,-1)}});c.find(".j_calendar_month_next").click(function(l){if(j.sign_year>j.orign_year||j.sign_year==j.orign_year&&j.sign_month>=j.orign_month){return}else{j.set_sign_calendar("",j.sign_year,j.sign_month,1)}});if(PageData.user.is_login){$(".sign_rights").show();$(".j_sign_rights_icon").each(function(l,m){$(m).mouseover(function(){j.rightsTipsTimer=setTimeout(function(){j.sign_right_tips(l)},400)}).mouseout(function(){window.clearInterval(j.rightsTipsTimer);j.rightsTipsTimer=window.setTimeout(function(){if(j.rights_tips[l]!=null){j.rights_tips[l].hideBubble()}},10)})})}else{}if(PageData.forum.version=="2"){var i=$("#signstar_wrapper");i.hover(function(){$(this).addClass("signstar_wrapper_hover")},function(){$(this).removeClass("signstar_wrapper_hover")});var d=$("#sign_dir_tip");var b=d.html();d.html("");var a={content:b,arrow_dir:"up",bubble_css:{top:-5,right:30,width:180,"text-align":"left"},arrow_pos:{left:30},attr:" id='tb_message_tip_n' ",wrap:$("#sign_dir_tip"),closeBtn:false};var e=new UiBubbleTipBase(a);var h=i.find(".j_signdir");h.bind("mouseover",function(){d.show();e.showBubble()}).bind("mouseout",function(){e.hideBubble()})}},sign_resetdate:function(){var a=new Date(Env.server_time);this.sign_year=this.orign_year=a.getFullYear();this.sign_month=this.orign_month=a.getMonth()+1},cal_mouseEnterOut:function(){var b=this;var c=$("#sign_mod");var a;c.find(".j_signbtn,.j_succ_info").die().live({mouseout:function(){window.clearInterval(b.mouseEventTimer);b.mouseEventTimer=window.setTimeout(function(){$(".j_succ_info").fadeOut("slow");if(c.find(".j_succ_info").css("display")=="none"){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_pop_dialog"})}},10)},mouseover:function(){if(c.find(".j_succ_info").css("display")=="none"){if(b.orign_year!=b.sign_year||b.orign_month!=b.sign_month){b.sign_resetdate();b.sign_load_month(0)}}window.clearInterval(b.mouseEventTimer);b.mouseEventTimer=setTimeout(function(){$(".j_succ_info").stop(true,true).show()},400)}})},cal_mouseEventRemove:function(){window.clearInterval(self.mouseEventTimer);$("#sign_mod").find(".j_signbtn,.j_succ_info").die()},sign_add:function(){if(PageData.forum.version=="1"){$("#sign_mod").find(".j_signbtn").removeClass("j_cansign").addClass("sign_ing")}else{$("#sign_mod").find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing")}var a={kw:PageData.forum.name,tbs:PageData.tbs,ie:"utf-8"};$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_in_num"});$.tb.post(Sign_rank.sign_url,a,function(e){if(e&&e.no==0){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_in_succ"});$(".j_today_signnum").html(e.data.finfo.current_rank_info.sign_count);var g=PageData.forum.version>=2?2:1;var f=e.data.uinfo.sign_time;var b=new Date(f);Sign_rank.sign_year=Sign_rank.orign_year=b.getFullYear();Sign_rank.sign_month=Sign_rank.orign_month=b.getMonth()+1;Sign_rank.sign_load_month(1)}else{setTimeout(function(){if(PageData.forum.version=="1"){$("#sign_mod").find(".j_signbtn").removeClass("sign_ing").addClass("j_cansign")}else{$("#sign_mod").find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}},10000);var d=new Date();d.setTime(d.getTime()+(10*1000));$.cookie("sign_not_now",true,{expires:d});if(e.no==1007){var g=PageData.forum.version>=2?2:1;var c=$(".j_signbtn");if(PageData.forum.version=="1"){c.removeClass().addClass("j_signbtn sign_btn"+g+" sign_full")}else{c.removeClass().addClass("j_signbtn signstar_full")}}else{new $.dialog({html:"<div class='signmod_likeandsign_dialog'>"+e.error+"</div>",holderClassName:"passportDialog",title:"\u7b7e\u5230\u5931\u8d25",draggable:false,width:338,height:87})}}},"json")},sign_load_month:function(c){var a=this;var b=PageData.forum.version>=2?2:1;$.tb.get(Sign_rank.get_url,{kw:PageData.forum.name,ie:"utf-8"},function(i){if(i&&i.no==0){$(".j_signin_index").html(i.data.sign_user_info.rank);$(".j_succ_text").html(Sign_rank.succ_text(PageData.forum.sign_in_info.forum_info.current_rank_info.sign_rank,i.data.sign_user_info.rank,PageData.forum.sign_in_info.forum_info.forum_info.level_1_dir_name,i.data.sign_user_info.sign_keep));$(".j_sign_succ_keep").html(i.data.sign_user_info.sign_keep);$(".j_sign_succ_count").html(i.data.sign_user_info.sign_total);Sign_rank.sign_resetdate();Sign_rank.set_sign_calendar(i);a.signShai(i);a.check_rights_status(i.data.sign_user_info.sign_keep);var g=$(".j_signbtn");if(PageData.forum.version=="1"){g.removeClass().addClass("j_signbtn sign_btn"+b+" sign"+g.attr("data-dw")+"_signed")}else{$("#signstar_wrapper .j_signstar_order").html(i.data.sign_user_info.rank);var f=$("#signstar_wrapper");if(f[0]){f.addClass("signstar_wrapper_signed")}g.removeClass().addClass("j_signbtn signstar_signed")}if(c){if(i.data.sign_user_info.sign_keep==30||i.data.sign_user_info.sign_keep==100){var l={username:PageData.user.name,forumname:PageData.forum.name,continueSign:i.data.sign_user_info.sign_keep,memberCount:PageData.memberNumber,memberTitle:PageData.memberTitle};Sign_rank.sign_100(l)}$(".j_succ_info").show();var h='<span class="sign_keep_span">\u8fde\u7eed\u7b7e\u5230 '+i.data.sign_user_info.sign_keep+" \u5929</span>";var k=i.data.sign_user_info.sign_keep>1?"4":"2";var d;try{d="baidubrowser.tieba"==window.external.GetVersion("version")?true:false}catch(j){d=null}if(d){k=i.data.sign_user_info.sign_keep>1?"5":"3"}g.append(h);if(PageData.user.is_like){$(".signed_day:last").append('<div style="position:absolute;"><div class="sign_plus_two">+'+k+" \u7ecf\u9a8c</div></div>");setTimeout(function(){$(".sign_plus_two").show().animate({opacity:0,top:"-=20"},2500)},1000)}$(".signed_day:last").removeClass("signed_day").addClass("signed_anime_day")}else{$("#sign_btn_keep").text(i.data.sign_user_info.sign_keep)}a.cal_mouseEnterOut()}else{}},"json")},sign_like_and_sign:function(c){$("#j_sign_tip_holder .tip_v_2 img").click();var b=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672c\u5427\u7b7e\u5230\u9700\u8981\u5148\u6210\u4e3a\u4f1a\u5458\u54e6~\u52a0\u5165\u6211\u4eec\u5427\uff01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_like_and_sign_btn j_sign_like' type='button' value='\u6210\u4e3a\u4f1a\u5458\u5e76\u7b7e\u5230'><input class='signmod_cancel_btn j_sign_cancel' type='button' value='\u518d\u8003\u8651\u4e00\u4e0b'></div>",holderClassName:"passportDialog",title:c,draggable:false,width:338,height:87});Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_like_show");var a=$(b.element[0]);a.find(".j_sign_like").click(function(){var d={fid:PageData.forum.id,fname:PageData.forum.name,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs};$.tb.post(Balv.config.url.dolike,d,function(j){var e=false;try{var f=j}catch(g){e=true}if(e){return}if(f&&f.no==0){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_like_succ&bduid="+PageData.user.bduid);var h={kw:PageData.forum.name,tbs:PageData.tbs,ie:"utf-8"};$.tb.post(Sign_rank.sign_url,h,function(n){var k=false;try{var l=n}catch(m){k=true}if(k){return}if(l&&l.no==0){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_in_succ");if(PageData.forum.first_class=="\u4f53\u80b2"){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pe_sign_in_succ")}window.location.reload()}else{window.location.reload()}},"json")}else{var i="";if(f.no==8||f.no==9){i="\u4f60\u5728\u672c\u5427\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(f.no==220){i="\u4f60\u88ab\u5427\u4e3b\u52a0\u5165\u9ed1\u540d\u5355\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(f.no==221){i="\u4f60\u5df2like\u4e86\u672c\u5427,\u8bf7\u4e0d\u8981\u91cd\u590d\u64cd\u4f5c"}else{i="\u62b1\u6b49\uff0c\u5f02\u5e38\u9519\u8bef\uff0c\u5efa\u8bae\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u4e00\u4e0b"}}}new $.dialog({html:i,holderClassName:"passportDialog",title:c,draggable:false,width:338,height:87})}})});a.find(".j_sign_cancel").click(function(){b.close()})},refresh_sign_rank:function(){var a={kw:PageData.forum.name,ie:"utf-8",tbs:PageData.tbs};$.tb.get(Sign_rank.sign_forum,a,function(e){var b=false;try{var c=e}catch(d){b=true}if(b){return}if(c&&c.no==0){$(".j_today_signnum").html(c.data.forum_info.current_rank_info.sign_count);$(".j_signrank_index").html(c.data.forum_info.current_rank_info.sign_rank)}else{}})},show_block_sign_dialog:function(){var a=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672c\u5427\u7b7e\u5230\u9700\u8981\u5148\u6210\u4e3a\u4f1a\u5458\u54e6~\u52a0\u5165\u6211\u4eec\u5427\uff01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_confirm_btn j_sign_confirm' type='button' value='\u77e5\u9053\u4e86' /></div>",holderClassName:"passportDialog",title:"\u672c\u5427\u7b7e\u5230",draggable:false,width:338,height:87});$(a.element[0]).find(".j_sign_confirm").click(function(){a.close()})},succ_text:function(c,b,d,a){if(a){if(a==9){return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002"}else{if(a==10){return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}else{if(a==19){return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002"}else{if(a==20){return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}else{if(a==29){return"\u5df2\u8fde\u7eed\u7b7e\u523029\u5929\uff0c\u660e\u65e5\u7b7e\u5230\u5373\u53ef\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u4e0d\u8981\u5fd8\u4e86\u54e6~"}else{if(a==30){return"\u606d\u559c\u4f60\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u8d76\u7d27\u53d1\u8d34\u70ab\u8000\u5427\u3002\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}}}}}}}var e;if(b<=10){switch(parseInt(b)){case 1:e="\u606d\u559c\u4f60\u62a2\u5f97\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u540d\uff0c\u8d76\u7d27\u622a\u56fe\u7559\u5ff5\u5427~~";break;case 2:e="\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u4eba\u88ab\u62a2\u8d70\u4e86\u2026\u2026\u660e\u5929\u518d\u6765\u65e9\u4e00\u70b9\u5427~";break;default:e="\u606d\u559c\u4f60\u540d\u5217\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u524d10\uff0c\u83b7\u5f97\u201c\u672c\u5427\u5fe0\u8bda\u5427\u53cb\u201d\u79f0\u53f7~";break}}else{if(b==100){e="\u54a6\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u8e29\u5230100\u4e86\uff0c\u4eca\u5929\u4f1a\u6709\u597d\u8fd0\u6c14\u5594~"}else{if(b==250){e="\u8bf7\u5728\u5fc3\u4e2d\u9ed8\u5ff53\u904d\uff1a\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u2026\u2026"}else{if(b==1000){e="\u524d\u9762999\u4eba\u7684\u7ecf\u8fc7\uff0c\u53ea\u4e3a\u4e86\u6210\u5168\u4f60\u7684\u5706\u6ee1\u2026\u2026"}else{if(b==10000){e="\u80fd\u8e29\u5230\u5982\u6b64\u5927\u6574\u5b9e\u5728\u662f\u4eba\u54c1\u7206\u68da\u554a\uff01\u53ef\u4ee5\u51fa\u95e8\u4e70\u5f69\u7968\u4e86~"}else{if(c<=100){switch(parseInt(c)){case 1:e="\u672c\u5427\u7b2c\u4e00\u7684\u5730\u4f4d\uff0c\u53c8\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u2026\u2026";break;case 2:e="\u672c\u5427\u79bb\u7b2c\u4e00\u540d\u53c8\u8fd1\u4e86\u4e00\u70b9\u70b9\u70b9\u70b9\uff0c\u52a0\u6cb9\uff01";break;case 3:e="\u4fdd\u6301\u524d\u4e09\u540d\u4e0d\u5bb9\u6613\uff0c\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6~~";break;default:if(c<=10){e="\u524d\u5341\u540d\u7ade\u4e89\u6fc0\u70c8\uff0c\u8bb0\u5f97\u6bcf\u5929\u90fd\u6765\u7b7e\u5230\u54e6~"}else{if(c<=30){e="\u79bb\u524d\u5341\u540d\u8fd8\u6709\u4e9b\u8ddd\u79bb\uff0c\u5927\u5bb6\u6765\u5f97\u66f4\u52e4\u5feb\u4e9b\u5427~"}else{e="\u4e00\u767e\u5f3a\u7684\u5730\u4f4d\u9700\u8981\u5927\u5bb6\u7684\u5171\u540c\u52aa\u529b\uff0c\u52a0\u6cb9\uff01"}}break}}else{e="\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6\uff0c\u5e2e\u672c\u5427\u63d0\u5347\u6392\u540d~"}}}}}}return e},set_sign_calendar:function(a,q,d,s){var g=$("#sign_mod");if(q==""||typeof(q)=="undefined"){q=this.sign_year}if(d==""||typeof(d)=="undefined"){d=this.sign_month}if(typeof(s)!="undefined"){s=parseInt(s);if(s<0){d=d-1;if(d==0){q=q-1;d=12}}else{if(s>0){d=d+1;if(d==13){q=q+1;d=1}}else{}}if(s!=0){var o=PageData.user.id;$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_month_pager",uid:o})}}var c,u,k,r;c=new Date(q,d-1,1);u=new Date(q,d,0);k=c.getDay();r=u.getDate();g.find(".j_5, .j_6").css({display:"none"});for(var f=0;f<7;f++){g.find(".j_1_"+f+", .j_5_"+f+", .j_6_"+f).html("&nbsp;").addClass("emptyDate")}for(var b=1;b<32;b++){g.find(".j_d_"+b).removeClass("signed_day signed_mob_day signed_anime_day j_d_"+b).attr({title:""})}for(var h=1,f=k,b=1;r>0;f++,r--,b++){if(f==7){f=0;h++}if(h==5){g.find(".j_5").css({display:""})}if(h==6){g.find(".j_6").css({display:""})}g.find(".j_"+h+"_"+f).addClass("j_d_"+b).html(b).removeClass("emptyDate")}if(typeof(a)!="undefined"&&a!=""){p(a)}else{$.tb.get(this.month_url,{kw:PageData.forum.name,ie:"utf-8",sign_y:q,sign_m:d},function(i){if(i&&i.no==0){p(i)}else{alert(i.no);return}},"json")}this.sign_year=q;this.sign_month=d;if(String(d).length<2){d=d+"";d="0"+d}var l=q+"\u5e74"+d+"\u6708";g.find(".j_calendar_month").html(l);function p(z){var x=z.data.sign_user_info.sign_month;var m=["\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4","\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\u767e\u5ea6\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\u767e\u5ea6\u624b\u673a\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+4\uff0c\u8fde\u7eed\u7b7e\u5230+6","\u624b\u673a\u5ba2\u6237\u7aef\u7b7e\u5230\u7ecf\u9a8c+4\uff0c\u8fde\u7eed\u7b7e\u5230+6"];for(var v=0;v<x.length;v++){var w=x[v].t;var j=w.substr(0,w.indexOf(":"));var y=w.substr(w.indexOf(":")+1);var n="\u4e8e"+j+"\u70b9"+y+"\u5206\uff0c\u7b2c"+x[v].rank+"\u4e2a\u7b7e\u5230\uff0c";if(j=="00"&&y=="00"&&x[v].rank==""){n="\u989d\uff0c\u670d\u52a1\u5668\u8fd9\u5929\u6253\u76f9\u4e86\uff0c\u6ca1\u8bb0\u4f4f\u4f60\u662f\u51e0\u70b9\u7b7e\u5230\u7684\uff0c\u62b1\u6b49..."}switch(x[v].sign_type){case"brs":g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[2]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile_brs":g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[3]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile_client":g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[4]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile":var t="\u4e8e"+j+"\u70b9"+y+"\u5206\uff0c\u7b2c"+x[v].rank+"\u4e2a\u7b7e\u5230\uff0c\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c+3,\u8fde\u7eed\u7b7e\u5230\u7ecf\u9a8c+5";g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[1]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"pc":g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[0]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;default:g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[0]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break}}}if((this.sign_month==this.orign_month)&&(this.sign_year==this.orign_year)){if(g.find(".j_d_"+(new Date(Env.server_time)).getDate()).hasClass("signed_day")||g.find(".j_d_"+(new Date(Env.server_time)).getDate()).hasClass("signed_mob_day")){}else{var e=$(".j_signin_index").html();g.find(".j_d_"+(new Date(Env.server_time)).getDate()).addClass("signed_day").attr({title:"\u4e8e"+(new Date(Env.server_time)).getHours()+"\u70b9"+(new Date(Env.server_time)).getMinutes()+"\u5206\uff0c\u7b2c"+e+"\u4e2a\u7b7e\u5230\uff0c\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4"})}}},pvLog:function(){$("#sign_promotionlink").click(function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_promotionlink_click"})})},signShai:function(c){var b=this;var a=navigator.userAgent.match(/iPad/i)!=null;if(document.createElement("canvas").getContext!=undefined&&!$.browser.mozilla&&PageData.product=="frs"&&!a){_.Module.use("frs/component/SignShai",["sign_mod",c.data.sign_user_info],function(d){d.bind("startRender",function(){b.cal_mouseEventRemove()});d.bind("completeRender",function(){b.cal_mouseEnterOut()})})}},sign_100:function(c){if(!c){return}var d=new Date();var a=d.getFullYear()+"\u5e74"+(d.getMonth()+1)+"\u6708"+d.getDate()+"\u65e5";var f="";f="<div class='sign_100_dlg'><div class='sign_100_"+c.continueSign+"'></div><div class='sign_100_text'><div class='sign_100_close'></div><div class='sign_100_title'>\u4eb2\u7231\u7684"+c.username+"</div>";if(c.continueSign==100){f=f+"<div class='sign_100_content'>\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+c.continueSign+"\u5929</span>\uff0c\u503c\u5f97\u7eaa\u5ff5\u7684\u65e5\u5b50\uff0c\u6709\u6728\u6709\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u771f\u5feb\u54c8\uff0c\u4ece\u7b2c\u4e00\u6b21\u7b7e\u5230\u5230\u73b0\u5728\uff0c\u5df2\u6709"+c.continueSign+"\u4e2a\u503c\u5f97\u56de\u5473\u7684\u65e5\u65e5\u591c\u591c\u5728\u8fd9\u91cc\u7559\u5b58\u3002<br/>\u8ba9\u6211\u4eec\u611f\u5230\u5f00\u5fc3\u7684\u662f\uff0c\u4f60\u4ecd\u7136\u662f\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7684"+c.memberCount+"\u4e2a<span class='sign_baname_highlight'>"+c.memberTitle+"</span>\u4e2d\u575a\u5b9e\u7684\u4e00\u4efd\u5b50\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230"+c.continueSign+"\u5929\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\uff0c\u5e76\u5feb\u4e50\u3002<br/></div>"}else{f=f+"<div class='sign_100_content'>\u77e5\u9053\u5417\uff0c\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+c.continueSign+"\u5929</span>\uff0c\u6574\u6574\u4e00\u4e2a\u6708\u5566\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u633a\u5feb\u7684\u54c8\uff0c\u4ece\u4f60\u7b2c\u4e00\u6b21\u5230\u672c\u5427\u7b7e\u5230\uff0c\u70b9\u4e0e\u4e0d\u70b9\u95f4\uff0c\u5728\u8d34\u5427\u5ea6\u8fc7\u4e86"+c.continueSign+"\u4e2a\u7f8e\u597d\u7684\u65e5\u5b50\u3002<br/>\u4eca\u540e\u7684\u8def\u8fd8\u957f\u7740\u5462\uff0c\u8877\u5fc3\u5e0c\u671b\u4f60\u5728<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7684\u6bcf\u4e00\u5929\u90fd\u80fd\u5f00\u5fc3\uff0c\u4e0e\u5168\u4f53\u5427\u53cb\u4eec\u76f8\u77e5\u76f8\u7231\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230\u6ee1\u6708\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\u3002<br/></div>"}f=f+"<div class='sign_100_message'><a href='/i/sys/jump?un=%CC%F9%B0%C9%C7%A9%B5%BD%D0%A1%C3%D8%CA%E9' target='_blank'>\u8d34\u5427\u7b7e\u5230\u5c0f\u79d8\u4e66</a><img src='http://tb2.bdstatic.com/tb/img/itieba_vip.gif' title='\u8d34\u5427\u5b9e\u540d\u8ba4\u8bc1' class='verified_icon'>&nbsp;&nbsp;&nbsp;&nbsp;"+a+"&nbsp;&nbsp;&nbsp;&nbsp;<button class='j_sign_100_shai sign_100_shai_btn'>&nbsp;</button></div></div></div>";$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"ucenter",st_type:"sign_100_display"+c.continueSign});var e=new $.dialog({html:f,holderClassName:"sign_100_wapper",width:"681",showTitle:false});$(e.element[0]).find(".sign_100_close").click(function(){e.close()});var b=navigator.userAgent.match(/iPad/i)!=null;if(document.createElement("canvas").getContext!=undefined&&!$.browser.mozilla&&PageData.product=="frs"&&!b){$(".j_sign_100_shai").show();_.Module.use("ucenter/component/sign100",["dialogJbody",c.continueSign],function(g){g.bind("completeRender",function(){e.close()})})}},sign_right_tips:function(b){var d=[PageUnit.load("sign_mod_tiptitle1"),PageUnit.load("sign_mod_tiptitle2"),PageUnit.load("sign_mod_tiptitle3"),PageUnit.load("sign_mod_tiptitle4"),PageUnit.load("sign_mod_tiptitle5")];var j=[PageUnit.load("sign_mod_tiptext1"),PageUnit.load("sign_mod_tiptext2"),PageUnit.load("sign_mod_tiptext3"),PageUnit.load("sign_mod_tiptext4"),PageUnit.load("sign_mod_tiptext5")];var g=[PageUnit.load("sign_mod_tipcondition1"),PageUnit.load("sign_mod_tipcondition2"),PageUnit.load("sign_mod_tipcondition3"),PageUnit.load("sign_mod_tipcondition4"),PageUnit.load("sign_mod_tipcondition5")];$(".sign_rights").css("position","relative").css("z-index","1");var a=[81,110,142,173,203];var h=b+1;var f={icon:"sign_big_icon_"+h,title:d[b],text:j[b],condition:g[b],position_right:13,arr_right:a[b]};if(this.options.modVersion=="bright"){var c={content:"<div class='sign_rights_tip'><div class='sign_rights_top clearfix'><div class='sign_rights_big_icon "+f.icon+"'></div><div class='sign_rights_text_wapper'><div class='sign_rights_title'>"+f.title+"</div><div class='sign_rights_title_text'>"+f.text+"</div></div></div><div class='sign_rights_popline'></div><div class='sign_rights_condition'>"+f.condition+"</div></div>",arrow_dir:"up",bubble_css:{top:25,right:17,width:250,"z-index":9999},arrow_pos:{left:f.arr_right},attr:" ",wrap:$(".sign_rights"),closeBtn:false}}else{var c={content:"<div class='sign_rights_tip'><div class='sign_rights_top clearfix'><div class='sign_rights_big_icon "+f.icon+"'></div><div class='sign_rights_text_wapper'><div class='sign_rights_title'>"+f.title+"</div><div class='sign_rights_title_text'>"+f.text+"</div></div></div><div class='sign_rights_popline'></div><div class='sign_rights_condition'>"+f.condition+"</div></div>",arrow_dir:"up",bubble_css:{top:35,right:f.position_right,width:250,"z-index":9999},arrow_pos:{left:f.arr_right},attr:" ",wrap:$(".sign_rights"),closeBtn:false}}if(Sign_rank.rights_tips[b]===null){var e=new UiBubbleTipBase(c);e.showBubble();Sign_rank.rights_tips[b]=e}else{Sign_rank.rights_tips[b].showBubble()}$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"ucenter",st_type:"sign_rights_display_"+b})},check_rights_status:function(a){$(".j_sign_rights_icon:eq(0)").addClass("rights_get");$.stats.hive("sign_rights_exp1");if(a>=2){$(".j_sign_rights_icon:eq(1)").addClass("rights_get");$.stats.hive("sign_rights_exp2")}if(a>=10){$(".j_sign_rights_icon:eq(2)").addClass("rights_get");$.stats.hive("sign_rights_exp3")}if(a>=20){$(".j_sign_rights_icon:eq(3)").addClass("rights_get");$.stats.hive("sign_rights_exp4")}if(a>=30){$(".j_sign_rights_icon:eq(4)").addClass("rights_get");$.stats.hive("sign_rights_exp5")}},mobile_sign_tip:function(){var a=(new Date()-new Date("2012/11/20"))/86400000;if(a>=30||a<=0){return}if($.cookie("close_mobile_tip")=="true"){return}$("#j_sign_tip_holder").css("position","relative").css("z-index","1");var c={content:"<div class='sign_mob_tip clearfix'><div class='sign_mob_tip_icon'></div><div class='sign_mob_tip_text'>\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c\u66f4\u591a\uff0c<br/>\u4f55\u4e0d\u8bd5\u8bd5\u624b\u673a\u8d34\u5427\u5ba2\u6237\u7aef\u3002<br/><a href='http://c.tieba.baidu.com/c/s/download/pc?src=webtbnotsign' target='_blank'>\u9a6c\u4e0a\u53bb\u4e0b\u8f7d>></a></div></div>",arrow_dir:"up",bubble_css:{top:0,right:15,width:230,"z-index":9999},arrow_pos:{left:140},attr:" ",wrap:$("#j_sign_tip_holder"),closeBtn:true};var b=new UiBubbleTipBase(c);b.showBubble();b.bind("onclose",function(){$.cookie("close_mobile_tip",true,{expires:3,path:"/"})},true)}};;_.Module.define({path:"ucenter/widget/sign_mod",sub:{_jq_wrap:null,_options:{},initial:function(b,a){this._jq_wrap=b;this._options=$.extend(this._options,a);this.signRank.sign_init(b,this._options);this.signRank.pvLog()},signRank:{sign_url:"/sign/add",sign_forum:"/sign/info",get_url:"/sign/loadmonth",month_url:"/sign/month",sign_year:null,sign_month:null,orign_year:null,orign_month:null,rights_tips:[null,null,null,null,null],mouseEventTimer:null,rightsTipsTimer:null,jq_wrap:null,sign_init:function(a,l){var k=this;var d=this.jq_wrap=a;if($.cookie("add_sign")=="sign_rank"){if(PageData.user.is_black){k.show_block_sign_dialog()}else{if(!PageData.is_sign_in){k.sign_add()}}$.cookie("add_sign",null)}if($.cookie("sign_not_now")=="true"){if(PageData.forum.version=="1"){d.find(".j_signbtn").removeClass("j_cansign").addClass("sign_ing")}else{d.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing")}setTimeout(function(){if(PageData.forum.version=="1"){d.find(".j_signbtn").removeClass("sign_ing").addClass("j_cansign")}else{d.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}},10000)}k.mobile_sign_tip();if(PageData.is_sign_in){k.sign_resetdate();k.sign_load_month(0);k.cal_mouseEnterOut();setInterval(k.refresh_sign_rank,300000)}else{if(PageData.user.is_block){if(PageData.forum.version=="1"){d.find(".j_signbtn").addClass("sign_block")}else{d.find(".j_signbtn").addClass("signstar_block")}}else{var g=new Date(Env.server_time);var h=g.getDay();if(PageData.forum.version=="1"){d.find(".j_signbtn").addClass("j_cansign sign"+h)}else{d.find(".j_signbtn").addClass("j_cansign")}}}d.find(".fdir_rank a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_fdir_entr")});d.on("click",".j_cansign",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_btn_click"});if(PageData.user.is_login){if(PageData.user.is_black){k.show_block_sign_dialog()}else{k.sign_add()}}else{$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_login_display"});_.Module.use("common/component/LoginDialog",["",""]);TbCom.addEvent("PassportSign","afterLogined",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_login_succ",bduid:PageData.user.bduid});$.cookie("add_sign","sign_rank",{expires:14})})}});d.find(".j_calendar_month_prev").click(function(){var n=new Date(k.sign_year,k.sign_month-1,1);var m=new Date(k.orign_year-2,k.orign_month-1,1);var o=new Date(2012,6,1);if(n.getTime()<=m.getTime()||n.getTime()<=o.getTime()){return}else{k.set_sign_calendar("",k.sign_year,k.sign_month,-1)}});d.find(".j_calendar_month_next").click(function(m){if(k.sign_year>k.orign_year||k.sign_year==k.orign_year&&k.sign_month>=k.orign_month){return}else{k.set_sign_calendar("",k.sign_year,k.sign_month,1)}});if(PageData.user.is_login){d.find(".j_sign_rights").show();d.find(".j_sign_rights_icon").each(function(m,n){$(n).mouseover(function(){k.rightsTipsTimer=setTimeout(function(){k.sign_right_tips(m)},400)}).mouseout(function(){window.clearInterval(k.rightsTipsTimer);k.rightsTipsTimer=window.setTimeout(function(){if(k.rights_tips[m]!=null){k.rights_tips[m].hideBubble()}},10)})})}if(PageData.forum.version=="2"){var j=d.find(".j_sign_box");j.hover(function(){$(this).addClass("sign_box_bright_hover")},function(){$(this).removeClass("sign_box_bright_hover")});var e=d.find(".j_sign_dir_tip");var c=e.html();e.html("");var b={content:c,arrow_dir:"up",bubble_css:{top:-10,left:4,width:200,"text-align":"left"},arrow_pos:{right:30},attr:" id='tb_message_tip_n' ",wrap:e,closeBtn:false};var f=new UiBubbleTipBase(b);var i=j.find(".j_signdir");i.bind("mouseenter",function(){e.show();f.showBubble()}).bind("mouseleave",function(){f.hideBubble()})}},sign_resetdate:function(){var a=new Date(Env.server_time);this.sign_year=this.orign_year=a.getFullYear();this.sign_month=this.orign_month=a.getMonth()+1},cal_mouseEnterOut:function(){var b=this;var c=this.jq_wrap;var a;c.find(".j_signbtn,.j_succ_info").die().live({mouseout:function(){window.clearInterval(b.mouseEventTimer);b.mouseEventTimer=window.setTimeout(function(){c.find(".j_succ_info").fadeOut("slow");if(c.find(".j_succ_info").css("display")=="none"){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_pop_dialog"})}},10)},mouseover:function(){if(c.find(".j_succ_info").css("display")=="none"){if(b.orign_year!=b.sign_year||b.orign_month!=b.sign_month){b.sign_resetdate();b.sign_load_month(0)}}window.clearInterval(b.mouseEventTimer);b.mouseEventTimer=setTimeout(function(){c.find(".j_succ_info").stop(true,true).show()},400)}})},cal_mouseEventRemove:function(){window.clearInterval(self.mouseEventTimer);this.jq_wrap.find(".j_signbtn,.j_succ_info").die()},sign_add:function(){var a=this;if(PageData.forum.version=="1"){this.jq_wrap.find(".j_signbtn").removeClass("j_cansign").addClass("sign_ing")}else{this.jq_wrap.find(".j_signbtn").removeClass("j_cansign").addClass("signstar_ing")}var b={kw:PageData.forum.name,tbs:PageData.tbs,ie:"utf-8"};$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:PageData.product,st_type:"sign_in_num"});$.tb.post(a.sign_url,b,function(f){if(f&&f.no==0){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_in_succ"});a.jq_wrap.find(".j_today_signnum").html(f.data.finfo.current_rank_info.sign_count);var h=PageData.forum.version>=2?2:1;var g=f.data.uinfo.sign_time;var c=new Date(g);a.sign_year=a.orign_year=c.getFullYear();a.sign_month=a.orign_month=c.getMonth()+1;a.sign_load_month(1)}else{setTimeout(function(){if(PageData.forum.version=="1"){a.jq_wrap.find(".j_signbtn").removeClass("sign_ing").addClass("j_cansign")}else{a.jq_wrap.find(".j_signbtn").removeClass("signstar_ing").addClass("j_cansign")}},10000);var e=new Date();e.setTime(e.getTime()+(10*1000));$.cookie("sign_not_now",true,{expires:e});if(f.no==1007){var h=PageData.forum.version>=2?2:1;var d=a.jq_wrap.find(".j_signbtn");if(PageData.forum.version=="1"){d.removeClass().addClass("j_signbtn sign_btn"+h+" sign_full")}else{d.removeClass().addClass("j_signbtn signstar_full")}}else{new $.dialog({html:"<div class='signmod_likeandsign_dialog'>"+f.error+"</div>",holderClassName:"passportDialog",title:"\u7b7e\u5230\u5931\u8d25",draggable:false,width:338,height:87})}}},"json")},sign_load_month:function(c){var a=this;var b=PageData.forum.version>=2?2:1;$.tb.get(a.get_url,{kw:PageData.forum.name,ie:"utf-8"},function(i){if(i&&i.no==0){a.jq_wrap.find(".j_signin_index").html(i.data.sign_user_info.rank);a.jq_wrap.find(".j_succ_text").html(a.succ_text(PageData.forum.sign_in_info.forum_info.current_rank_info.sign_rank,i.data.sign_user_info.rank,PageData.forum.sign_in_info.forum_info.forum_info.level_1_dir_name,i.data.sign_user_info.sign_keep));a.jq_wrap.find(".j_sign_succ_keep").html(i.data.sign_user_info.sign_keep);a.jq_wrap.find(".j_sign_succ_count").html(i.data.sign_user_info.sign_total);a.sign_resetdate();a.set_sign_calendar(i);a.signShai(i);a.check_rights_status(i.data.sign_user_info.sign_keep);var g=a.jq_wrap.find(".j_signbtn");if(PageData.forum.version=="1"){g.removeClass().addClass("j_signbtn sign_btn"+b+" sign"+g.attr("data-dw")+"_signed")}else{var f=a.jq_wrap.find(".j_sign_box");if(f[0]){f.addClass("sign_box_bright_signed")}g.removeClass().addClass("j_signbtn signstar_signed")}if(c){if(i.data.sign_user_info.sign_keep==30||i.data.sign_user_info.sign_keep==100){var l={username:PageData.user.name,forumname:PageData.forum.name,continueSign:i.data.sign_user_info.sign_keep,memberCount:PageData.memberNumber,memberTitle:PageData.memberTitle};a.sign_100(l)}a.jq_wrap.find(".j_succ_info").show();var h='<span class="sign_keep_span">\u8fde\u7eed '+i.data.sign_user_info.sign_keep+" \u5929</span>";var k=i.data.sign_user_info.sign_keep>1?"4":"2";var d;try{d="baidubrowser.tieba"==window.external.GetVersion("version")?true:false}catch(j){d=null}if(d){k=i.data.sign_user_info.sign_keep>1?"5":"3"}g.append(h);if(PageData.user.is_like){a.jq_wrap.find(".signed_day:last").append('<div style="position:absolute;"><div class="sign_plus_two">+'+k+" \u7ecf\u9a8c</div></div>");setTimeout(function(){$(".sign_plus_two").show().animate({opacity:0,top:"-=20"},2500)},1000)}a.jq_wrap.find(".signed_day:last").removeClass("signed_day").addClass("signed_anime_day")}else{a.jq_wrap.find(".j_sign_btn_keep").text(i.data.sign_user_info.sign_keep)}a.cal_mouseEnterOut()}else{}},"json")},sign_like_and_sign:function(d){var a=this;$("#j_sign_tip_holder .tip_v_2 img").click();var c=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672c\u5427\u7b7e\u5230\u9700\u8981\u5148\u6210\u4e3a\u4f1a\u5458\u54e6~\u52a0\u5165\u6211\u4eec\u5427\uff01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_like_and_sign_btn j_sign_like' type='button' value='\u6210\u4e3a\u4f1a\u5458\u5e76\u7b7e\u5230'><input class='signmod_cancel_btn j_sign_cancel' type='button' value='\u518d\u8003\u8651\u4e00\u4e0b'></div>",holderClassName:"passportDialog",title:d,draggable:false,width:338,height:87});Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_like_show");var b=$(c.element[0]);b.find(".j_sign_like").click(function(){var e={fid:PageData.forum.id,fname:PageData.forum.name,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs};$.tb.post(Balv.config.url.dolike,e,function(k){var f=false;try{var g=k}catch(h){f=true}if(f){return}if(g&&g.no==0){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_like_succ&bduid="+PageData.user.bduid);var i={kw:PageData.forum.name,tbs:PageData.tbs,ie:"utf-8"};$.tb.post(a.sign_url,i,function(o){var l=false;try{var m=o}catch(n){l=true}if(l){return}if(m&&m.no==0){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=sign_in_succ");if(PageData.forum.first_class=="\u4f53\u80b2"){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pe_sign_in_succ")}window.location.reload()}else{window.location.reload()}},"json")}else{var j="";if(g.no==8||g.no==9){j="\u4f60\u5728\u672c\u5427\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(g.no==220){j="\u4f60\u88ab\u5427\u4e3b\u52a0\u5165\u9ed1\u540d\u5355\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(g.no==221){j="\u4f60\u5df2like\u4e86\u672c\u5427,\u8bf7\u4e0d\u8981\u91cd\u590d\u64cd\u4f5c"}else{j="\u62b1\u6b49\uff0c\u5f02\u5e38\u9519\u8bef\uff0c\u5efa\u8bae\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u4e00\u4e0b"}}}new $.dialog({html:j,holderClassName:"passportDialog",title:d,draggable:false,width:338,height:87})}})});b.find(".j_sign_cancel").click(function(){c.close()})},refresh_sign_rank:function(){var a={kw:PageData.forum.name,ie:"utf-8",tbs:PageData.tbs};$.tb.get(this.sign_forum,a,function(e){var b=false;try{var c=e}catch(d){b=true}if(b){return}if(c&&c.no==0){$(".j_today_signnum").html(c.data.forum_info.current_rank_info.sign_count);$(".j_signrank_index").html(c.data.forum_info.current_rank_info.sign_rank)}else{}})},show_block_sign_dialog:function(){var a=new $.dialog({html:"<div class='signmod_likeandsign_dialog'>\u5728\u672c\u5427\u7b7e\u5230\u9700\u8981\u5148\u6210\u4e3a\u4f1a\u5458\u54e6~\u52a0\u5165\u6211\u4eec\u5427\uff01</div><div class='signmod_likeandsign_btnzone'><input class='signmod_confirm_btn j_sign_confirm' type='button' value='\u77e5\u9053\u4e86' /></div>",holderClassName:"passportDialog",title:"\u672c\u5427\u7b7e\u5230",draggable:false,width:338,height:87});$(a.element[0]).find(".j_sign_confirm").click(function(){a.close()})},succ_text:function(c,b,d,a){if(a){if(a==9){return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002"}else{if(a==10){return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u52a0\u7c97\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}else{if(a==19){return"\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5373\u53ef\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u660e\u5929\u4e0d\u8981\u5fd8\u4e86\u6765\u7b7e\u5230\u54e6\u3002"}else{if(a==20){return"\u606d\u559c\u83b7\u5f97\u53d1\u8d34\u5b57\u4f53\u53d8\u7ea2\u529f\u80fd\uff0c\u53d1\u8d34\u70ab\u8000\u5427\uff01\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}else{if(a==29){return"\u5df2\u8fde\u7eed\u7b7e\u523029\u5929\uff0c\u660e\u65e5\u7b7e\u5230\u5373\u53ef\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u4e0d\u8981\u5fd8\u4e86\u54e6~"}else{if(a==30){return"\u606d\u559c\u4f60\u83b7\u5f97ID\u7ea2\u8272\u9ad8\u4eae\u6548\u679c\uff0c\u8d76\u7d27\u53d1\u8d34\u70ab\u8000\u5427\u3002\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u54e6~"}}}}}}}var e;if(b<=10){switch(parseInt(b)){case 1:e="\u606d\u559c\u4f60\u62a2\u5f97\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u540d\uff0c\u8d76\u7d27\u622a\u56fe\u7559\u5ff5\u5427~~";break;case 2:e="\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u7b2c1\u4eba\u88ab\u62a2\u8d70\u4e86\u2026\u2026\u660e\u5929\u518d\u6765\u65e9\u4e00\u70b9\u5427~";break;default:e="\u606d\u559c\u4f60\u540d\u5217\u672c\u5427\u4eca\u65e5\u7b7e\u5230\u524d10\uff0c\u83b7\u5f97\u201c\u672c\u5427\u5fe0\u8bda\u5427\u53cb\u201d\u79f0\u53f7~";break}}else{if(b==100){e="\u54a6\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u8e29\u5230100\u4e86\uff0c\u4eca\u5929\u4f1a\u6709\u597d\u8fd0\u6c14\u5594~"}else{if(b==250){e="\u8bf7\u5728\u5fc3\u4e2d\u9ed8\u5ff53\u904d\uff1a\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u6211\u4e0d\u662f250\u2026\u2026"}else{if(b==1000){e="\u524d\u9762999\u4eba\u7684\u7ecf\u8fc7\uff0c\u53ea\u4e3a\u4e86\u6210\u5168\u4f60\u7684\u5706\u6ee1\u2026\u2026"}else{if(b==10000){e="\u80fd\u8e29\u5230\u5982\u6b64\u5927\u6574\u5b9e\u5728\u662f\u4eba\u54c1\u7206\u68da\u554a\uff01\u53ef\u4ee5\u51fa\u95e8\u4e70\u5f69\u7968\u4e86~"}else{if(c<=100){switch(parseInt(c)){case 1:e="\u672c\u5427\u7b2c\u4e00\u7684\u5730\u4f4d\uff0c\u53c8\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u7a33\u5b9a\u4e86\u2026\u2026";break;case 2:e="\u672c\u5427\u79bb\u7b2c\u4e00\u540d\u53c8\u8fd1\u4e86\u4e00\u70b9\u70b9\u70b9\u70b9\uff0c\u52a0\u6cb9\uff01";break;case 3:e="\u4fdd\u6301\u524d\u4e09\u540d\u4e0d\u5bb9\u6613\uff0c\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6~~";break;default:if(c<=10){e="\u524d\u5341\u540d\u7ade\u4e89\u6fc0\u70c8\uff0c\u8bb0\u5f97\u6bcf\u5929\u90fd\u6765\u7b7e\u5230\u54e6~"}else{if(c<=30){e="\u79bb\u524d\u5341\u540d\u8fd8\u6709\u4e9b\u8ddd\u79bb\uff0c\u5927\u5bb6\u6765\u5f97\u66f4\u52e4\u5feb\u4e9b\u5427~"}else{e="\u4e00\u767e\u5f3a\u7684\u5730\u4f4d\u9700\u8981\u5927\u5bb6\u7684\u5171\u540c\u52aa\u529b\uff0c\u52a0\u6cb9\uff01"}}break}}else{e="\u8bb0\u5f97\u660e\u5929\u8981\u6765\u7b7e\u5230\u54e6\uff0c\u5e2e\u672c\u5427\u63d0\u5347\u6392\u540d~"}}}}}}return e},set_sign_calendar:function(a,q,d,s){var g=this.jq_wrap;if(q==""||typeof(q)=="undefined"){q=this.sign_year}if(d==""||typeof(d)=="undefined"){d=this.sign_month}if(typeof(s)!="undefined"){s=parseInt(s);if(s<0){d=d-1;if(d==0){q=q-1;d=12}}else{if(s>0){d=d+1;if(d==13){q=q+1;d=1}}else{}}if(s!=0){var o=PageData.user.id;$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_month_pager",uid:o})}}var c,u,k,r;c=new Date(q,d-1,1);u=new Date(q,d,0);k=c.getDay();r=u.getDate();g.find(".j_5, .j_6").css({display:"none"});for(var f=0;f<7;f++){g.find(".j_1_"+f+", .j_5_"+f+", .j_6_"+f).html("&nbsp;").addClass("emptyDate")}for(var b=1;b<32;b++){g.find(".j_d_"+b).removeClass("signed_day signed_mob_day signed_anime_day j_d_"+b).attr({title:""})}for(var h=1,f=k,b=1;r>0;f++,r--,b++){if(f==7){f=0;h++}if(h==5){g.find(".j_5").css({display:""})}if(h==6){g.find(".j_6").css({display:""})}g.find(".j_"+h+"_"+f).addClass("j_d_"+b).html(b).removeClass("emptyDate")}if(typeof(a)!="undefined"&&a!=""){p(a)}else{$.tb.get(this.month_url,{kw:PageData.forum.name,ie:"utf-8",sign_y:q,sign_m:d},function(i){if(i&&i.no==0){p(i)}else{alert(i.no);return}},"json")}this.sign_year=q;this.sign_month=d;if(String(d).length<2){d=d+"";d="0"+d}var l=q+"\u5e74"+d+"\u6708";g.find(".j_calendar_month").html(l);function p(z){var x=z.data.sign_user_info.sign_month;var m=["\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4","\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\u767e\u5ea6\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+3\uff0c\u8fde\u7eed\u7b7e\u5230+5","\u767e\u5ea6\u624b\u673a\u6d4f\u89c8\u5668\u7b7e\u5230\u7ecf\u9a8c+4\uff0c\u8fde\u7eed\u7b7e\u5230+6","\u624b\u673a\u5ba2\u6237\u7aef\u7b7e\u5230\u7ecf\u9a8c+4\uff0c\u8fde\u7eed\u7b7e\u5230+6"];for(var v=0;v<x.length;v++){var w=x[v].t;var j=w.substr(0,w.indexOf(":"));var y=w.substr(w.indexOf(":")+1);var n="\u4e8e"+j+"\u70b9"+y+"\u5206\uff0c\u7b2c"+x[v].rank+"\u4e2a\u7b7e\u5230\uff0c";if(j=="00"&&y=="00"&&x[v].rank==""){n="\u989d\uff0c\u670d\u52a1\u5668\u8fd9\u5929\u6253\u76f9\u4e86\uff0c\u6ca1\u8bb0\u4f4f\u4f60\u662f\u51e0\u70b9\u7b7e\u5230\u7684\uff0c\u62b1\u6b49..."}switch(x[v].sign_type){case"brs":g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[2]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile_brs":g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[3]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile_client":g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[4]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"mobile":var t="\u4e8e"+j+"\u70b9"+y+"\u5206\uff0c\u7b2c"+x[v].rank+"\u4e2a\u7b7e\u5230\uff0c\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c+3,\u8fde\u7eed\u7b7e\u5230\u7ecf\u9a8c+5";g.find(".j_d_"+x[v].d).addClass("signed_mob_day").attr({title:n+m[1]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;case"pc":g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[0]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break;default:g.find(".j_d_"+x[v].d).addClass("signed_day").attr({title:n+m[0]}).die().live("mouseenter",function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_mouseover_title"})});break}}}if((this.sign_month==this.orign_month)&&(this.sign_year==this.orign_year)){if(g.find(".j_d_"+(new Date(Env.server_time)).getDate()).hasClass("signed_day")||g.find(".j_d_"+(new Date(Env.server_time)).getDate()).hasClass("signed_mob_day")){}else{var e=$(".j_signin_index").html();g.find(".j_d_"+(new Date(Env.server_time)).getDate()).addClass("signed_day").attr({title:"\u4e8e"+(new Date(Env.server_time)).getHours()+"\u70b9"+(new Date(Env.server_time)).getMinutes()+"\u5206\uff0c\u7b2c"+e+"\u4e2a\u7b7e\u5230\uff0c\u7b7e\u5230\u7ecf\u9a8c+2\uff0c\u8fde\u7eed\u7b7e\u5230+4"})}}},pvLog:function(){$("#sign_promotionlink").click(function(){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"sign_promotionlink_click"})})},signShai:function(c){var b=this;var a=navigator.userAgent.match(/iPad/i)!=null;if(document.createElement("canvas").getContext!=undefined&&!$.browser.mozilla&&PageData.product=="frs"&&!a){_.Module.use("frs/component/SignShai",["sign_mod",c.data.sign_user_info],function(d){d.bind("startRender",function(){b.cal_mouseEventRemove()});d.bind("completeRender",function(){b.cal_mouseEnterOut()})})}},sign_100:function(c){if(!c){return}var d=new Date();var a=d.getFullYear()+"\u5e74"+(d.getMonth()+1)+"\u6708"+d.getDate()+"\u65e5";var f="";f="<div class='sign_100_dlg'><div class='sign_100_"+c.continueSign+"'></div><div class='sign_100_text'><div class='sign_100_close'></div><div class='sign_100_title'>\u4eb2\u7231\u7684"+c.username+"</div>";if(c.continueSign==100){f=f+"<div class='sign_100_content'>\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+c.continueSign+"\u5929</span>\uff0c\u503c\u5f97\u7eaa\u5ff5\u7684\u65e5\u5b50\uff0c\u6709\u6728\u6709\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u771f\u5feb\u54c8\uff0c\u4ece\u7b2c\u4e00\u6b21\u7b7e\u5230\u5230\u73b0\u5728\uff0c\u5df2\u6709"+c.continueSign+"\u4e2a\u503c\u5f97\u56de\u5473\u7684\u65e5\u65e5\u591c\u591c\u5728\u8fd9\u91cc\u7559\u5b58\u3002<br/>\u8ba9\u6211\u4eec\u611f\u5230\u5f00\u5fc3\u7684\u662f\uff0c\u4f60\u4ecd\u7136\u662f\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7684"+c.memberCount+"\u4e2a<span class='sign_baname_highlight'>"+c.memberTitle+"</span>\u4e2d\u575a\u5b9e\u7684\u4e00\u4efd\u5b50\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230"+c.continueSign+"\u5929\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\uff0c\u5e76\u5feb\u4e50\u3002<br/></div>"}else{f=f+"<div class='sign_100_content'>\u77e5\u9053\u5417\uff0c\u4eca\u5929\u662f\u4f60\u5728\u54b1\u4eec<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7b7e\u5230\u7684<span class='rank_number'>\u7b2c"+c.continueSign+"\u5929</span>\uff0c\u6574\u6574\u4e00\u4e2a\u6708\u5566\uff01<br/>\u65f6\u95f4\u8fc7\u5f97\u633a\u5feb\u7684\u54c8\uff0c\u4ece\u4f60\u7b2c\u4e00\u6b21\u5230\u672c\u5427\u7b7e\u5230\uff0c\u70b9\u4e0e\u4e0d\u70b9\u95f4\uff0c\u5728\u8d34\u5427\u5ea6\u8fc7\u4e86"+c.continueSign+"\u4e2a\u7f8e\u597d\u7684\u65e5\u5b50\u3002<br/>\u4eca\u540e\u7684\u8def\u8fd8\u957f\u7740\u5462\uff0c\u8877\u5fc3\u5e0c\u671b\u4f60\u5728<span class='sign_baname_highlight'>"+c.forumname+"</span>\u5427\u7684\u6bcf\u4e00\u5929\u90fd\u80fd\u5f00\u5fc3\uff0c\u4e0e\u5168\u4f53\u5427\u53cb\u4eec\u76f8\u77e5\u76f8\u7231\u3002<br/>\u4eca\u5929\uff0c\u7b7e\u5230\u6ee1\u6708\uff1b\u6b64\u540e\uff0c\u8ba9\u6211\u4eec\u4f9d\u7136\u5171\u540c\u6210\u957f\u3002<br/></div>"}f=f+"<div class='sign_100_message'><a href='/i/sys/jump?un=%CC%F9%B0%C9%C7%A9%B5%BD%D0%A1%C3%D8%CA%E9' target='_blank'>\u8d34\u5427\u7b7e\u5230\u5c0f\u79d8\u4e66</a><img src='http://tb2.bdstatic.com/tb/img/itieba_vip.gif' title='\u8d34\u5427\u5b9e\u540d\u8ba4\u8bc1' class='verified_icon'>&nbsp;&nbsp;&nbsp;&nbsp;"+a+"&nbsp;&nbsp;&nbsp;&nbsp;<button class='j_sign_100_shai sign_100_shai_btn'>&nbsp;</button></div></div></div>";$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"ucenter",st_type:"sign_100_display"+c.continueSign});var e=new $.dialog({html:f,holderClassName:"sign_100_wapper",width:"681",showTitle:false});$(e.element[0]).find(".sign_100_close").click(function(){e.close()});var b=navigator.userAgent.match(/iPad/i)!=null;if(document.createElement("canvas").getContext!=undefined&&!$.browser.mozilla&&PageData.product=="frs"&&!b){$(".j_sign_100_shai").show();_.Module.use("ucenter/component/sign100",["dialogJbody",c.continueSign],function(g){g.bind("completeRender",function(){e.close()})})}},sign_right_tips:function(b){var d=[PageUnit.load("sign_mod_tiptitle1"),PageUnit.load("sign_mod_tiptitle2"),PageUnit.load("sign_mod_tiptitle3"),PageUnit.load("sign_mod_tiptitle4"),PageUnit.load("sign_mod_tiptitle5")];var j=[PageUnit.load("sign_mod_tiptext1"),PageUnit.load("sign_mod_tiptext2"),PageUnit.load("sign_mod_tiptext3"),PageUnit.load("sign_mod_tiptext4"),PageUnit.load("sign_mod_tiptext5")];var g=[PageUnit.load("sign_mod_tipcondition1"),PageUnit.load("sign_mod_tipcondition2"),PageUnit.load("sign_mod_tipcondition3"),PageUnit.load("sign_mod_tipcondition4"),PageUnit.load("sign_mod_tipcondition5")];$(".sign_rights").css("position","relative").css("z-index","1");var a=[81,110,142,173,203];var h=b+1;var f={icon:"sign_big_icon_"+h,title:d[b],text:j[b],condition:g[b],position_right:13,arr_right:a[b]};var c={content:"<div class='sign_rights_tip'><div class='sign_rights_top clearfix'><div class='sign_rights_big_icon "+f.icon+"'></div><div class='sign_rights_text_wapper'><div class='sign_rights_title'>"+f.title+"</div><div class='sign_rights_title_text'>"+f.text+"</div></div></div><div class='sign_rights_popline'></div><div class='sign_rights_condition'>"+f.condition+"</div></div>",arrow_dir:"up",bubble_css:{top:35,right:f.position_right,width:250,"z-index":9999},arrow_pos:{left:f.arr_right},attr:" ",wrap:$(".sign_rights"),closeBtn:false};if(this.rights_tips[b]===null){var e=new UiBubbleTipBase(c);e.showBubble();this.rights_tips[b]=e}else{this.rights_tips[b].showBubble()}$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"ucenter",st_type:"sign_rights_display_"+b})},check_rights_status:function(a){$(".j_sign_rights_icon:eq(0)").addClass("rights_get");$.stats.hive("sign_rights_exp1");if(a>=2){$(".j_sign_rights_icon:eq(1)").addClass("rights_get");$.stats.hive("sign_rights_exp2")}if(a>=10){$(".j_sign_rights_icon:eq(2)").addClass("rights_get");$.stats.hive("sign_rights_exp3")}if(a>=20){$(".j_sign_rights_icon:eq(3)").addClass("rights_get");$.stats.hive("sign_rights_exp4")}if(a>=30){$(".j_sign_rights_icon:eq(4)").addClass("rights_get");$.stats.hive("sign_rights_exp5")}},mobile_sign_tip:function(){var a=(new Date()-new Date("2012/11/20"))/86400000;if(a>=30||a<=0){return}if($.cookie("close_mobile_tip")=="true"){return}$("#j_sign_tip_holder").css("position","relative").css("z-index","1");var c={content:"<div class='sign_mob_tip clearfix'><div class='sign_mob_tip_icon'></div><div class='sign_mob_tip_text'>\u624b\u673a\u7b7e\u5230\u7ecf\u9a8c\u66f4\u591a\uff0c<br/>\u4f55\u4e0d\u8bd5\u8bd5\u624b\u673a\u8d34\u5427\u5ba2\u6237\u7aef\u3002<br/><a href='http://c.tieba.baidu.com/c/s/download/pc?src=webtbnotsign' target='_blank'>\u9a6c\u4e0a\u53bb\u4e0b\u8f7d>></a></div></div>",arrow_dir:"up",bubble_css:{top:0,right:15,width:230,"z-index":9999},arrow_pos:{left:140},attr:" ",wrap:$("#j_sign_tip_holder"),closeBtn:true};var b=new UiBubbleTipBase(c);b.showBubble();b.bind("onclose",function(){$.cookie("close_mobile_tip",true,{expires:3,path:"/"})},true)}}}});;_.Module.define({path:"common/component/LoginForm",sub:{_formKey:"",_formType:0,_jq_wrapper:null,_loginInstance:null,_pageLoginIndex:0,_userInputTip:{_jq_input:null,_jq_tip:null,init:function(b){var a=this;this._jq_input=b;this._jq_tip=$('<span class="user_input_tip" title="\u7528\u6237\u540d/\u90ae\u7bb1" style="">\u7528\u6237\u540d/\u9a8c\u8bc1\u90ae\u7bb1</span>');b.after(this._jq_tip).focus(function(){a.hide()});this._jq_tip.click(function(){b.focus()})},show:function(){if($.trim(this._jq_input.val())==""){this._jq_tip.show();this._hideByCondition()}},hide:function(){this._jq_tip.hide()},_hideByCondition:function(){var a=this,c=1500;var b=setInterval(function(){if($.trim(a._jq_input.val())!=""){a.hide();clearInterval(b);return}if(c==0){clearInterval(b);return}c-=20},20)}},initial:function(c,e,b){this._formKey=e;this._formType=b?b:this._formType;this._jq_wrapper=c;this._loginManager=this._initLoginManager();var a=this;var d=(typeof Env!="undefined"&&Env.server_time)?Env.server_time:new Date().getTime();$.JsLoadManager.use("http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(d/60000),function(){a._initLoginApi()})},_initLoginApi:function(){var a=this;passport.use("login",{tangram:true},function(b){a._loginInstance=new b.passport.login({product:"tb",loginType:1,u:window.location.href,isPhone:false,safeFlag:0,memberPass:true,staticPage:"http://tieba.baidu.com/tb/static-common/html/pass/v3Jump.html"});a._pageLoginIndex=a._loginManager.addLoginForm(a._loginInstance);var c=a._jq_wrapper.find(".login_form")[0];a._loginInstance.render(c);c=null;var d=$(a._loginInstance.getElement("userName"));a._userInputTip.init(d);a._userInputTip.show();a._loginInstance.on("loginError",function(e){var f=e.rsp.errInfo;if(f.no==110024){f.msg="";a._loginManager.errIndex=a._pageLoginIndex;if(a._formType==0){a._showPopErrorTip()}else{if(a._formType==1){a._showTextErrorTip(f.msg)}}}});a._loginInstance.on("loginSuccess",function(e){Stats.sendRequest("fr=tb0_forum&st_mod="+a._formKey+"&st_type=login_succeed");window.location.reload();e.returnValue=false});a._loginInstance.on("beforeSubmit",function(e){Stats.sendRequest("fr=tb0_forum&st_mod="+a._formKey+"&st_type=login_click")});a._initTab();a._jq_wrapper.removeClass("login_wrapper_beforeshow")})},_clearInputTips:function(a,e){var b=this,d=1500;var c=setInterval(function(){if($.trim(a.val())!=""){e.hide();clearInterval(c);return}if(d==0){clearInterval(c);return}d-=20},20)},_initLoginManager:function(){window.LoginManager=window.LoginManager||{loginForms:[],errIndex:0,validateEmail:function(b){var a=$(this.loginForms[this.errIndex].getElement("error"));if(b.errno==0){a.html('<img class="email_validate_ok" src="'+PageData.staticDomain+'tb/static-pb/img/right.png" alt="\u56fe\u7247"/>\u91cd\u53d1\u9a8c\u8bc1\u4fe1\u6210\u529f');a.css("color","#000000");setTimeout(function(){a.html("")},5000)}else{a.html("\u91cd\u53d1\u9a8c\u8bc1\u4fe1\u5931\u8d25");a.css("color","#FF0000")}},addLoginForm:function(a){this.loginForms.push(a);return this.loginForms.length-1}};return window.LoginManager},_initTab:function(){var a=this;var b=["normal","phone"];a._jq_wrapper.find(".login_tab_main>li").each(function(c){$(this).click(function(d){d.preventDefault();if(a._loginInstance){a._jq_wrapper.find(".login_tab_main>li>a").removeClass("focus");$(this).children("a").addClass("focus");a._loginInstance.switchTo(b[c]);if(b[c]=="phone"){a._userInputTip.hide()}if(b[c]=="normal"){a._userInputTip.show()}}})})},_showPopErrorTip:function(){var c=this;var a=new Array();a.push('<p class="active_email">\u8d26\u6237\u5c1a\u672a\u6fc0\u6d3b</p>');a.push("<p>\u8bf7\u5230\u6ce8\u518c\u9a8c\u8bc1\u90ae\u7bb1\u4e2d\u6fc0\u6d3b\uff0c\u6216</p>");a.push('<p>\u8005<a class="validate_email_link" href="#" target="_blank">\u91cd\u53d1\u9a8c\u8bc1\u90ae\u4ef6</a></p>');var b={content:"<div style='width:170px'>"+a.join("")+"</div>",arrow_dir:"down",bubble_css:{top:65,left:15,width:186},arrow_pos:{left:40},wrap:c._jq_wrapper.find(".j_login_tip_wrapper"),closeBtn:true};var d=new UiBubbleTipBase(b);d.showBubble();$(c).bind("validateEmailSent",function(){if(d!=null){d.closeBubble()}d=null});c._sendValidateEmail()},_showTextErrorTip:function(c){var b=this;var a=new Array();a.push("\u8d26\u6237\u5c1a\u672a\u6fc0\u6d3b\uff0c\u8bf7\u5230\u6ce8\u518c\u9a8c\u8bc1\u90ae\u7bb1\u4e2d\u6fc0\u6d3b\uff0c\u6216\u8005");a.push('<a class="validate_email_link" href="#" target="_blank">\u91cd\u53d1\u9a8c\u8bc1\u90ae\u4ef6</a>');c=a.join("");b._sendValidateEmail()},_sendValidateEmail:function(){var b=this;var a=b._jq_wrapper.find("a.validate_email_link");a.bind("click",function(){var c="https://passport.baidu.com/v2/?regmailsend&callback=LoginManager.validateEmail&tpl=tb&user="+$(b._loginInstance.getElement("userName")).val()+"&t="+Math.floor((new Date().getTime())/60000);$.JsLoadManager.use(c,function(){$(b).trigger("validateEmailSent")});return false})}}});var Tinytip={closeTip:function(d,b){var c=document.getElementById(d);var a=document.getElementById(b);if(c&&a){c.removeChild(a)}},doClose:function(a,e,d,b,c){Tinytip.closeTip(e,d);if(b){c()}if(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}}},render:function(j,i,l,a,m,g,b,e,n){a=a?a:false;m=m?m:false;g=g?g:1;b=b?b:false;n=n?n:false;var h=document.getElementById(j);var c="tinytip_"+new Date().getTime().toString()+parseInt(Math.random()*10,10).toString();var k=null;if(h){k=document.createElement("div");k.id=c;k.className="tinytip_root";h.appendChild(k);if(n){k.innerHTML=Tinytip._render_left(j,c,l,b,e,i);var f;var d;if($(h).css("position")=="relative"){f=0;d=0}else{f=$(h).offset().left;d=$(h).offset().top}k.style.left=f-15+"px";k.style.top=d+h.offsetHeight+"px"}else{k.innerHTML=Tinytip._render_right(j,c,l,b,e,i);var f;var d;if($(h).css("position")=="relative"){f=0;d=0}else{f=$(h).offset().left;d=$(h).offset().top}k.style.left=h.offsetWidth+f-k.offsetWidth+"px";if(n){k.style.top=d+h.offsetHeight+"px"}else{k.style.top=d+h.offsetHeight+6+"px"}}if(a){h.onmouseout=function(o){Tinytip.doClose(o,j,c,b,e)}}if(m){setTimeout(function(){Tinytip.doClose(null,j,c,b,e)},parseInt(g,10)*1000)}}},_render_left:function(g,e,a,f,b,d){var c=new Array();c.push("<table cellspacing='0' cellpadding='0' class=''>");c.push("<tr>");c.push("<td class='tip_i'></td>");c.push("<td class='tip_ii'></td>");c.push("<td class='tip_ii'><div class='tip_trg2'></div></td>");c.push("<td class='tip_ii'></td>");c.push("<td class='tip_iii'></td>");c.push("</tr>");c.push("<tr>");c.push("<td class='tip_iv'>&nbsp;</td>");c.push("<td class='tip_v_0'>&nbsp;</td>");c.push("<td class='tip_v_1' valign='middle'>");c.push(d);c.push("</td>");c.push("<td class='tip_v_2' align='right' valign='top'>");if(a){c.push("<img src='"+PageData.staticDomain+"tb/img/tinytip/tip_close.png' onclick='Tinytip.doClose(event,\""+g+'","'+e+'",'+f+","+b+");' />")}else{c.push("<div style='width:10px;'>&nbsp;</div>")}c.push("</td>");c.push("<td class='tip_vi'>&nbsp;</td>");c.push("</tr>");c.push("<tr>");c.push("<td class='tip_vii'></td>");c.push("<td class='tip_viii' colspan='3'></td>");c.push("<td class='tip_ix'></td>");c.push("</tr>");c.push("</table>");return c.join("")},_render_right:function(g,e,a,f,b,d){var c=new Array();c.push("<table cellspacing='0' cellpadding='0' class=''>");c.push("<tr>");c.push("<td class='tip_i'></td>");c.push("<td class='tip_ii'></td>");c.push("<td class='tip_trg'></td>");c.push("<td class='tip_iii'></td>");c.push("</tr>");c.push("<tr>");c.push("<td class='tip_iv'>&nbsp;</td>");c.push("<td class='tip_v_1' valign='middle'>");c.push(d);c.push("</td>");c.push("<td class='tip_v_2' align='right' valign='top'>");if(a){c.push("<img src='"+PageData.staticDomain+"tb/img/tinytip/tip_close.png' onclick='Tinytip.doClose(event,\""+g+'","'+e+'",'+f+","+b+");' />")}else{c.push("<div style='width:10px;'>&nbsp;</div>")}c.push("</td>");c.push("<td class='tip_vi'>&nbsp;</td>");c.push("</tr>");c.push("<tr>");c.push("<td class='tip_vii'></td>");c.push("<td class='tip_viii' colspan='2'></td>");c.push("<td class='tip_ix'></td>");c.push("</tr>");c.push("</table>");return c.join("")}};var Balv={config:{url:{dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete",closetip:"/f/like/commit/notice/delete"}},__body:function(){var a=0,i=0,g=0,c=0,b=0,j=0;var h=window,e=document,f=e.documentElement;a=f.clientWidth||e.body.clientWidth;i=h.innerHeight||f.clientHeight||e.body.clientHeight;c=e.body.scrollTop||f.scrollTop;g=e.body.scrollLeft||f.scrollLeft;b=Math.max(e.body.scrollWidth,f.scrollWidth||0);j=Math.max(e.body.scrollHeight,f.scrollHeight||0,i);return{scrollTop:c,scrollLeft:g,documentWidth:b,documentHeight:j,viewWidth:a,viewHeight:i}},showFloatTip:function(c){var a=document.getElementById("userlike_tip");var b=null;if(c=="join"){return}else{if(c=="lvup"){b=document.getElementById("userlike_tip_lvup")}}if(a){var d=Balv.__body();a.style.width=d.documentWidth+"px";a.style.height=d.documentHeight+"px";a.style.display="block";if(b){b.style.display="block";b.style.left=Math.max(parseInt((d.viewWidth-b.offsetWidth)/2,10),0)+d.scrollLeft+"px";b.style.top=Math.max(parseInt((d.viewHeight-b.offsetHeight)/2,10),0)+d.scrollTop+"px"}}if(c=="lvup"){setTimeout(function(){Balv.closeFloatTip("lvup")},5000)}},closeFloatTip:function(c){var a=document.getElementById("userlike_tip");var b=null;if(c=="join"){b=document.getElementById("userlike_tip_join")}else{if(c=="lvup"){b=document.getElementById("userlike_tip_lvup")}}if(a){a.style.display="none"}if(b){b.style.display="none"}if(c=="lvup"){Balv._close_tip("lvup")}},showAlert:function(b){var a='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+b+"</div>";$.dialog.open(a,{title:"\u64cd\u4f5c\u5931\u8d25",width:380})},howtojoin:function(){$.dialog.alert("<div style='padding:20px;line-height:30px;padding-bottom:0px;'>\u70b9\u51fb\u53f3\u4fa7\u4e0a\u65b9\u201c<img align='absmiddle' src='"+PageData.staticDomain+"tb/static-member/img/whatlevel.png'></img>\u201d<br/>\u5373\u53ef\u52a0\u5165\u672c\u5427\uff0c\u70b9\u4eae\u5934\u8854\uff0c\u4ece\u521d\u7ea7\u7c89\u4e1d\u5f00\u59cb\u6210\u957f\uff01</div>",{title:"\u5982\u4f55\u52a0\u5165",width:325})},dolike:function(){if(PageData.user.is_login&&PageData.user.no_un){TbCom.process("User","buildUnameFrame","\u586b\u5199\u7528\u6237\u540d","\u6709\u7528\u6237\u540d\u624d\u80fd\u70b9\u4eae\u201c\u6211\u559c\u6b22\u201d\uff0c\u8d76\u5feb\u7ed9\u81ea\u5df1\u8d77\u4e00\u4e2a\u5427~");return false}var a={fid:PageData.forum.id,fname:PageData.forum.name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs};$.post(Balv.config.url.dolike,a,function(i){var c=false;try{var d=i}catch(e){c=true}if(c){return}if(d&&d.no==0){Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid);if(d.like_no&&(d.like_no>=1)){var b=$.dialog.alert('<img src="'+PageData.staticDomain+'tb/static-frs/img/like_back.png">',{width:320,height:131,acceptValue:"\u77e5\u9053\u4e86"});$(b.element[0]).find(".dialogJcontent").css("padding-bottom","0px");$(b.element[0]).find(".dialogJanswers").css("padding-top","0px");b.bind("onaccept",function(j){window.location.reload()}).bind("onclose",function(j){window.location.reload()})}else{var g="";g+='<div class="userlike_tip_join" id="userlike_tip_join">';g+='<div class="userlike_tip_info" id="userlike_tip_info"></div>';if(PageData.user.balv.level_id==1){g+='<div class="user_rights_msg">\u83b7\u5f97\u5934\u8854&nbsp;<img src="'+PageData.staticDomain+'tb/static-frs/img/balv/lv_join.png">&nbsp;'+PageData.user.balv.level_name+'\uff0c\u5347\u7ea7\u4eab\u7279\u6743\uff0c<a target="_blank" href="/f/like/level?kw='+PageData.forum.name_url+'">\u67e5\u770b\u5347\u7ea7\u79d8\u7c4d</a></div>'}else{g+='<div class="user_rights_msg">\u6839\u636e\u4f60\u5728\u672c\u5427\u7684\u6d3b\u8dc3\u8868\u73b0\uff0c\u76f4\u63a5\u6388\u4e88<img src="'+PageData.staticDomain+"tb/static-member/img/badges/"+PageData.user.balv.level_id+'.png">&nbsp;'+PageData.user.balv.level_name+"\uff0c\u7ed9\u529b\uff01</div>";g+='<div class="userlike_tip_span">\u672c\u5427\u767e\u5b9d\u7bb1\u5bf9\u4f60\u5f00\u653e\u4e86\uff0c<a target="_blank" href="/imall/mall?kw='+PageData.forum.name_url+'">\u53bb\u767e\u5b9d\u7bb1\u770b\u770b\u6709\u54ea\u4e9b\u7279\u6743\u548c\u5b9d\u8d1d</a></div>'}g+='<div class="lvlup_tip_btnzone"><input class="lvlup_pop_btn" type="button" value="\u77e5\u9053\u4e86"/></div>';g+="</div>";var b=$.dialog.open(g,{title:"\u6210\u529f\u63d0\u793a",width:418});$(b.element[0]).find(".dialogJcontent").attr("id","balv_first_like_dialog");$(b.element[0]).find(".userlike_tip_span a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=entryimallinpop")});$(b.element[0]).find(".lvlup_pop_btn").eq(0).bind("click",function(j){window.location.reload()});b.bind("onclose",function(j){window.location.reload()});var f="";f+="<span>\u606d\u559c\u4f60\u6210\u4e3a\u672c\u5427\u7b2c</span>";f+="<span class='tip_font_orange'>"+d.data.ret.index+"</span>";f+="<span>\u4f4d\u4f1a\u5458</span>";$("#userlike_tip_info").html(f)}}else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+d.no);var h="";if(d.no==8||d.no==9){h="\u4f60\u5728\u672c\u5427\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(d.no==220){h="\u4f60\u88ab\u5427\u4e3b\u52a0\u5165\u9ed1\u540d\u5355\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(d.no==221){h="\u4f60\u5df2like\u4e86\u672c\u5427,\u8bf7\u4e0d\u8981\u91cd\u590d\u64cd\u4f5c"}else{h="\u62b1\u6b49\uff0c\u5f02\u5e38\u9519\u8bef\uff0c\u5efa\u8bae\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u4e00\u4e0b"}}}Balv.showAlert(h)}},"json")},undolike:function(){var a={fid:PageData.forum.id,fname:PageData.forum.name_url,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs};$.tb.post(Balv.config.url.undolike,a,function(e){var b=false;try{var c=e}catch(d){b=true}if(b){return}if(c&&c.no==0){window.location.reload(true)}else{}})},showexpbar:function(){var d=document.getElementById("userlike_expbar");var c=document.getElementById("userlike_expnum_cur");var e=document.getElementById("userlike_expnum_max");var f=0;var a=0;if(c&&e){f=parseInt(c.innerHTML,10);a=parseInt(e.innerHTML,10)}var b=parseInt(document.getElementById("userlike_expborder").offsetWidth,10);if(f==0){d.style.display="none"}else{d.style.display="block"}if(a!=0){d.style.width=parseInt(b*f/a,10)+"px"}},show_titleset_tip:function(){var a=(new Date()-new Date("2011/11/18"))/86400000;if(a>=14||a<=0){return}if($.cookie("close_titleset_tip")=="false"){return}$.cookie("close_titleset_tip",true,{expires:14});var b=new Array();b.push("<div style='width:220px;padding:3px 0'>");b.push("\u53ef\u5bf9\u4f1a\u5458\u8fdb\u884c\u7ba1\u7406\uff0c\u5305\u62ec\u5934\u8854\u540d\u8bbe\u7f6e\u3002");b.push("</div>");Tinytip.render("titleManageLink",b.join(""),true,false,false,1,true,function(){$.cookie("close_titleset_tip",false,{expires:14})})},show_tcbox_tip:function(){var a=(new Date()-new Date("2012/04/01"))/86400000;if(a>=1||a<=0){return}if($.cookie("close_tcbox_tip")=="false"){return}$.cookie("close_tcbox_tip",true,{expires:14});var b=new Array();b.push("<div style='width:145px;padding:4px;text-align:left;'>");b.push("\u611a\u4eba\u8282\uff0c\u5934\u50cf\u76f8\u6846\u5927\u53d8\u8eab\uff01\u8bb0\u5f97\u8981\u9884\u89c8\u5594~");b.push("</div>");Tinytip.render("my_entrance_tcbox",b.join(""),true,false,false,1,true,function(){Balv.clean_tcbox_session()},true)},clean_tcbox_session:function(){$.cookie("close_tcbox_tip",false,{expires:14})},show_firstlike_tip:function(){var a=new Array();a.push("<div style='width:200px;'>");a.push("<img style='vertical-align: middle; margin-bottom: 5px;width:16px;height:16px;' src='"+PageData.staticDomain+"/tb/img/icon_tip1.png?v=1.0' />");a.push("<a href='' onclick='BalvInfo.render();return false;' target='_blank'>\u5982\u4f55\u83b7\u5f97\u7ecf\u9a8c\uff0c\u63d0\u5347\u5934\u8854\uff1f</a>");a.push("</div>");Tinytip.render("userlike_info_tip",a.join(""),true,false,false,1,true,Balv.close_firstlike_tip)},close_firstlike_tip:function(){Balv._close_tip("first")},show_shortblock_tip:function(c,a){var b=new Array();b.push("<div style='width:205px;text-align:left;margin:6px 0px 6px 10px;'>");b.push("<div style='width:205px;'><span>\u4f60\u5df2\u88ab"+a+"\u5c01\u7981\uff0c\u8fd8\u5269</span><span style='color:#ff7f40;font-weight:bold;'>"+c+"</span><span>\u5929\u89e3\u5c01,<span></br><span>\u5c01\u7981\u671f\u95f4\u4e0d\u52a0\u7ecf\u9a8c\uff0c\u5934\u8854\u548c\u6743\u9650\u6536\u56de\u3002</span></div><div style='text-align:right;margin-right:5px;'><a href='http://tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</a></div>");b.push("</div>");Tinytip.render("userliked_ban_content",b.join(""),false,false,true,2,false)},show_block_tip:function(){var a=new Array();a.push("<div style='width:205px;text-align:left;margin:6px 0px 6px 10px;'>");a.push("<div><span>\u4f60\u5df2\u88ab\u7cfb\u7edf\u6c38\u4e45\u5c01\u7981\uff0c<br/>\u5c01\u7981\u671f\u95f4\u4e0d\u52a0\u7ecf\u9a8c\uff0c\u5934\u8854\u548c\u6743\u9650\u6536\u56de\u3002</span></div><div style='text-align:right;margin-right:5px;'><a href='http://tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</a></div>");a.push("</div>");Tinytip.render("userliked_ban_content",a.join(""),false,false,true,2,false)},show_black_tip:function(){var a=new Array();a.push("<div style='width:180px;text-align:left;margin:6px 0px 6px 10px;'>");a.push("<span>\u4f60\u5df2\u88ab\u5427\u4e3b\u62c9\u5165\u9ed1\u540d\u5355\uff0c</span></br><span>\u4f60\u5728\u672c\u5427\u7684\u5934\u8854\u548c\u6743\u9650\u4e5f\u88ab\u6536\u56de\u3002</span>");a.push("</div>");Tinytip.render("userliked_ban_content",a.join(""),false,true,true,2,false)},show_award_tip:function(d,e,a,c){var b=new Array();b.push("<div style='width:210px;'>");b.push("<div style='float:left;text-align:left;padding-left:12px;padding-top:9px;line-height:18px;'><span style='color:#555555;'>"+d+"</span></br>");b.push("<div style='float:left;text-align:left;line-height:18px;padding-bottom:6px;'><a href='"+a+"' style='display:inline;'>"+c+"</a></br>");b.push("</div></div>");Tinytip.render("userlike_info_tip",b.join(""),true,false,true,8,true,Balv.close_award_tip);Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlvup")},close_award_tip:function(){Balv._close_tip("award")},show_trans_tip:function(b){var a=new Array();a.push("<div style='width:170px;padding: 8px 0px 8px 8px;text-align:left;'>");a.push("<div style='width:170px;line-height:18px;color:#555555;'><span>"+b+"</span></div>");a.push("<div style='width:170px;line-height:22px;'><img style='vertical-align: middle;margin-bottom: 5px;width:16px;height:16px;' src='"+PageData.staticDomain+"/tb/img/icon_tip1.png?v=1.0' /><a href='' onclick='BalvInfo.render();return false;' target='_blank'>\u5982\u4f55\u83b7\u5f97\u7ecf\u9a8c\uff0c\u63d0\u5347\u5934\u8854\uff1f</a></div>");a.push("</div>");Tinytip.render("userlike_info_tip",a.join(""),true,false,false,1,true,Balv.close_trans_tip)},show_expire_tip:function(e){$("#my_entrance_tcbox").css("position","relative").css("z-index","10");var b=new Array();b.push("<div style='width:240px;padding: 8px 0px 8px 8px;text-align:left;'>");b.push("<div style='width:240px;line-height:18px;color:#555555;'><span>"+e+"</span></div>");b.push("<div style='width:240px;line-height:22px;'><a href='/imall/mall?kw="+PageData.forum.name_url+"#!/tc/my/' style='padding-left:0px;' target='_blank'>\u7acb\u5373\u7eed\u8d39</a></div>");b.push("</div>");var c=b.join("");var d={content:c,arrow_dir:"up",bubble_css:{top:15,right:-5,width:252,"z-index":9999},arrow_pos:{left:209},attr:"lvup_tip_table",wrap:$("#my_entrance_tcbox"),closeBtn:true};var a=new UiBubbleTipBase(d);a.j_bubble.find(".j_content").css("padding","2px");a.showBubble();setTimeout(function(){a.closeBubble();$("#my_entrance_tcbox").css("position","static")},1000)},show_furank_tip:function(){if($.cookie("close_furank_tip")=="1"){return}$.cookie("close_furank_tip","0",{expires:14});var a=new Array();if(PageData.user.balv.has_liked){a.push("<div style='width:160px;padding:4px 0px 0px 0px;text-align:left;'>")}else{a.push("<div style='width:160px;padding:4px 0px 0px 8px;text-align:left;'>")}a.push("\u5427\u5185\u5f71\u54cd\u529b\u6392\u884c\u699c\u706b\u70ed\u5f00\u699c\uff01<br/>\u770b\u770b\u4f60\u5728\u5427\u91cc\u4ec0\u4e48\u6c34\u5e73~");a.push("</div>");Tinytip.render("entrance_rank",a.join(""),true,false,false,1,true,Balv.close_furank_tip,PageData.user.balv.has_liked)},close_furank_tip:function(){$.cookie("close_furank_tip","1",{expires:14})},close_trans_tip:function(){Balv._close_tip("trans")},show_lvup_tip:function(h,g){var b=new Array();b.push("<div class='lvup_tip_container'>");b.push("<div class='lvlup_con_msg'>\u5347\u7ea7\u5566!\u4f60\u5df2\u62e5\u6709\u672c\u5427"+h+"\u7ea7\u5934\u8854!</div>");b.push('<div class="lvlup_pop_rights">'+g+"</div>");if(g=="\u52a0\u6cb9~\u7ee7\u7eed\u6512\u7ecf\u9a8c\uff01"){b.push("<a style='float:left;' href='/f/like/level?kw="+PageData.forum.name_url+"' target='_blank'>\u67e5\u770b\u5347\u7ea7\u79d8\u7b08</a>")}else{var e='Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=balvupguide&lv='+h+'")';b.push("<a href='#sub' style='float:left;' onclick='rich_postor.jumpToTry("+h+");"+e+"'>\u73b0\u5728\u53bb\u8bd5\u8bd5~~</a>")}var d='Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=lvup_imallentrance")';b.push("<a target='_blank' onclick='"+d+"' style='float:left;margin-left:15px' href='/imall/mall?kw="+PageData.forum.name_url+"'>\u53bb\u767e\u5b9d\u7bb1\u770b\u770b</a>");b.push("</div>");var c=b.join("");var f={content:c,arrow_dir:"up",bubble_css:{top:4,right:-5,width:232,"z-index":9999},arrow_pos:{left:209},attr:"lvup_tip_table",wrap:$("#userlike_info_tip"),closeBtn:true};var a=new UiBubbleTipBase(f);a.j_bubble.find(".j_content").css("padding","2px").addClass("lvup_tip_table");a.showBubble();a.bind("onclose",function(){Balv.close_lvup_tip()},true);setTimeout(function(){a.closeBubble();Balv.close_lvup_tip()},8000)},show_liked_forum_tip:function(){if($.cookie("close_liked_forum_tip")==1){return}var a=new $.tb.Poptip($(".like_title")[0],{holderClassName:"liked_forum_tip",contentClassName:"liked_forum_tip_content clearfix",html:'<div>\u70b9\u51fb\u8fd9\u91cc\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5bf9\u559c\u6b22\u7684\u5427<br/>\u8fdb\u884c\u8bbf\u95ee\u54e6</div><img src="http://tb2.bdstatic.com/tb/img/tinytip/tip_close.png">',direction:"above",arrowClassName:"tb-ui-poptip-narrow",autoShow:true,needArrow:true,arrowOffset:null,offsetX:-80,offsetY:5,onBeforeShow:function(){},onClose:function(){$.cookie("close_liked_forum_tip","1",{expires:30})}});$(a.holder).find("img").click(function(){a.close()});setTimeout(function(){$(".liked_forum_tip img").click()},10000)},close_lvup_tip:function(){var a={fid:PageData.forum.id,fname:PageData.forum.name_url,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs,type:2};$.tb.post(Balv.config.url.closetip,a,function(e){var b=false;try{var c=e}catch(d){b=true}if(b){return}if(c&&c.no==0){}else{}})},show_orange_tip:function(){if($.cookie("close_sign_tip_o")=="false"){return}$.cookie("close_sign_tip_o",true,{expires:14});$(".userlike_info").css("position","relative");var b={content:"\u8fde\u7eed\u7b7e\u523030\u5929ID\u5373\u53ef\u9ad8\u4eae\u5c55\u793a\uff0c\u4e00\u8d77\u95ea\u8000\u5427\uff01",arrow_dir:"down",bubble_css:{top:10,right:65,width:145,"z-index":9999},arrow_pos:{left:88},attr:" ",wrap:$(".userlike_info"),closeBtn:true};var a=new UiBubbleTipBase(b);a.j_bubble.find(".j_body").css("padding-right","3px");a.showBubble();a.bind("onclose",function(){$.cookie("close_sign_tip_o",false,{expires:14})},true);setTimeout(function(){$(".j_wrap .j_close").click()},8000)},_close_tip:function(a){var c={first:1,award:4,lvup:2,trans:3};var b={fid:PageData.forum.id,fname:PageData.forum.name_url,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs,type:c[a]};$.tb.post(Balv.config.url.closetip,b,function(g){var d=false;try{var e=g}catch(f){d=true}if(d){return}if(e&&e.no==0){}else{}})},render_balv_tip_configs:function(a){return{content:a,arrow_dir:"up",bubble_css:{top:98,left:4,width:170,"z-index":100},arrow_pos:{left:88},attr:" ",wrap:$("#userlike_info"),closeBtn:true}},show_pic_tip:function(){if(!PageData.is_login){return}var a=(new Date()-new Date("2012/10/16"))/86400000;if(a>=21||a<=0){return}if($.cookie("pic_guide")=="1"){return}var c=PageData.forum.name_url||"test";var d={content:'<a href="/f/like/level?kw='+c+'&lv_t=lv_nav_who" onclick="$.stats.sendRequest(\'fr=tb0_forum&st_type=pic_guide&st_value=intip\')" target="_blank">\u53d1\u56fe\u7247\u8d34\u53ef\u83b7\u989d\u5916\u7ecf\u9a8c\u54e6\uff01</a>',arrow_dir:"up",bubble_css:{top:98,left:4,width:170,"z-index":100},arrow_pos:{left:88},attr:" ",wrap:$("#userlike_info"),closeBtn:true};var b=new UiBubbleTipBase(d);b.showBubble();b.bind("onclose",function(){$.cookie("pic_guide","1",{expires:14,path:"/"});$.stats.sendRequest("fr=tb0_forum&st_type=pic_guide&st_value=closetip")},true)}};var BalvInfo={render:function(a,b){window.open("/f/like/level?kw="+PageData.forum.name_url)}};;function UserTitle(){this.init()}UserTitle.prototype={constructor:UserTitle,init:function(){if(PageData.is_login){this.bindEvents()}},bindEvents:function(){$(".userlike_blacked").bind("mouseover",function(){Balv.show_black_tip()});$(".userlike_info_badge div:first").bind("click",function(a){window.open("/f/like/level?kw="+PageData.forum.name_url+"&lv_t=lv_nav_intro");return false});$(".userlike_info_expbar").bind("click",function(a){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=balvexpbar");window.open("/f/like/level?kw="+PageData.forum.name_url+"&lv_t=lv_nav_who");return false});$(".unlike_texture_badge").bind("click",function(a){window.open("/f/like/level?kw="+PageData.forum.name_url+"&lv_t=lv_nav_intro")});if(PageData.user.balv.has_liked){if($("ul.tl").css("display")=="none"){if(PageData.is_ipad){$("div.userlike_info_manager").show()}else{$(".balv_mod").hover(function(){$("div.userlike_info_manager").show()},function(){$("div.userlike_info_manager").hide()})}}else{if(PageData.is_ipad){$("a.p_balv_btnmanager").show()}else{$(".balv_mod").hover(function(){$("a.p_balv_btnmanager").show()},function(){$("a.p_balv_btnmanager").hide()})}}}}};;_.Module.define({path:"ucenter/widget/tbSpam",requires:[],sub:{initial:function(){$("body").append($("#tb_spam_notice_html").html())}}});var initCpro=function(){if(PageData.second_class!="\u5546\u4e1a\u4eba\u7269"&&PageData.forum_name!="\u767e\u5ea6"&&PageData.show_cpro){$.JsLoadManager.use("http://cpro.baidu.com/cpro/ui/post.js",function(){window.arrBaiduCproConfig=[];arrBaiduCproConfig.n="baidupost_cpr";arrBaiduCproConfig.tm=24;arrBaiduCproConfig.cm=60;arrBaiduCproConfig.um=24;arrBaiduCproConfig.rad=1;arrBaiduCproConfig.cad=1;arrBaiduCproConfig.wn=1;arrBaiduCproConfig.bg="#ffffff";arrBaiduCproConfig.tt="#000000";arrBaiduCproConfig.ct="#000000";arrBaiduCproConfig.url="#000000";arrBaiduCproConfig.ta="right";arrBaiduCproConfig.tl="top";arrBaiduCproConfig.tn="baiduCPROiknow";arrBaiduCproConfig.hn=3;arrBaiduCproConfig.at="text";var c={keys:["title","desc","showUrl","ckUrl","redWord","picUrl"],template:function(f){var e="onmouseout=\"return f_s(' ');\" ";var g="onmouseover=\"return f_s('\u94fe\u63a5\u81f3: "+f.showUrl+"');\"";var d="";d+="<div>";d+='<a style="display:block;width:100%;"'+e+g+' href="'+f.ckUrl+'" target="_blank">';d+='<u style="display:block;">'+Page.subByteFix(f.title,25,"..")+"</u>";if((typeof(f.picUrl)=="string")&&(f.picUrl!=="")){d+='<img src="'+f.picUrl+'" width="65" height="65"/>'}d+=Page.subByteFix(f.desc,60,"..");d+='<br/><span style="white-space:nowrap">'+Page.subByteFix(f.showUrl,31,"..")+"</span>";d+="</a>";d+="</div><br/>";return d},showCpro:function(d){return this.template(d)}};if(typeof baiduCproTableBuild=="undefined"){window.baiduCproTableBuild=function(o){var d=[],m=[],p=[],q="",g=0,i={},n="",f=0;d=o.split("\n");f=d.length;for(var l=0,h=f;l<h;l++){m=d[l].split("\t");g=m.length;p=c.keys;q+=function(r,j){for(var k=0;k<j;k++){i[p[k]]=r[k]}return c.showCpro(i)}(m,p.length)}var e=document.getElementById("cproshow");e.innerHTML+=q;if(q&&q.length>0){$("#cprodata").addClass("mg_bt26")}}}scr=document.createElement("script");scr.src=f_u("");document.body.appendChild(scr)})}var a=document.getElementById("cproshow");if(a){var b="fr=tb0_forum&st_mod=cpro&st_fc="+PageData.first_class+"&st_sc="+PageData.second_class+"&st_kw="+PageData.forum_name;a.onmousedown=function(){Stats.sendRequest(b)}}};_.Module.define({path:"pb/component/Follow",sub:{initial:function(){this.follow_wrapper=$("#follow_wrapper");this.follow_content=$("#follow_wrapper .follow_content");this.jq_window=$(window);this.firstShowTop10();this.bindEvents();this.fixedLeft=this.follow_wrapper.offset().left;this.initHack()},firstShowTop10:function(){this.follow_content.show();this.follow_content.addClass("follow_absolute")},bindEvents:function(){var a=this;a.addScrollListener();a.addResizeListener()},initHack:function(){if($.browser.msie&&$.browser.version<7){this.follow_content.addClass("follow_hack")}},getLimitTop:function(){var a=$("div.left_section");this.minTop=this.follow_wrapper.offset().top;this.maxTop=a.offset().top+a.height()-this.follow_content.height()},addScrollListener:function(){var a=this;this.jq_window.bind("scroll",function(){a.showTop10()})},addResizeListener:function(){var a=this;this.jq_window.bind("resize",function(){a.resizeOn()})},resizeOn:function(){var a=this.follow_content.parent();if(a.attr("id")!="follow_wrapper"){if($.browser.msie&&$.browser.version<7){this.fixedLeft=this.follow_wrapper.offset().left}else{this.fixedLeft=this.follow_wrapper.offset().left-this.jq_window.scrollLeft()}this.follow_content.css({left:this.fixedLeft})}},showTop10:function(){var b=this.jq_window.scrollTop()+10;var a=this.follow_content.parent();this.getLimitTop();if(b<this.minTop){if(a.attr("id")!="follow_wrapper"){this.follow_wrapper.append(this.follow_content);this.follow_content.addClass("follow_absolute");this.follow_content.attr({style:""})}this.follow_content.show()}else{if(b>=this.minTop&&b<this.maxTop){if(a.attr("id")=="follow_wrapper"){$("body").append(this.follow_content);this.follow_content.removeClass("follow_absolute")}if($.browser.msie&&$.browser.version<7){this.fixedLeft=this.follow_wrapper.offset().left}else{this.fixedLeft=this.follow_wrapper.offset().left-this.jq_window.scrollLeft()}this.follow_content.css({left:this.fixedLeft});this.follow_content.show()}else{this.follow_content.hide()}}}}});_.Module.define({path:"common/component/SlideShow",sub:{defaultOptions:{effect:"slide",activeClass:"tbui_slideshow_active",interval:5000,slide:{speed:500},fade:{speed:500}},initial:function(b){b=$.extend({},this.defaultOptions,b);var a=this;this.options=b;this.animating=false;this.current=0;this.vendorPrefix=this._getVendorPrefix();this.$nav=$(b.nav);this.$navItem=this.$nav.children();this.total=this.$navItem.size();this.$container=$(b.target);this.$list=this.$container.children(".tbui_slideshow_list");this.$tokens=this.$list.children();if(!b.width){b.width=this.$container.width()}if(!b.height){b.height=this.$container.height()}this.$container.add(this.$list).css({width:b.width,height:b.height});this.interval=b.interval||5000;this.$navItem.first().addClass(b.activeClass);this.$tokens.first().show();this.$navItem.hover(function(){var c=this;if(b.auto){a.stop()}this.delayHandler=setTimeout(function(){a.delayHandler=null;a.setActive($(c).index())},200)},function(){if(b.auto){a.play()}if(this.delayHandler){clearTimeout(this.delayHandler)}});this.effectHandler=this["_"+b.effect];if(b.auto){this.play();this.$list.hover(function(){a.stop()},function(){a.play()})}if(b.next){$(b.next).click(function(c){c.preventDefault();c.stopPropagation();a.next()})}if(b.prev){$(b.prev).click(function(c){c.preventDefault();c.stopPropagation();a.prev()})}},setActive:function(a){if(!this.animating&&a!==this.current){this.$navItem.removeClass(this.options.activeClass).eq(a).addClass(this.options.activeClass);this.effectHandler(a)}},next:function(){var a=this.current+1;if(a==this.total){a=0}this.setActive(a)},prev:function(){var a=this.current-1;if(a==-1){a=this.total-1}this.setActive(a)},play:function(){var a=this;if(this.autoHandler==null){this.autoHandler=setInterval(function(){a.next()},this.options.interval)}},stop:function(){clearInterval(this.autoHandler);this.autoHandler=null},_slide:function(f){var d,g,b,c,e,a,h;var i=this;this.animating=true;d=this.current;h=f>d?1:-1;g=f>d?-this.options.width:this.options.width;c=f;this.$tokens.eq(d).siblings().css({display:"none",left:0,zIndex:0});this.$tokens.eq(c).css({display:"block",left:h*this.options.width,zIndex:10});if(this.vendorPrefix){e=this.vendorPrefix;a=e+"Transform";b=e+"TransitionDuration";this.$list[0].style[a]="translateX("+g+"px)";this.$list[0].style[b]=this.options.slide.speed+"ms";this.$list.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){i.$list[0].style[a]="";i.$list[0].style[b]="";i.$tokens.eq(c).css({left:0});i.$tokens.eq(d).css({display:"none",left:0,zIndex:0});i.animating=false;i.current=c;i.$list.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})}else{i.$list.stop().animate({left:g},this.options.slide.speed,function(){i.$list.css({left:0});i.$tokens.eq(c).css({left:0});i.$tokens.eq(d).css({display:"none",left:0,zIndex:0});i.current=c;i.animating=false})}},_fade:function(c){var a=this;var d,b;this.animating=true;d=this.current;b=c;this.$tokens.eq(b).css({display:"none",left:0,zIndex:10});this.$tokens.eq(d).stop().fadeOut(this.options.fade.speed);this.$tokens.eq(b).stop().fadeIn(this.options.fade.speed,(function(){a.$tokens.eq(b).css({zIndex:0});a.animating=false;a.current=b}))},_getVendorPrefix:function(){var a,b,c,d,e;a=document.body||document.documentElement;c=a.style;d="Transition";e=["Moz","Webkit","Khtml","O","ms"];b=0;while(b<e.length){if(typeof c[e[b]+d]==="string"){return e[b]}b++}return false}}});_.Module.define({path:"pb/widget/Game",requires:["common/component/SlideShow"],sub:{initial:function(a,b){this.page=a;this.fname=b;this.tabindex=0;this.slider=new Array();this._initTab();this._initSlideShow();this._bindEvents()},_initSlideShow:function(){this.slider[0]=this.use("common/component/SlideShow",{nav:"#game_nav_tab0",target:"#game_main_tab0",effect:"fade",width:200,height:140,auto:true,interval:4000});this.slider[2]=this.use("common/component/SlideShow",{nav:"#game_nav_tab2",target:"#game_main_tab2",effect:"fade",width:200,height:140,auto:true,interval:4000});this.slider[2].stop()},_initTab:function(){this._selectTab(0);$("body").append("<style>#interest_smiley_bubble{display:none !important;}</style>")},_selectTab:function(a){$("#game_tab .game_tab_item").removeClass("sel").eq(a).addClass("sel");$("#game_content .game_list_wrapper").hide().eq(a).show()},_bindEvents:function(){var a=this;$("#game_tab").on("click",".game_tab_item",function(){a.tabindex=$(this).index();a.slider[0].stop();a.slider[2].stop();if(a.tabindex==0||a.tabindex==2){a.slider[a.tabindex].play()}a._selectTab(a.tabindex);$.stats.sendRequest("fr=tb0_forum&st_mod="+a.page+"&st_type=gametab&st_value=tab"+($(this).index()+1));return false});$("#game_login_btn").on("click",function(){TbCom.process("User","buildLoginFrame",null,null,null,"pbgame");return false});$("#game_content").on("click",".game_list_item",function(){var b=$(this).data("title");$.stats.sendRequest("fr=tb0_forum&st_mod="+a.page+"&fname="+a.fname+"&pos="+$(this).index()+"&tab=tab"+a.tabindex+"&st_type=gamelist&st_value="+b)});$(".game_link").on("click",function(){$.stats.sendRequest("fr=tb0_forum&st_mod="+a.page+"&fname="+a.fname+"&st_type=gamemore")})}}});_.Module.define({path:"pb/widget/top10",sub:{initial:function(){this._addStats()},_addStats:function(){var a=PageData.forum.name;var b="fr=tb0_forum&fname="+a;if($.inArray(PageData.forum.name,["\u7b11\u50b2\u6c5f\u6e56\u7535\u89c6\u5267","\u70ed\u5e26\u9c7c","ac\u7c73\u5170","lol","\u5723\u5802","\u67ef\u5357"])>=0){$.stats.sendRequest(b+"&st_type=pb_top10_show");$("#follow_wrapper").find(".j_tieba_top10_content").delegate("a","click",function(){$.stats.sendRequest(b+"&st_type=pb_top10_click")})}}}});_.Module.define({path:"pb/widget/ThreadFooter",sub:{initial:function(){this._urlTong()},_urlTong:function(){$(function(){var a=function(d){if(d&&(d.indexOf("http")==0||d.indexOf("www")==0)&&!(d.indexOf("http://tieba.baidu.com")>-1)){$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/hive.gif",{tb_url:encodeURIComponent(d),tb_uid:PageData.user.id,tb_tid:PageData.thread.id})}};var b=$("div .j_lzl_container");var c=$("div .d_post_content").find("a");c.each(function(){this.onclick=function(d){a($(this).html())}});b.each(function(){$(this).delegate("a","click",function(h){var g=$(h.target),d=g.parent(),f=d.attr("class");if(f=="lzl_content_main"){a(g.html())}})})})}}});(function(){window.TED=window.TED||{};window.TED["extend"]=h;window.TED["EventDispatcher"]=f;function h(n,o,j){function l(){}l.prototype=o.prototype;var m=new l();m.constructor=n;n.superclass=o;for(var k in j){m[k]=j[k]}n.prototype=m}function f(){this._events={}}f.prototype={on:function(k,l,j,i){j=j||this;this._events[k]=this._events[k]||[];this._events[k].push({listener:l,scope:j,args:i})},fireEvent:function(p,o,l){var q,n,k,m=this._events[p];if(!m){return false}else{for(n=0,k=m.length;n<k;n++){q=m[n];o=q.scope;l=l||q.args||[];q.listener.apply(o,l)}}},remove:function(n,o){if(!this._events[n]){return false}var m=this._events[n],l,k;for(l=0,k=m.length;l<k;l++){if(m[l].listener===o){m.splice(l,1);break}}if(m.length===0){delete this._events[n]}}};var b={addEvent:function(j,i,k){var l;if(j.addEventListener){l=function(n,m,o){n.addEventListener(m,o,false)}}else{l=function(n,m,o){n.attachEvent("on"+m,o)}}l(j,i,k);this.addEvent=l},removeEvent:function(k,j,l){var i;if(k.addEventListener){i=function(n,m,o){n.removeEventListener(m,linstener,false)}}else{i=function(n,m,o){n.detachEvent("on"+m,o)}}i(k,j,l);this.addEvent=i}};window.TED["Event"]=b;window.TED["HoverOverlay"]=d;function d(i){d.superclass.call(this);this.timer=null;this.container=i;this.holder=document.createElement("div");this.holder.className="tb-editor-overlay";this.holder.style.display="none";var j=this;b.addEvent(this.holder,"mouseover",function(){j.mouseover()});b.addEvent(this.holder,"mouseout",function(){j.mouseout()});this.content=document.createElement("div");this.content.className="overlay-content";this.arrow=document.createElement("span");this.arrow.className="arrow";this.holder.appendChild(this.arrow);this.holder.appendChild(this.content);this.container.appendChild(this.holder)}h(d,f,{container:null,holder:null,content:null,currentOpen:null,isOpen:false,closefunction:null,open:function(o,n,m,i,p,j,l){this.isOpen=true;this.currentOpen=l;this.arrow.style.left=p;var k=this.holder.style;k.left=o;k.top=n;k.width=m;k.height=i;k.display="block";this.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+j+'"></iframe>'},close:function(){this.isOpen=false;this.content.innerHTML="";this.holder.style.display="none";if(this.currentOpen){this.currentOpen.className=this.currentOpen.className.replace(" open","");this.currentOpen=null}this.fireEvent("close")},mouseover:function(){this.closefunction=this.close;this.close=function(){};if(this.timer!=null){clearTimeout(this.timer)}},mouseout:function(){var i=this;i.close=i.closefunction;i.timer=setTimeout(function(){i.close()},500)}});window.TED["Overlay"]=a;function a(i){a.superclass.call(this);this.container=i;this.holder=document.createElement("div");this.holder.className="tb-editor-overlay";this.holder.style.display="none";this.closeBtn=document.createElement("span");this.closeBtn.className="close";var j=this;b.addEvent(this.closeBtn,"click",function(){j.close()});this.content=document.createElement("div");this.content.className="overlay-content";this.arrow=document.createElement("span");this.arrow.className="arrow";this.holder.appendChild(this.closeBtn);this.holder.appendChild(this.arrow);this.holder.appendChild(this.content);this.container.appendChild(this.holder)}h(a,f,{closeButton:null,container:null,holder:null,content:null,currentOpen:null,isOpen:false,open:function(l,p,k,q,m,j){if(this.isOpen==true&&TED.Editor&&TED.Editor.Status.isPicassoOpen===true){var n=this;var o=$.dialog.confirm('<div id="maincontent" style="position:absolute;"><img style="margin:10px 10px 10px 10px;width:68px;height:68px;" src="http://static.tieba.baidu.com/tb/editor/v2/picasso/alarm.gif" /><div id="tipscontent" style="position:absolute;left:100px;top:15px;width:270px;font-size:14px;font-family:\u5b8b\u4f53" ><b>\u60a8\u6b63\u5728\u7f16\u8f91\u6d82\u9e26\uff0c\u73b0\u5728\u9000\u51fa\u5c06\u4e0d\u4f1a\u4fdd\u5b58\uff0c\u60a8\u786e\u5b9a\u8981\u9000\u51fa\uff1f</b></div></div>',{title:"\u6d82\u9e26\u7f16\u8f91\u5668",acceptValue:"\u786e\u5b9a",cancelValue:"\u53d6\u6d88"});o.width(420);o.height(90);o.bind("onaccept",function(){TED.Editor.Status.isPicassoOpen=false;if(n.picassoPanel){n.picassoPanel.destroy();n.picassoPanel=null}n.isOpen=true;n.arrow.style.left=m;var r=n.holder.style;r.left=l;r.top=p;r.width=k;r.height=q;r.display="block";n.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+j+'"></iframe>'})}else{this.isOpen=true;this.arrow.style.left=m;var i=this.holder.style;i.left=l;i.top=p;i.width=k;i.height=q;i.display="block";this.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+j+'"></iframe>'}this.fireEvent("open")},close:function(j){if(TED.Editor&&TED.Editor.Status.isPicassoOpen===true&&j!==true){var k=this;var i=$.dialog.confirm('<div id="maincontent" style="position:absolute;"><img style="margin:10px 10px 10px 10px;width:68px;height:68px;" src="http://static.tieba.baidu.com/tb/editor/v2/picasso/alarm.gif" /><div id="tipscontent" style="position:absolute;left:100px;top:15px;width:270px;font-size:14px;font-family:\u5b8b\u4f53"><b>\u60a8\u6b63\u5728\u7f16\u8f91\u6d82\u9e26\uff0c\u73b0\u5728\u9000\u51fa\u5c06\u4e0d\u4f1a\u4fdd\u5b58\uff0c\u60a8\u786e\u5b9a\u8981\u9000\u51fa\uff1f</b></div></div>',{title:"\u6d82\u9e26\u7f16\u8f91\u5668",acceptValue:"\u786e\u5b9a",cancelValue:"\u53d6\u6d88"});i.width(420);i.height(90);i.bind("onaccept",function(){TED.Editor.Status.isPicassoOpen=false;if(k.picassoPanel){k.picassoPanel.destroy();k.picassoPanel=null}k.isOpen=false;k.content.innerHTML="";k.holder.style.display="none";if(k.currentOpen){k.currentOpen.className=k.currentOpen.className.replace(" open","");k.currentOpen=null}k.fireEvent("close")})}else{if(j==true){TED.Editor&&(TED.Editor.Status.isPicassoOpen=false)}this.isOpen=false;this.content.innerHTML="";this.holder.style.display="none";if(this.currentOpen){this.currentOpen.className=this.currentOpen.className.replace(" open","");this.currentOpen=null}this.fireEvent("close")}},toggle:function(n,m,l,i,o,j,k){if(this.currentOpen&&this.currentOpen===k){this.close()}else{k.className=k.className+" open";this.currentOpen=k;this.open(n,m,l,i,o,j)}}});window.TED["augmentObject"]=c;function c(k,j){for(var i in j){if(j.hasOwnProperty(i)){k[i]=k[i]!==undefined?k[i]:j[i]}}}var e={get:function(j,l,i){var k=this.getXHR();k.open("GET",j,true);k.setRequestHeader("cache",false);k.onreadystatechange=function(){if(k.readyState!==4){return}if(k.status==200){if(typeof l==="function"){l(k.responseText)}}else{if(typeof i==="function"){i(k.statusText)}}k=null};k.send(null)},getXHR:(function(){if(window.XMLHttpRequest){return function(){return new window.XMLHttpRequest()}}else{if(window.ActiveXObject){return function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}}else{throw"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301AJAX!"}}})()};window.TED["SimpleAjax"]=e;var g=(function(){var k="tieba";function o(p){return p.replace(/[_\s]/g,function(q){return q=="_"?"__":"_s"})}function l(){return document.getElementById(k+"-storage")}function n(p){return{}.toString.call(p)==="[object Date]"&&p.toString()!=="Invalid Date"&&!isNaN(p)}function j(){var p;if(window.localStorage){p=m()}else{if(window.ActiveXObject){p=i()}}return p}function i(){var p=document.createElement("div");p.style.display="none";p.id=k+"-storage";document.body.appendChild(p);l().addBehavior("#default#userData");return{set:function(r,t,q){var s=l(),w=o(r),v=q&&q.expires?q.expires:new Date().getTime()+365*24*60*60*1000;n(v)&&(v=v.getTime());s.expires=new Date(v).toUTCString();try{s.setAttribute(w,t);s.save(w)}catch(u){throw"baidu.data.storage.set error! Maybe space overflow."}s=null},get:function(q){var r=l(),u=o(q),t=null;try{r.load(u);t=r.getAttribute(u);return t}catch(s){throw s.message}},del:function(q){var r=l(),u=o(q),t;try{r.load(u);t=r.getAttribute(u);if(t){r.removeAttribute(u);r.expires=new Date(315532799000).toUTCString();r.save(u);return true}else{return false}}catch(s){return false}}}}function m(){return{set:function(q,r,p){var v=window.localStorage,u=o(q),t=p&&p.expires?p.expires:0;n(t)&&(t=t.getTime());try{v.setItem(u,t+"|"+r)}catch(s){throw"baidu.data.storage.set error! Maybe space overflow."}},get:function(q){var v=window.localStorage,u=o(q),t=null,p,s;try{t=v.getItem(u)}catch(r){return null}if(t){p=t.indexOf("|");s=parseInt(t.substring(0,p),10);if(new Date(s).getTime()>new Date().getTime()||s==0){t=t.substring(p+1,t.length);return t}else{t=null;this.del(q);return null}}else{return null}},del:function(p){var t=window.localStorage,s=o(p),r=null;try{r=t.getItem(s)}catch(q){return false}if(r){r=r.substring(r.indexOf("|")+1,r.length);r&&t.removeItem(s);return true}else{return false}}}}return{set:function(q,s,t,p){var r=this;!r._storage&&(r._storage=j());r._storage.set.apply(r._storage,arguments)},get:function(p){var q=this;!q._storage&&(q._storage=j());return q._storage.get.apply(q._storage,arguments)},remove:function(p,r){var q=this;!q._storage&&(q._storage=j());return q._storage.del.apply(q._storage,arguments)},isSupport:function(){return !!(window.localStorage||window.ActiveXObject)}}})();window.TED["Storage"]=g})();;(function(){var extend=TED.extend,EventDispatcher=TED.EventDispatcher,Event=TED.Event,Overlay=TED.Overlay,augmentObject=TED.augmentObject,Ajax=TED.SimpleAjax,Storage=TED.Storage;window.TED["EditorPlugins"]=window.TED["EditorPlugins"]||{};window.TED["EditorPlugins"]["Refer"]=Refer;function Refer(attrs){attrs=attrs||{};augmentObject(attrs,this.constructor.defaultConfig);this.config=attrs}Refer.defaultConfig={checkDelay:100,offsetLeft:1,offsetTop:18,dataUrl:"/at-sug",uid:null};Refer.prototype={constructor:Refer,disabled:false,boxWrapper:null,init:function(editor){editor.on("keydown",this.onEditorKeydown,this);editor.on("keyup",this.onEditorKeyup,this);editor.on("click",this.onEditorClick,this);editor.on("blur",function(){this.hide()},this);this.box=new Box(editor.editAreaWrapper);this.box.on("select",this.onSelect,this);this.data=new Data(this.config.dataUrl,this.config.uid);this.data.on("datachange",this.box.update,this.box);this.editor=editor},destroy:function(){},enable:function(){this.disabled=false},disable:function(){this.disabled=true},query:function(key){this.data.getData(key)},onSelect:function(value){var el=this.editor.getSelectedElement();if(value!==null){el.innerHTML="@"+value}this.breakMode(32)},onEditorKeydown:function(e){if(this.disabled){return}if(this.box.isShow){switch(e.keyCode){case 38:this.box.pre();break;case 40:this.box.next();break;case 13:this.onSelect(this.box.getValue());this.box.hide();break;default:return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}e.exitFunction=true}},onEditorKeyup:function(e){if(this.disabled){return}var code=e.keyCode;if((code===50&&e.shiftKey)||(code===50&&this.lastUpCode===16)){this.checkEnterMode()}var that=this;clearTimeout(this.timer);this.timer=setTimeout(function(){that.checkShowBox()},this.config.checkDelay);this.lastUpCode=e.keyCode},onEditorClick:function(){var that=this;clearTimeout(this.timer);this.timer=setTimeout(function(){that.checkShowBox()},this.config.checkDelay)},checkEnterMode:function(){var that=this.editor;var s=that.getSelection(),r,c;if(that.ua.ie?s.type.toLowerCase()!=="none":!s.isCollapsed){return}r=that.getRange();if(that.ua.ie){if(this.editor.isEmpty()){return}r.moveStart("character",-1);r.select();c=r.text}else{var con=r.startContainer,offset=r.startOffset;if(con.nodeType===1&&offset>0){con=con.childNodes[offset-1];offset=con.length}if(con.nodeType===3&&offset>0){r.setStart(con,offset-1);s.removeAllRanges();s.addRange(r);c=s.toString()}}var el=that.getSelectedElement();if(c==="@"&&(el.className!=="at"||el.innerHTML!=="@")){that.execCommand("inserthtml",'<span class="at">@</span>')}else{if(that.ua.ie){r.collapse(false);r.select()}else{s.collapseToEnd()}}},checkShowBox:function(){var el=this.editor.getSelectedElement(),value=el.innerHTML,key;if(el.className==="at"&&value.charAt(0)==="@"){key=value.substring(1).replace(/<br.*>$/i,"");if(key.search(/[^\w\u4E00-\u9FA5]/)===-1){this.show(el.offsetLeft+this.config.offsetLeft-this.editor.editArea.scrollLeft,el.offsetTop+this.config.offsetTop-this.editor.editArea.scrollTop);this.query(key)}else{this.hide()}}else{this.hide()}},hide:function(){this.box.hide();this.data.getting=null},show:function(x,y){this.box.show(x,y)},breakMode:function(charcode){var that=this.editor,el=that.getSelectedElement(),node,r;if(charcode===32){node=document.createElement("span");node.innerHTML="&nbsp;";node=node.firstChild}else{node=document.createTextNode(String.fromCharCode(charcode))}if(el.nextSibling){el.parentNode.insertBefore(node,el.nextSibling)}else{el.parentNode.appendChild(node)}if(that.ua.ie){r=document.selection.createRange();r.moveEnd("character",1);r.collapse(false);r.select()}else{s=window.getSelection();r=document.createRange();r.selectNode(node);s.removeAllRanges();s.addRange(r);s.collapseToEnd()}}};function Box(container){Box.superclass.call(this);this.container=container;this.holder=document.createElement("div");this.holder.innerHTML='<span class="box-title">\u60f3\u7528@\u63d0\u5230\u8c01\uff1f<span>';this.holder.className="box-holder";this.holder.style.display="none";this.ul=document.createElement("ul");this.ul.className="box-ul-empty";this.holder.appendChild(this.ul);container.appendChild(this.holder);this.initEvents()}extend(Box,EventDispatcher,{isShow:false,index:null,length:0,initEvents:function(){var that=this;this.bindClick=function(){that.onClick.apply(that,arguments)};this.bindMousedown=function(){that.onMousedown.apply(that,arguments)};Event.addEvent(this.ul,"click",this.bindClick);Event.addEvent(this.ul,"mousedown",this.bindMousedown)},onMousedown:function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},onClick:function(e){var target=e.target||e.srcElement;if(target.tagName.toLowerCase()==="li"){this.fireEvent("select",null,[target.innerHTML]);this.hide()}},update:function(data){if(!this.isShow){return}if(data.length===0){this.ul.innerHTML="";this.ul.className="box-ul-empty"}else{this.ul.className="";this.ul.innerHTML='<li unselectable="on">'+data.join('</li><li unselectable="on">')+"</li>"}this.length=data.length},pre:function(){if(this.length===0){return}if(this.index===null){this.select(this.length-1)}else{this.select(this.index===0?this.length-1:this.index-1)}},next:function(){if(this.length===0){return}if(this.index===null){this.select(0)}else{this.select(this.index===this.length-1?0:this.index+1)}},select:function(index){if(this.index!==null){this.ul.childNodes[this.index].className=""}this.ul.childNodes[index].className="focus";this.index=index},getValue:function(){return this.index!==null?this.ul.childNodes[this.index].innerHTML:null},show:function(x,y){if(this.isShow){if(x===this.x&&y===this.y){return}else{this.reset()}}else{this.holder.style.display="block";this.isShow=true}this.holder.style.left=x+"px";this.holder.style.top=y+"px";this.x=x;this.y=y},hide:function(){if(!this.isShow){return}this.reset();this.holder.style.display="none";this.isShow=false},reset:function(){this.ul.innerHTML="";this.length=0;this.ul.className="box-ul-empty"}});function Data(url,uid){Data.superclass.call(this);this.url=url;this.uid=uid}extend(Data,EventDispatcher,{dataCache:{},queryCache:{},data:null,getData:function(key){if(this.getting===key){return}this.getting=key;if(key===""){this.setData([],true);return}if(this.dataCache[key]){this.setData(this.dataCache[key],true);return}if(this.queryCache[key]){return}this.queryCache[key]=true;var that=this;Ajax.get(this.url+"?query="+encodeURIComponent(key)+"&uid="+this.uid+"&ie=utf-8",function(data){delete that.queryCache[key];data=that.parseData(data);that.dataCache[key]=data;that.setData(data,key===that.getting)},function(error){delete that.queryCache[key];that.fireEvent("error",[error])})},setData:function(value,need){this.data=value;if(need){this.fireEvent("datachange",null,[value])}},parseData:function(data){try{data=eval("("+data+")");if(data.error===0){return data.msg}else{throw new Error("\u670d\u52a1\u5668\u8fd4\u56de\u9519\u8bef\uff1a"+data.error)}}catch(e){throw new Error("\u670d\u52a1\u5668\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u6709\u8bef\uff01")}}})})();;(function(){var f=TED.extend,c=TED.EventDispatcher,b=TED.EditorPlugins.Refer;function e(g){e.superclass.call(this);this.init(g||{})}e.defaultConfig={height:"200px",width:"400px",maxHeight:null,autoFocus:true,autoEnable:true,autoHeight:false,editAreaClassName:"tb-editor-editarea",editAreaWrapperClassName:"tb-editor-editarea-wrapper",wrapperClassName:"tb-editor-wrapper",disabledEditAreaClassName:"tb-editor-editarea disabled",disabledWrapperClassName:"tb-editor-wrapper disabled",imageClassName:"BDE_Image",smileyClassName:"BDE_Smiley",emptyClassName:"BDE_Empty",musicClassName:"BDE_Music",didaDelay:300,imageWidthLimit:560};e.ResizeImage=function(h){h.removeAttribute("onload");h.removeAttribute("onerror");if(h.width>e.defaultConfig.imageWidthLimit){var i=h.width;var g=h.height;h.setAttribute("width",e.defaultConfig.imageWidthLimit);h.setAttribute("height",e.defaultConfig.imageWidthLimit*g/i);h.setAttribute("changedsize",true)}};f(e,c,{config:null,enabled:false,focused:false,autoHeighted:false,wrapper:null,editArea:null,container:null,id:null,editValidHTML:["br","embed"],submitValidHTML:["br","embed"],execCommand:function(l,k){if(!this.enabled){return false}if(!this.focused){this.focus()}var h=true,l=l.toLowerCase(),n;if(typeof this["cmd_"+l]==="function"){var g=[];for(var j=1;j<arguments.length;j++){g.push(arguments[j])}n=this["cmd_"+l].apply(this,g);h=n[0];if(n[1]){l=n[1]}if(n[2]){k=n[2]}}if(h){try{document.execCommand(l,false,k)}catch(m){throw new Error("\u6267\u884caction\u65f6\uff0c\u53d1\u751f\u5f02\u5e38\uff1a"+m.message)}}if(!this.ua.ie){this.saveRange()}},getImageNum:function(){return this.getTagNum("img",this.config.imageClassName)},getSmileyNum:function(){return this.getTagNum("img",this.config.smileyClassName)},getHtml:function(){this.fireEvent("gethtml");return this.filteSubmitHTML()},setHtml:function(g){this.editArea.innerHTML=g},enable:function(){if(!this.enabled){this.attachEvents();this.editArea.style.display="none";this.editArea.contentEditable=true;this.editArea.style.display="block";if(this.ua.gecko&&this.editArea.innerHTML===""){this.editArea.innerHTML="<br>"}this.editArea.className=this.config.editAreaClassName;this.wrapper.className=this.config.wrapperClassName;if(this.config.autoFocus){this.focus()}this.enabled=true}else{if(this.config.autoFocus&&!this.focused){this.focus()}}},disable:function(){if(!this.enabled){return}if(this.focused){this.blur()}this.detachEvents();this.editArea.contentEditable=false;this.wrapper.className=this.config.disabledWrapperClassName;this.editArea.className=this.config.disabledEditAreaClassName;this.enabled=false},focus:function(){this.editArea.focus();if(this.ua.webkit){this.resumeRange()}},blur:function(){if(!this.ua.ie){this.saveRange()}this.editArea.blur()},isEmpty:function(){return this.isEmptyContent(this.editArea.innerHTML)},enableAutoHeight:function(h){if(h&&h<=parseInt(this.config.height)){if(this.autoHeighted){this.disableAutoHeight()}return}h=h||this.config.maxHeight;if(this.ua.ie>0&&this.ua.ie<=6){var g=parseInt(this.config.height),i;if(h){i="this.scrollHeight <= "+g+' ? "'+g+'px" : (this.scrollHeight >= '+h+' ? "'+h+'px" : "auto")'}else{i="this.scrollHeight <= "+g+' ? "'+g+'px" : "auto"'}this.editArea.style.setExpression("height",i)}else{this.editArea.style.minHeight=this.config.height;this.editArea.style.height="auto";if(h){this.editArea.style.maxHeight=h+"px"}}this.autoHeighted=true},disableAutoHeight:function(){if(this.ua.ie>0&&this.ua.ie<=6){this.editArea.style.removeExpression("height")}this.editArea.style.height=this.config.height;this.autoHeighted=false},empty:function(){this.editArea.innerHTML=""},ua:function(){var j=function(m){var o=0;return parseFloat(m.replace(/\./g,function(){return(o++==1)?"":"."}))},n=navigator,l={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0,caja:n.cajaVersion,secure:false,os:null},i=navigator&&navigator.userAgent,k=window&&window.location,h=k&&k.href,g;l.secure=h&&(h.toLowerCase().indexOf("https")===0);if(i){if((/windows|win32/i).test(i)){l.os="windows"}else{if((/macintosh/i).test(i)){l.os="macintosh"}}if((/KHTML/).test(i)){l.webkit=1}g=i.match(/AppleWebKit\/([^\s]*)/);if(g&&g[1]){l.webkit=j(g[1]);if(/ Mobile\//.test(i)){l.mobile="Apple"}else{g=i.match(/NokiaN[^\/]*/);if(g){l.mobile=g[0]}}g=i.match(/AdobeAIR\/([^\s]*)/);if(g){l.air=g[0]}}if(!l.webkit){g=i.match(/Opera[\s\/]([^\s]*)/);if(g&&g[1]){l.opera=j(g[1]);g=i.match(/Opera Mini[^;]*/);if(g){l.mobile=g[0]}}else{g=i.match(/MSIE\s([^;]*)/);if(g&&g[1]){l.ie=j(g[1])}else{g=i.match(/Gecko\/([^\s]*)/);if(g){l.gecko=1;g=i.match(/rv:([^\s\)]*)/);if(g&&g[1]){l.gecko=j(g[1])}}}}}}return l}(),isUCWeb:function(){var g=navigator.userAgent.toString();if(g.indexOf("X11;")>-1&&g.indexOf("Linux i686;")>-1&&g.indexOf("Gecko")>-1&&g.indexOf("Firefox")<0&&g.indexOf("Opera")<0){return true}return false},isAndroidOS:function(){var g=navigator.userAgent.toString();if(g.match(/android/i)!=null){return true}return false},isEmptyContent:function(g){if(!g){return true}return(""===g.replace(/<br[^>]*>/gi,"").replace(/<\/?(?:span|a)[^>]*>/gi,"").replace(/[\u3000\s]+/g,"").replace(/&nbsp;/g,""))},init:function(g){this.augmentObject(g,this.constructor.defaultConfig||{});this.config=g;if(this.constructor.registerInstance){this.id=this.constructor.registerInstance(this,g.id)}this.initComponents(g);this.appendToDom();this.initEvents();this.initConfig(g)},initComponents:function(g){if(g.container){if(typeof g.container==="string"){this.container=document.getElementById(g.container)}else{if(typeof g.container==="object"&&g.container.nodeType===1){this.container=g.container}}}this.container=this.container||document.body;this.editArea=document.createElement("div");this.editArea.className=g.disabledEditAreaClassName;this.wrapper=document.createElement("div");this.wrapper.className=g.disabledWrapperClassName;this.editAreaWrapper=document.createElement("div");this.editAreaWrapper.className=g.editAreaWrapperClassName;this.editArea.style.height=g.height;this.wrapper.style.width=g.width},appendToDom:function(){this.editAreaWrapper.appendChild(this.editArea);this.wrapper.appendChild(this.editAreaWrapper);this.container.appendChild(this.wrapper)},initConfig:function(g){if(g.autoHeight){this.enableAutoHeight()}if(g.enableRefer){this.addPlugin("refer",new b({uid:this.config.uid}))}if(g.autoEnable){var h=this;setTimeout(function(){h.enable();h.fireEvent("initcomplete")},10)}else{this.fireEvent("initcomplete")}},initEvents:function(){var g=this;this.bindMousedown=function(){g.onMousedown.apply(g,arguments)};this.bindMouseup=function(){g.onMouseup.apply(g,arguments)};this.bindClick=function(){g.onClick.apply(g,arguments)};this.bindDoubleclick=function(){g.onDoubleclick.apply(g,arguments)};this.bindKeydown=function(){g.onKeydown.apply(g,arguments)};this.bindKeyup=function(){g.onKeyup.apply(g,arguments)};this.bindKeypress=function(){g.onKeypress.apply(g,arguments)};this.bindPaste=function(){g.onPaste.apply(g,arguments)};this.bindBlur=function(){g.onBlur.apply(g,arguments)};this.bindFocus=function(){g.onFocus.apply(g,arguments)}},attachEvents:function(){var g=this.editArea;if(!this.ua.ie){g.addEventListener("mousedown",this.bindMousedown,false);g.addEventListener("mouseup",this.bindMouseup,false);g.addEventListener("click",this.bindClick,false);g.addEventListener("dblclick",this.bindDoubleclick,false);g.addEventListener("keypress",this.bindKeypress,false);g.addEventListener("keyup",this.bindKeyup,false);g.addEventListener("keydown",this.bindKeydown,false);g.addEventListener("paste",this.bindPaste,false);g.addEventListener("blur",this.bindBlur,false);g.addEventListener("focus",this.bindFocus,false)}else{g.attachEvent("onmousedown",this.bindMousedown);g.attachEvent("onmouseup",this.bindMouseup);g.attachEvent("onclick",this.bindClick);g.attachEvent("ondblclick",this.bindDoubleclick);g.attachEvent("onkeypress",this.bindKeypress);g.attachEvent("onkeyup",this.bindKeyup);g.attachEvent("onkeydown",this.bindKeydown);g.attachEvent("onpaste",this.bindPaste);g.attachEvent("onbeforedeactivate",this.bindBlur);g.attachEvent("onbeforeactivate",this.bindFocus)}this.on("dida",this.onDida,this)},detachEvents:function(){var g=this.editArea;if(!this.ua.ie){g.removeEventListener("mousedown",this.bindMousedown,false);g.removeEventListener("mouseup",this.bindMouseup,false);g.removeEventListener("click",this.bindClick,false);g.removeEventListener("dblclick",this.bindDoubleclick,false);g.removeEventListener("keypress",this.bindKeypress,false);g.removeEventListener("keyup",this.bindKeyup,false);g.removeEventListener("keydown",this.bindKeydown,false);g.removeEventListener("paste",this.bindPaste,false);g.removeEventListener("blur",this.bindBlur,false);g.removeEventListener("focus",this.bindFocus,false)}else{g.detachEvent("onmousedown",this.bindMousedown);g.detachEvent("onmouseup",this.bindMouseup);g.detachEvent("onclick",this.bindClick);g.detachEvent("ondblclick",this.bindDoubleclick);g.detachEvent("onkeypress",this.bindKeypress);g.detachEvent("onkeyup",this.bindKeyup);g.detachEvent("onkeydown",this.bindKeydown);g.detachEvent("onpaste",this.bindPaste);g.detachEvent("onbeforedeactivate",this.bindBlur);g.detachEvent("onbeforeactivate",this.bindFocus)}this.remove("dida",this.onDida)},onMousedown:function(g){if(g.target&&g.target.tagName==="IMG"){if(g.preventDefault){g.preventDefault()}}this.fireEvent("mousedown",null,[g]);if(g.exitFunction){return}},onMouseup:function(g){this.fireEvent("mouseup",null,[g]);if(g.exitFunction){return}if(!this.ua.ie){this.saveRange()}},onClick:function(g){this.fireEvent("click",null,[g]);if(g.exitFunction){return}},onDoubleclick:function(g){this.fireEvent("doubleclick",null,[g]);if(g.exitFunction){return}},onKeydown:function(h){this.fireEvent("keydown",null,[h]);if(h.exitFunction){return}if(h.keyCode===8){if(this.ua.ie){var g=this.getRange();if(g.item){g.item(0).outerHTML="";h.returnValue=false}}}},onKeypress:function(i){this.fireEvent("keypress",null,[i]);if(i.exitFunction){return}var g=i.keyCode;switch(g){case 13:if(this.ua.ie){var h=this.getRange();if(h){h.pasteHTML("<br>");h.collapse(false);h.select()}i.returnValue=false}else{if(this.ua.webkit){document.execCommand("insertlinebreak");i.preventDefault()}}break}},onKeyup:function(g){this.fireEvent("keyup",null,[g]);if(g.exitFunction){return}if(!this.ua.ie){this.saveRange()}if(g.stopPropagation){g.stopPropagation()}},onPaste:function(h){this.fireEvent("paste",null,[h]);if(h.exitFunction){return}if(this.ua.ie){this.doPasteIE(h);this.fireEvent("afterpaste",null,[h])}else{var g=this;setTimeout(function(){g.doPaste();g.fireEvent("afterpaste",null,[h])},5)}},didaTimer:null,savedHeight:null,startDida:function(){var g=this;this.didaTimer=setInterval(function(){g.fireEvent("dida")},this.config.didaDelay)},stopDida:function(){clearInterval(this.didaTimer)},onDida:function(){if(this.autoHeighted){if(this.savedHeight===null){this.savedHeight=this.wrapper.scrollHeight;return}var g=this.wrapper.scrollHeight;if(this.savedHeight&&g!==this.savedHeight){this.fireEvent("heightChanged",null,[g,g-this.savedHeight]);this.savedHeight=g}}},onBlur:function(g){this.stopDida();this.focused=false;this.fireEvent("blur",null,[g]);if(g.exitFunction){return}if(this.ua.ie){this.saveRange()}},onFocus:function(g){this.startDida();this.focused=true;this.fireEvent("focus",null,[g]);if(g.exitFunction){return}this.resumeRange()},augmentObject:function(i,h){for(var g in h){if(h.hasOwnProperty(g)){i[g]=i[g]!==undefined?i[g]:h[g]}}},getSelection:function(){return window.getSelection?window.getSelection():document.selection},getRange:function(){return this.ua.ie?document.selection.createRange():window.getSelection().getRangeAt(0)},createRange:function(){return this.ua.ie?document.body.createTextRange():document.createRange()},getSelectedElement:function(){var g=this.getRange();if(this.ua.ie){return g.item?g.item(0):g.parentElement()}var h=g.commonAncestorContainer;if(h.nodeType===3){h=h.parentNode}return h},doPasteIE:function(g){var h=clipboardData.getData("Text");if((!h)||h==""){return true}h=h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\s/g,"&nbsp;").replace(/\u3000/g,"&nbsp;&nbsp;");this.execCommand("inserthtml",h);g.returnValue=false},doPaste:function(){this.saveCursor();this.editArea.innerHTML=this.filteEditHTML();this.ensureCursor()},filteEditHTML:function(){return html=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(/<\/ ?tr[^>]*>/gi,"[br]").replace(/<\/ ?td[^>]*>/gi,"&nbsp;&nbsp;").replace(/<(ul|dl|ol)[^>]*>/gi,"[br]").replace(/<(li|dd)[^>]*>/gi,"[br]").replace(/<p [^>]*>/gi,"[br]").replace(new RegExp("<(/?(?:"+this.editValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(new RegExp('<span([^>]*class="?at"?[^>]*)>',"gi"),"[span$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.emptyClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+'"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.editValidHTML.join("|")+"|img|span)[^\\]]*)\\]","gi"),"<$1>").replace(/\r?\n/gi,"<br>")},filteSubmitHTML:function(){this.reLayout(true);var o=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+this.submitValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(/<strong[^>]*>/gi,"[strong]").replace(/<\/strong[^>]*>/gi,"[/strong]").replace(/<b[^>]*>/gi,"[strong]").replace(/<\/b[^>]*>/gi,"[/strong]").replace(new RegExp('<span([^>]*class="?edit_font_normal"?[^>]*)>@</span>',"gi"),"@").replace(/<span([^>]*)>/gi,"[span$1]").replace(/<\/span[^>]*>/gi,"[/span]").replace(/<font[^>]*color=(\")?#E10602(\")?[^>]*>/gi,'[span class="edit_font_color"]').replace(/<font[^>]*color=(\")?#333333(\")?[^>]*>/gi,'[span class="edit_font_normal"]').replace(/<font[^>]*>/gi,'[span class="edit_font_normal"]').replace(/<\/font[^>]*>/gi,"[/span]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.submitValidHTML.join("|")+"|img|span|strong)[^\\]]*)\\]","gi"),"<$1>").replace(new RegExp("<span[^>]*>@</span>","gi"),"@").replace(new RegExp("<span[^>]*>@(.*?)</span>","gi"),"@$1 ");var m=document.createElement("div");m.innerHTML=o;var g=m.getElementsByTagName("span"),k=[],q,p,l,h;for(l=0,h=g.length;l<h;l++){if(g[l].className==="edit_font_normal"){k.push(g[l])}}for(l=0,h=k.length;l<h;l++){p=k[l];q=document.createDocumentFragment();while(p.firstChild){q.appendChild(p.firstChild)}p.parentNode.replaceChild(q,p)}this.parseURL(m);return m.innerHTML},filteHTML:function(h,g){return h.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+g.join("|")+")[^>]*)>","gi"),"[$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+g.join("|")+")[^\\]]*)\\]","gi"),"<$1>")},selectNodeContents:function(h,j){if(!h){return}var g,i;if(this.ua.ie){g=document.body.createTextRange();g.moveToElementText(h);if(j){g.collapse(false)}g.select()}else{i=this.getSelection();g=document.createRange();g.selectNodeContents(h);i.removeAllRanges();i.addRange(g);if(j){i.collapseToEnd()}}},hasSelection:function(){var g=this.getSelection();if(this.ua.ie){if(g.type){return g.type.toLowerCase()!=="none"}else{return false}}else{if(this.ua.opera){var h=this.getRange();return !(g.isCollapsed&&h.startContainer&&h.startContainer===h.endContainer&&h.startOffset===h.endOffset)}else{return !g.isCollapsed}}},saveCursor:function(){if(!this.focused){return}var g=document.getElementById("editor-tmp-img");if(g){g.parentNode.removeChild(g)}this.execCommand("inserthtml",'<img class="'+this.config.emptyClassName+'" id="editor-tmp-img" style="width:1px;height:1px">')},ensureCursor:function(){if(!this.focused){this.focus()}var h=document.getElementById("editor-tmp-img");if(h){if(this.ua.ie&&(!document.documentMode||document.documentMode<9)){this.selectNodeContents(h);this.execCommand("delete")}else{var g=document.createRange();g.selectNode(h);var i=window.getSelection();i.removeAllRanges();i.addRange(g);this.execCommand("delete")}}},savedRange:null,saveRange:function(){this.savedRange=this.getRange()},resumeRange:function(g){g=g||this.savedRange;if(!g){return false}if(this.ua.ie){try{g.select()}catch(i){}}else{var h=this.getSelection();h.removeAllRanges();h.addRange(g)}},cmd_inserthtml:function(g){if(this.ua.ie){var h=this.getRange();if(h.item){h.item(0).outerHTML=g}else{h.pasteHTML(g)}return[false]}return[true]},insertImage:function(g,i,p,l,h,q){var m="";if(typeof l!=="undefined"){m=l}var o=' onload="TED.EditorCore.ResizeImage(this);"';if(h>0){if(h>e.defaultConfig.imageWidthLimit){var s=h;var n=q;h=e.defaultConfig.imageWidthLimit;q=e.defaultConfig.imageWidthLimit*n/s}o=' height="'+q+'" width="'+h+'"'}if(this.ua.ie===8){this.execCommand("inserthtml",'<img unselectable="on"  pic_type="'+m+'"  class="'+i+'" id="editor-tmp-img" src="'+g+'" '+o+">");var j=document.getElementById("editor-tmp-img");j.removeAttribute("id");if(j.parentNode.lastChild===j){var r=document.createElement("br");j.parentNode.appendChild(r);var k=document.body.createTextRange();k.moveToElementText(r);if(p){k.collapse(false)}else{k.collapse(true)}k.select()}else{if(p){this.execCommand("insertlinebreak")}}}else{this.execCommand("inserthtml",'<img unselectable="on"   pic_type="'+m+'" class="'+i+'" src="'+g+'" '+o+">");if(p){this.execCommand("insertlinebreak")}}},cmd_insertlinebreak:function(){if(this.ua.webkit){document.execCommand("insertlinebreak",false,null)}else{if(this.ua.gecko){document.execCommand("inserthtml",false,'<br id="editor-tmp-br">');var h=document.getElementById("editor-tmp-br");h.removeAttribute("id");if(h.parentNode.lastChild===h){h.parentNode.removeChild(h);document.execCommand("inserthtml",false,'<br><br id="editor-tmp-br">');h=document.getElementById("editor-tmp-br");h.removeAttribute("id");var i=window.getSelection();var j=document.createRange();j.setStartBefore(h);j.setEndBefore(h);i.removeAllRanges();i.addRange(j)}}else{if(this.ua.ie){var g=this.getRange();if(g){g.pasteHTML("<br>");g.collapse(false);g.select()}}}}return[false]},cmd_insertsmiley:function(g){this.insertImage(g,this.config.smileyClassName);return[false]},cmd_insertimage:function(h,l,m){if(typeof h=="string"){this.insertImage(h,this.config.imageClassName,true,l)}else{if(Object.prototype.toString.apply(h)==="[object Array]"){if(m=="obj"){for(var k=0,g=h.length;k<g;k++){this.insertImage(h[k].url,this.config.imageClassName,true,l,h[k].width,h[k].height)}}else{for(var k=0,g=h.length;k<g;k++){this.insertImage(h[k],this.config.imageClassName,true,l)}}}}return[false]},cmd_focus2end:function(){var g=this.editArea;if(this.ua.ie){g.innerHTML=g.innerHTML}else{if(g.lastChild){var i=document.createRange(),h=window.getSelection();i.setStartAfter(g.lastChild);i.setEndAfter(g.lastChild);h.removeAllRanges();h.addRange(i)}else{g.focus()}}return[false]},editorPlugins:null,addPlugin:function(h,g){g.init(this);this.editorPlugins=this.editorPlugins||{};this.editorPlugins[h]=g},augmentObject:function(i,h){for(var g in h){if(h.hasOwnProperty(g)){i[g]=i[g]!==undefined?i[g]:h[g]}}},setStatsRequest:function(h){var g=new Image();window["bd_pv_"+(new Date).getTime()]=g;g.src="http://static.tieba.baidu.com/tb/img/pv.gif?fr=tb0_forum&st_mod=frspb&st_type=editor&st_value="+h+"&t="+(new Date).getTime();g=null},getTagNum:function(l,m){var h=this.editArea.getElementsByTagName(l),n=h.length;if(m){n=0;for(var k=0,g=h.length;k<g;k++){if(h[k].className===m){n++}}}return n},reLayout:function(n){var m=this.editArea.getElementsByTagName("img"),g=this.config.imageWidthLimit;var l=[];for(var k=0,h=m.length;k<h;k++){img=m[k];if(img.width===0||img.height===0){l.push(img);continue}if(n){img.removeAttribute("unselectable")}if(img.className===this.config.imageClassName){if(img.width>g){img.setAttribute("width",g);img.setAttribute("changedsize",true)}else{img.setAttribute("width",img.width)}img.setAttribute("height",img.height)}else{if(img.className===this.config.smileyClassName){if(img.width>100){img.setAttribute("width",100)}else{img.setAttribute("width",img.width)}img.setAttribute("height",img.height)}else{img.setAttribute("width",img.width);img.setAttribute("height",img.height)}}img.removeAttribute("onload")}for(var k=0,h=l.length;k<h;k++){l[k].parentNode.removeChild(l[k])}},parseURL:function(k){var h="(=*+)",g="(+*=)";var j=4;var i=function(l){if(l.nodeType==3){var m=l.nodeValue;if(m&&m.length>j){m="."+m;m=m.replace(/([^0-9a-zA-Z])((www\.|http:\/\/|mms:\/\/|rtsp:\/\/|ftp:\/\/|https:\/\/)[0-9a-zA-Z\.\!\~\#\?\:\/\&\%\-\+\*\'\=\@\_\$]+)/gi,"$1"+h+'a href="$2" target="_blank"'+g+"$2"+h+"/a"+g);m=m.substring(1);l.nodeValue=m}}else{if(l.nodeType==1){var n=l.firstChild;while(n){if(n.nodeName.toUpperCase()!="A"){i(n)}n=n.nextSibling}}}};i(k);k.innerHTML=k.innerHTML.replace(/\(\=\*\+\)a\ href="www\./gi,'<a href="http://www.').replace(/\(\=\*\+\)/gi,"<").replace(/\(\+\*\=\)/gi,">")}});window.TED["EditorCore"]=e;var a={instanceNum:0,idPrefix:"tb-editor-",registerInstance:function(g,h){this.instances=this.instances||{};h=h||this.generateID();this.instances[h]=g;return h},generateID:function(){return this.idPrefix+ ++this.instanceNum},getInstanceById:function(g){return(g&&this.instances)?this.instances[g]:null}};window.TED["EditorInstanceManager"]=a;function d(g){d.superclass.call(this);this.area=document.createElement("textarea");if(g.is_ipad){this.area.className="textarea_ipad"}this.area.style.width=g.width;this.area.style.height=g.height;if(g.autoEnable===false){this.area.disabled=true}document.getElementById(g.container).appendChild(this.area);this.init()}f(d,c,{isMobile:true,init:function(){var g=this;this.area.onfocus=function(){g.fireEvent("focus")};this.area.onclick=function(){g.fireEvent("click")};if(this.constructor.registerInstance){this.id=this.constructor.registerInstance(this)}},getImageNum:function(){return 0},getSmileyNum:function(){return 0},getFlashNum:function(){return 0},getMusicNum:function(){return 0},getHtml:function(){return this.area.value.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\r?\n/gi,"<br>").replace(/[\u3000\s]/gi,"&nbsp;").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")},focus:function(){this.area.focus()},blur:function(){this.area.blur()},isEmpty:function(){var g=this.area;return !(g&&g.value&&g.value.replace(/[\u3000\s]/gi,"").replace(/\r?\n/gi,"").replace(/\t/gi,"")!="")},quoteContainer:null,quote:function(j,g,k){j=parseInt(j);if(j>1){if(this.quoteContainer===null){this.quoteContainer=document.createElement("div");this.quoteContainer.className="editor-quote";this.area.parentNode.insertBefore(this.quoteContainer,this.area)}var i=document.getElementById("post_content_"+g).innerHTML.replace(/<img[^>]*>/gi,"[\u56fe\u7247]").replace(/<embed[^>]*>/gi,"[\u89c6\u9891]").replace(/<br[^>]*>/gi," ").replace(/<a[^>]*>/gi,"").replace(/<\/a>/gi,"").subByte(270);this.quoteContainer.innerHTML='<blockquote class="quote quote_simple"><a href="javascript:void(0);" onmousedown="return false;" onclick="TED.TextInput.getInstanceById(\''+this.id+'\').unQuote();Stats.sendRequest(\'fr=tb0_forum&st_mod=pb&st_type=quote&st_value=delete\');" class="close" title="\u5220\u9664\u5f15\u7528">\u2573</a><p class="quote_title">\u5f15\u7528&nbsp;'+k+'&nbsp;(<a href="#'+g+'">'+j+'\u697c</a>)</p><p class="quote_content">'+i+"</p></blockquote>";this.quoteContainer.style.display="block";this.fireEvent("quote",null,[g])}else{this.unQuote();Stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=quote&st_value=replyfirst")}var h=this;setTimeout(function(){h.focus()},100)},unQuote:function(){if(this.quoteContainer){this.quoteContainer.style.display="none"}this.fireEvent("unquote")}});TED.augmentObject(d,a);window.TED["TextInput"]=d})();;function Sketchpad(a,b){this.init(a,$.extend({},Sketchpad.defaultOptions,b))}Sketchpad.template='<canvas class="sketchpad_bg"></canvas>     <canvas class="sketchpad_result"></canvas>     <canvas class="sketchpad_mask"></canvas>     <textarea class="sketchpad_text_input" style="display: none;"></textarea>';Sketchpad.defaultOptions={width:400,height:300,fixCanvas:false,onhistorychange:function(){}};Sketchpad.prototype={init:function(a,c){var b=this;this.element=$(a);var d=$(Sketchpad.template);d.filter("canvas").each(function(){this.width=c.width;this.height=c.height});this.element.addClass("sketchpad").css({width:c.width,height:c.height}).append(d);this.fixCanvas=c.fixCanvas;this.history=[];this.onhistorychange=c.onhistorychange;this.redoStack=[];this.clearState=false;this.bgCanvas=this.element.find(".sketchpad_bg");this.bgContext=this.bgCanvas[0].getContext("2d");this.mouseDownHandler=this._mouseDownLineHandler;this.mouseUpHandler=this._mouseUpLineHandler;this.mouseMoveHandler=this._mouseMoveLineHandler;this.initCanvas();this.initTextInput();this.currentCommand=null;this.setPaintType("brush");this.setPaintShape("rect");this.setLineWidth(3);this.setPaintColor("black");this.setPaintFontSize(12);this.refreshPosition();this.element.on("dragover",function(f){f.preventDefault();f.stopPropagation()});this.element[0].addEventListener("drop",function(h){h.preventDefault();h.stopPropagation();var g=h.dataTransfer.files[0];var f=new FileReader();f.onload=function(j){var i=new Image();i.onload=function(){b.setBackgroundImage(i)};i.src=j.target.result};f.readAsDataURL(g)})},initTextInput:function(){this.textInput=this.element.find(".sketchpad_text_input")},initCanvas:function(){var a=this;this.resultCanvas=this.element.find(".sketchpad_result");this.resultContext=this.resultCanvas[0].getContext("2d");this.maskCanvas=this.element.find(".sketchpad_mask");this.maskContext=this.maskCanvas[0].getContext("2d");this.maskCanvas.on("click",function(f){if(a.paintType=="text"){if(!a.textDrawing){a.textDrawing=true;var e=f.clientX-a.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft);var j=f.clientY-a.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);a.textInput.css({left:e,top:j}).show().focus()}else{a.textDrawing=false;var h=a.textInput.val();if(h.length>0){var d=a.textInput[0].offsetLeft+1;var i=a.textInput[0].offsetTop;var g=a.drawText(a.resultContext,h,d,i,a.textInput.innerWidth());a._pushHistory(g);a.textInput.val("")}a.textInput.hide()}}});this.maskCanvas.on("mousedown",function(d){d.preventDefault();a.mouseDownHandler(d)});var b=function(d){a.mouseUpHandler(d)};var c=function(d){a.mouseMoveHandler(d)};$(document).on("mouseup",b).on("mousemove",c);a.clearEvents=function(){$(document).unbind("mouseup",b).unbind("mousemove",c)}},_mouseDownLineHandler:function(b){var a=this;a.drawing=true;a.iLastX=b.clientX-a.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft);a.iLastY=b.clientY-a.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);a.drawPoint(a.resultContext,a.iLastX,a.iLastY,a.lineWidth);if(a.currentCommand==null){a.currentCommand={type:"brush",path:[],color:a.paintColor,lineWidth:a.lineWidth,clearState:a.clearState,startPoint:{x:a.iLastX,y:a.iLastY,diameter:a.lineWidth}}}},_mouseMoveLineHandler:function(c){var b=this;if(b.drawing){var a=c.clientX-b.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft);var e=c.clientY-b.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);var d={fromX:b.iLastX,fromY:b.iLastY,toX:a,toY:e};b.drawLine(b.resultContext,d);b.currentCommand.path.push(d);b.iLastX=a;b.iLastY=e}},_mouseUpLineHandler:function(b){var a=this;if(a.drawing){a.drawing=false;a.iLastX=-1;a.iLastY=-1;a._pushHistory(a.currentCommand);a.currentCommand=null}},_mouseDownShapeHandler:function(b){var a=this;a.drawing=true;a.iLastX=b.clientX-a.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft);a.iLastY=b.clientY-a.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop)},_mouseMoveShapeHandler:function(c){var b=this;if(b.drawing){b._clear(b.maskContext);var a=c.clientX-b.offset.left+(window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft);var d=c.clientY-b.offset.top+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop);b.currentCommand=b.drawShape(b.maskContext,b.iLastX,b.iLastY,a-b.iLastX,d-b.iLastY)}},_mouseUpShapeHandler:function(b){var a=this;if(a.drawing){a.drawing=false;a.iLastX=-1;a.iLastY=-1;a._clear(a.maskContext);if(a.currentCommand){a.doCommand(a.currentCommand);a._pushHistory(a.currentCommand);a.currentCommand=null}}},_mouseDownTextHandler:function(){},_mouseMoveTextHandler:function(){},_mouseUpTextHandler:function(){},_pushHistory:function(a){this.history.push(a);this.onhistorychange(this.history,this.redoStack)},drawLine:function(a,b){a.beginPath();a.moveTo(b.fromX,b.fromY);a.lineTo(b.toX,b.toY);a.stroke()},drawPoint:function(b,a,d,c){b.beginPath();b.arc(a,d,c/2,0,Math.PI*2,true);b.closePath();b.fill()},drawPath:function(c,f){var d=f.startPoint;this.drawPoint(c,d.x,d.y,d.diameter);var e=f.path;for(var b=0,a=e.length;b<a;b++){this.drawLine(c,e[b])}},drawRect:function(c,a,e,b,d){c.strokeRect(a,e,b,d);return{type:"shape",shape:"rect",x:a,y:e,width:b,height:d,color:this.paintColor,lineWidth:this.lineWidth}},drawEllipse:function(m,j,i,k,d){var g=0.5522848;var c=(k/2)*g,a=(d/2)*g,l=j+k,f=i+d,e=j+k/2,b=i+d/2;m.beginPath();m.moveTo(j,b);m.bezierCurveTo(j,b-a,e-c,i,e,i);m.bezierCurveTo(e+c,i,l,b-a,l,b);m.bezierCurveTo(l,b+a,e+c,f,e,f);m.bezierCurveTo(e-c,f,j,b+a,j,b);m.closePath();m.stroke();return{type:"shape",shape:"ellipse",x:j,y:i,width:k,height:d,color:this.paintColor,lineWidth:this.lineWidth}},drawText:function(p,m,i,h,k,r){r=r||this.fontSize;var g=m.split("");var j=r*1.2;var e=h;e+=r;for(var b=0,c=g.length,q="";b<c;b++){var a=g[b];if(a=="\n"){p.fillText(q,i,e);q="";e+=j}else{var d=q+a;var f=p.measureText(d);var o=f.width;if(o>k){p.fillText(q,i,e);q=a;e+=j}else{q=d}}}p.fillText(q,i,e);return{type:"text",x:i,y:h,text:m,maxWidth:k,color:this.paintColor,fontSize:r}},setPaintType:function(a){this.paintType=a;if(a=="shape"){this.mouseDownHandler=this._mouseDownShapeHandler;this.mouseUpHandler=this._mouseUpShapeHandler;this.mouseMoveHandler=this._mouseMoveShapeHandler}else{if(a=="brush"){this.mouseDownHandler=this._mouseDownLineHandler;this.mouseUpHandler=this._mouseUpLineHandler;this.mouseMoveHandler=this._mouseMoveLineHandler}else{this.mouseDownHandler=this._mouseDownTextHandler;this.mouseUpHandler=this._mouseUpTextHandler;this.mouseMoveHandler=this._mouseMoveTextHandler}}if(a=="text"){this.element.css("cursor","text")}else{this.element.css("cursor","crosshair")}},setClear:function(a){this.clearState=a;if(a){this.resultContext.globalCompositeOperation="destination-out"}else{this.resultContext.globalCompositeOperation="source-over"}},_setPaintColor:function(a){this.resultContext.strokeStyle=a;this.maskContext.strokeStyle=a;this.resultContext.fillStyle=a;this.maskContext.fillStyle=a;this.textInput.css("color",a)},setPaintColor:function(a){this._setPaintColor(a);this.paintColor=a},_setLineWidth:function(a){this.resultContext.lineWidth=a;this.maskContext.lineWidth=a;this.resultContext.lineCap="round";this.maskContext.lineCap="round"},setLineWidth:function(a){this._setLineWidth(a);this.lineWidth=a},setPaintShape:function(a){if(a=="rect"){this.drawShape=this.drawRect}else{if(a=="ellipse"){this.drawShape=this.drawEllipse}}},setBackgroundImage:function(c){if(this.fixCanvas){var b=this.width/this.height;var d=null;var a=0,e=0;if(c.width>this.width||c.height>this.height){if((c.width/c.height)>b){d=c.width/this.width;c.width=this.width;c.height=c.height/d}else{d=c.height/this.height;c.height=this.height;c.width=c.width/d}}a=(this.width-c.width)/2;e=(this.height-c.height)/2;this._clear(this.bgContext);this.bgContext.drawImage(c,a,e,c.width,c.height)}else{this.bgCanvas.attr({width:c.width,height:c.height});this.resultCanvas.attr({width:c.width,height:c.height});this.maskCanvas.attr({width:c.width,height:c.height});this.element.css({width:c.width,height:c.height});this.width=c.width;this.height=c.height;this.bgContext.drawImage(c,0,0)}this.setPaintColor(this.paintColor);this.setLineWidth(this.lineWidth);this.setPaintFontSize(this.fontSize)},removeBackgroundImage:function(){this._clear(this.bgContext)},_setPaintFontSize:function(a){this.resultContext.font=a+"px '\u5b8b\u4f53'";this.textInput.css("fontSize",a)},setPaintFontSize:function(a){this._setPaintFontSize(a);this.fontSize=a},doCommand:function(a){this.resultContext.save();this.resultContext.strokeStyle=a.color;this.resultContext.fillStyle=a.color;if(a.type=="text"){this.resultContext.font=a.fontSize+"px '\u5b8b\u4f53'"}else{this.resultContext.lineWidth=a.lineWidth}if(a.type=="shape"&&a.shape=="rect"){this.resultContext.strokeRect(a.x,a.y,a.width,a.height)}else{if(a.type=="shape"&&a.shape=="ellipse"){this.drawEllipse(this.resultContext,a.x,a.y,a.width,a.height)}else{if(a.type=="text"){this.drawText(this.resultContext,a.text,a.x,a.y,a.maxWidth,a.fontSize)}else{if(a.type=="brush"){if(a.clearState){this.resultContext.globalCompositeOperation="destination-out"}else{this.resultContext.globalCompositeOperation="source-over"}this.drawPath(this.resultContext,a)}}}}this.resultContext.restore()},_clear:function(a){a.clearRect(0,0,this.width,this.height)},clear:function(){this._clear(this.resultContext);this.history.length=0;this.redoStack.length=0;this.onhistorychange(this.history,this.redoStack)},undo:function(){this._clear(this.resultContext);this.redoStack.push(this.history.pop());this.onhistorychange(this.history,this.redoStack);for(var b=0,a=this.history.length;b<a;b++){this.doCommand(this.history[b])}},redo:function(){var a=this.redoStack.pop();if(a!=null){this.doCommand(a);this._pushHistory(a)}},destroy:function(){this.clearEvents();this.element.html("")},refreshPosition:function(){this.offset=this.resultCanvas.offset();this.width=this.resultCanvas.width();this.height=this.resultCanvas.height()},getResult:function(a){a=a||"image/png";return this.resultCanvas[0].toDataURL(a)},_dataURLtoBlob:function(d,h){var c=atob(d.split(",")[1]);var b=d.split(",")[0].split(":")[1].split(";")[0];var j=new ArrayBuffer(c.length);var a=new Uint8Array(j);for(var e=0;e<c.length;e++){a[e]=c.charCodeAt(e)}var f=(window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder);if(f){var g=new f();g.append(j);return g.getBlob(b)}else{if(Blob){return new Blob([j],{type:b})}else{return null}}},getResultAsBlob:function(a){a=a||"image/png";return this._dataURLtoBlob(this.getResult(),a)}};function PicassoPanel(a,b){this.init(a);this.overlay=b}PicassoPanel.prototype={init:function(b){var c=this;c.container=$(b);c.container.html(PicassoPanel.template);c.currentColor="#ED2329";c.brushType="brush";var a=c.container.find(".tb_picasso_content");this.sketchpad=new Sketchpad(a,{fixCanvas:true,onhistorychange:function(e,d){if(e.length==0){c.undoButton.prop("disabled",true);c.clearButton.prop("disabled",true)}else{c.undoButton.prop("disabled",false);c.clearButton.prop("disabled",false)}if(d.length==0){c.redoButton.prop("disabled",true)}else{c.redoButton.prop("disabled",false)}}});this.sketchpad.setPaintColor("#ED2329");c.container.find(".color_panel").on("click","div",function(){var d=this.style.backgroundColor;$(this).parent().siblings(".focus").removeClass("focus").end().addClass("focus");c.currentColor=d;if(c.brushType=="brush"){c.sketchpad.setPaintColor(d)}});c.brushButtons=c.container.find(".brush_button");c.brushButtons.click(function(){c.brushButtons.filter(".focus").removeClass("focus");var d=$(this).addClass("focus");var f=d.data("brushType");var e=d.text()-0;c.sketchpad.setLineWidth(e);if(f=="eraser"){c.sketchpad.setClear(true);c.sketchpad.setPaintColor("black")}else{c.sketchpad.setClear(false);c.sketchpad.setLineWidth(e);c.sketchpad.setPaintColor(c.currentColor)}c.brushType=f});c.deleteBgButton=c.container.find(".sketchpad_remove_bg").click(function(){c.sketchpad.removeBackgroundImage();c.deleteBgButton.addClass("disabled")});c.undoButton=c.container.find(".sketchpad_undo").click(function(){c.sketchpad.undo()});c.redoButton=c.container.find(".sketchpad_redo").click(function(){c.sketchpad.redo()});c.clearButton=c.container.find(".sketchpad_clear").click(function(){c.sketchpad.clear()});c.finishButton=c.container.find(".sketchpad_finish").click(function(){if(c.sketchpad.history.length==0){c.messagePanel.show();return}$(this).prop("disabled",true);var g=c.container.find(".sketchpad_sign")[0];var e=g.getContext("2d");e.fillStyle="#EEEEEE";e.fillRect(0,0,416,335);e.fillStyle="#FFFFFF";e.fillRect(8,8,400,300);e.drawImage(c.sketchpad.bgCanvas[0],8,8,400,300);e.drawImage(c.sketchpad.resultCanvas[0],8,8,400,300);var d="By "+PageData.user.name;var f=e.measureText(d);e.font="12px '\u5b8b\u4f53'";e.fillStyle="black";e.fillText(d,400-f.width,325);e.fillText("\u8d34\u5427\u6d82\u9e26",8,325);c._uploadImage(g)});c.container.find(".sketchpad_image_input").change(function(){var f=this;if(f.files.length>0){var e=f.files[0];if(/^image/.test(e.type)){var d=new FileReader();d.onload=function(h){var g=new Image();g.onload=function(){c.sketchpad.setBackgroundImage(g);c.deleteBgButton.removeClass("disabled")};g.src=h.target.result};d.readAsDataURL(e)}}});c.messagePanel=c.container.find(".picasso_message");c.messagePanel.find(".picasso_message_apply").click(function(){c.messagePanel.hide()});if(!window.FlashImageLoader){$.JsLoadManager.use("http://static.tieba.baidu.com/tb/static-frs/component/sign_shai/flash_image_loader.js")}},_getTbs:function(b){var a=this;$.ajax({url:"http://tieba.baidu.com/dc/common/imgtbs",dataType:"json",success:function(c){if(c&&c.data&&c.data.tbs&&b&&_.isFunction(b)){b(c.data.tbs)}}})},_uploadImage:function(b){var a=this;a._getTbs(function(d){var c=b.toDataURL().replace(/^.*base64\,/,"");window.FlashImageLoader.bind("uploadComplete",a._uploadedHandler,a);window.FlashImageLoader.uploadBase64("http://upload.tieba.baidu.com/upload/pic",c,{tbs:d})})},_uploadedHandler:function(a,d){var c=$.json.decode(d);if(c.error_code!=0){alert("\u56fe\u7247\u4e0a\u4f20\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5");this.finishButton.prop("disabled",false)}else{var b=c.info.pic_id_encode;var e="http://imgsrc.baidu.com/forum/pic/item/"+b+".jpg";window.rich_postor._editor.execCommand("insertimage",e,5);this.sketchpad.destroy();window.FlashImageLoader.unbind("uploadComplete",this._uploadedHandler);this.overlay.close(true)}},destroy:function(){this.sketchpad.destroy();if(window.FlashImageLoader){window.FlashImageLoader.unbind("uploadComplete",this._uploadedHandler)}this.container.html("")}};PicassoPanel.template='<div class="tb_picasso_vcanvas">    <div class="tb_picasso_content"></div>    <div class="sketchpad_v_toolbar">        <ul>            <li>                <ul class="color_panel clearfix">                    <li><div style="background: #FFFFFF;border: 1px solid #FFFFFF;"></div></li>                    <li><div style="background: #B5B5B5;border: 1px solid #B5B5B5;"></div></li>                    <li><div style="background: #F79579;border: 1px solid #F79579;"></div></li>                    <li><div style="background: #FDC58B;border: 1px solid #FDC58B;"></div></li>                    <li><div style="background: #80C99C;border: 1px solid #80C99C;"></div></li>                    <li><div style="background: #000000;border: 1px solid #000000;"></div></li>                    <li><div style="background: #626262;border: 1px solid #626262;"></div></li>                    <li class="focus"><div style="background: #ED2329;border: 1px solid #ED2329;"></div></li>                    <li><div style="background: #F79323;border: 1px solid #F79323;"></div></li>                    <li><div style="background: #00A451;border: 1px solid #00A451;"></div></li>                    <li><div style="background: #6CCEF7;border: 1px solid #6CCEF7;"></div></li>                    <li><div style="background: #F499C0;border: 1px solid #F499C0;"></div></li>                    <li><div style="background: #00ACEE;border: 1px solid #00ACEE;"></div></li>                    <li><div style="background: #EC008B;border: 1px solid #EC008B;"></div></li>                    <li><div style="background: #D8003D;border: 1px solid #D8003D;"></div></li>                </ul>            </li>            <li class="sketchpad_button_brush">                <ul class="sketchpad_brush_panel clearfix">                    <li class="brush_button brush_small" data-brush-type="brush">1</li>                    <li class="brush_button brush_middle focus" data-brush-type="brush">3</li>                    <li class="brush_button brush_big" data-brush-type="brush">5</li>                </ul>            </li>            <li class="sketchpad_button_eraser">                <ul class="sketchpad_brush_panel clearfix">                    <li class="brush_button brush_small" data-brush-type="eraser">1</li>                    <li class="brush_button brush_middle" data-brush-type="eraser">3</li>                    <li class="brush_button brush_big" data-brush-type="eraser">5</li>                </ul>            </li>            <li>                <div class="sketchpad_bg_input">                    <button type="button" class="sketchpad_add_bg">\u6dfb\u52a0\u80cc\u666f</button>                    <input type="file" class="sketchpad_image_input" />                </div>            </li>            <li>                <button type="button" class="sketchpad_remove_bg disabled">\u5220\u9664\u80cc\u666f</button>            </li>        </ul>    </div>    <div class="sketchpad_h_toolbar">        <button type="button" class="sketchpad_undo" disabled="disabled">\u4e0a\u4e00\u6b65</button>        <button type="button" class="sketchpad_redo" disabled="disabled">\u4e0b\u4e00\u6b65</button>        <button type="button" class="sketchpad_clear" disabled="disabled">\u6e05\u7a7a</button>        <button type="button" class="sketchpad_finish">\u753b\u597d\u4e86</button>    </div>    <canvas class="sketchpad_sign" width="416" height="335"  style="display: none;" ></canvas>    <div class="picasso_message" style="display: none;">        <p>\u5c1a\u672a\u4f5c\u753b\uff0c\u767d\u7eb8\u4e00\u5f20\uff01&gt;.&lt;</p>        <p><button type="button" class="picasso_message_apply">\u786e\u5b9a</button></p>    </div></div>';;(function(){window.TED["EditorPlugins"]["AutoHeightPlugin"]=a;window.TED["EditorPlugins"]["ImageEditor"]=i;var j=TED.extend,d=TED.EventDispatcher,l=TED.Storage;function i(){}i.prototype={constructor:i,init:function(o){var n=navigator.userAgent.toLowerCase().match(/chrome\/([\d]+)/);if((n&&parseInt(n[1])>=21)||$.browser.mozilla){var m=this;_.Module.use("common/component/image_htmlx_editor",[],function(p){p.addDelegateContainer(o.editArea,"."+o.config.imageClassName);p.setRichEditor(o);m.imageEditor=p})}}};function a(){this.editorOffsetTop=0;this.editor=null;this.editorYdistanceToButton=200}a.prototype={constructor:a,init:function(m){this.editor=m;m.enableAutoHeight(this.getEditorMaxHeight());m.on("heightChanged",this.onEditorHeightChanged,this);m.on("focus",this.onEditorFocus,this);var n=this;if(document.addEventListener){window.addEventListener("resize",function(){n.editor.enableAutoHeight(n.getEditorMaxHeight())},false)}else{window.attachEvent("onresize",function(){n.editor.enableAutoHeight(n.getEditorMaxHeight())})}},onEditorHeightChanged:function(o,p){var n=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;var m=document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;if(n>=this.editorOffsetTop-20){return}window.scrollTo(m,n+p)},onEditorFocus:function(){this.editorOffsetTop=this.getPageY(this.editor.wrapper)},getPageY:function(m){return m.offsetParent?m.offsetTop+this.getPageY(m.offsetParent):m.offsetTop},getEditorMaxHeight:function(){var m=(window.innerHeight)?window.innerHeight:(document.documentElement&&document.documentElement.clientHeight)?document.documentElement.clientHeight:document.body.offsetHeight;m-=this.editorYdistanceToButton;return m}};window.TED["EditorPlugins"]["FilteHtmlPlugin"]=e;function e(n,m){this.editor=null;this.editValidHTML=["br","img","strong","span","b","font"];this.isAutoImage=n===undefined?true:n;this.isFirstTimeImgRec=true;this.timer=null;if($.browser.msie){document.getElementById("bdInputObjWrapper").innerHTML='<object id="BdInputAx" classid="CLSID:D64016F6-4D8E-4B35-AB22-9B2060800112" width="0" height="0"></object>'}else{if(!$.browser.mozilla){document.getElementById("bdInputObjWrapper").innerHTML='<object id="BdInputAx" type="application/baiducnff-activex" progid="BaiducnAx.ScreenShotAx.1" width="0" height="0"></object>'}}this.bdInputObj=document.getElementById("BdInputAx");if(this.bdInputObj&&"GetNewSession" in this.bdInputObj){this.supportBdInput=true;this.bdInputObj.StartReadFileFuncName="bdInputRead";window.bdInputFuck=this;window.bdInputSession=0;window.bdInputPasting=false;window.bdInputUploader=null;window.bdInputTbs="";$.getJSON("http://tieba.baidu.com/dc/common/imgtbs",function(p){var o={};if(p.no==0){o.uploadUrl="http://upload.tieba.baidu.com/upload/pic?tbs="+p.data.tbs}_.Module.use("common/component/image_uploader_manager",[o],function(q){bdInputUploader=q})});window.bdInputShowError=function(o){clearTimeout(window.bdInputErrorTimer);m._errorTipShow(o);window.bdInputErrorTimer=setTimeout(function(){m._errorTipHide()},2000)};window.bdInputUploadCallback=function(p){var o,q;if(p.errorCode!=0){window.bdInputShowError("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")}else{if(p.response.error_code!=0){window.bdInputShowError("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")}o=p.response.info.pic_id_encode;q="http://imgsrc.baidu.com/forum/pic/item/"+o+".jpg";bdInputFuck.editor.execCommand("insertimage",q,8)}};window.bdInputInsertImg=function(o){if(!window.bdInputUploader){_.Module.use("common/component/image_uploader_manager",[],function(p){bdInputUploader=p;bdInputUploader.uploadBase64(o,bdInputUploadCallback)})}else{bdInputUploader.uploadBase64(o,bdInputUploadCallback)}};window.bdInputRead=function(){var s,v,u,r="",q=[],p=0,t=0;s=document.getElementById("BdInputAx");v=s.GetFileCount(bdInputSession);if(v==0){return}for(var o=0;o<v;o++){u=s.GetFileRange(bdInputSession,o);if(u>4194304){p++;continue}r=s.GetFileMem(bdInputSession,o,0,u);window.bdInputInsertImg(r)}s.EndSceenShotParse(bdInputSession);if(p){bdInputShowError("\u526a\u8d34\u677f\u4e2d\u6709"+p+"\u5f20\u6587\u4ef6\u8fc7\u5927\uff0c\u4f7f\u7528\u56fe\u7247\u4e0a\u4f20\u8bd5\u8bd5\u5427~")}}}else{this.supportBdInput=false}this.enable=true}e.prototype={init:function(m){this.editor=m;if($.browser.opera===true){return}m.on("paste",this.filteHTML,this);m.on("keyup",this.dealWithKeyup,this);m.on("keydown",this.onEditorKeydown,this)},onEditorKeydown:function(p){clearTimeout(this.timer);if(p.keyCode===229){this.enable=false}else{this.enable=true}var o=p||window.event,n=(o.ctrlKey&&o.keyCode==86),m=this;if(n){if(m.supportBdInput&&!this.bdPasteImage){if(m.bdInputTimer!=null){clearTimeout(m.bdInputTimer);m.bdInputTimer=null}m.bdInputTimer=setTimeout(function(){bdInputSession=m.bdInputObj.GetNewSession();m.bdInputObj.StartScreenShotParse(bdInputSession)},400)}}},dealWithKeyup:function(p){if(!this.enable){return}if(this.editor.hasSelection()){return}var q=this;if(q.timer){clearTimeout(q.timer)}var o=p||window.event;var n=(o.ctrlKey&&o.keyCode==86);var m=this;q.timer=setTimeout(function(r){if(m.editor.editorPlugins.refer&&m.editor.editorPlugins.refer.box.isShow){return}q.preFilte();if(!r){q.autoRecognizeImgUrl()}},300)},filteHTML:function(n){n.exitFunction=true;var m=this;if(m.filterTimer){clearTimeout(m.filterTimer);m.filterTimer=null}m.filterTimer=setTimeout(function(){m.preFilte();if(m.isAutoImage==true){m.autoRecognizeImgUrl();m.dealWithImages()}},50)},createImageTagFromUrl:function(m){var n='<img unselectable="on" src="_LEG_IMG_" class="BDE_Image" onload="TED.EditorCore.ResizeImage(this);" onerror="Stats.sendRequest(\'fr=tb0_forum&st_mod=editor&st_type=urlimagefail&st_value=1\');this.removeAttribute(\'onload\');this.removeAttribute(\'onerror\');" />';return n.replace("_LEG_IMG_",m)},createVideoFromUrl:function(m,o,p){var n='<img unselectable="on" width="219" height="174" data-width="500" data-height="450" ';if(o){n+=' video_url="'+o+'"'}if(p){n+=' video_mp4_url="'+p+'"'}n+=' title="'+m+'" src="/tb/editor/v2/flash.png" class="BDE_Flash"/><br />';return n},convert_urls:[[/http:\/\/client\.joy\.cn\/flvplayer\/([0-9a-zA-Z]*)_([0-9]*)_[1-9]*_([0-9]*)\.swf$/ig,"http://client.joy.cn/flvplayer/$1_$2_0_$3.swf"],[/http:\/\/www\.letv\.com\/player\/x([0-9a-zA-Z_]*)\.swf$/ig,"http://www.letv.com/player/share/baidu/x$1.swf"],[/http:\/\/www\.kankanews\.com\/object\/kankanewsplayer([0-9a-zA-Z\-\.]*)\.swf/ig,"http://www.kankanews.com/object/kankanewsplayer3.0.swf"],[/http:\/\/www\.m1905\.com\/video\/m\/([0-9]*)\/v\.swf/ig,"http://www.m1905.com/video/s/$1/v.swf?autoplay=0"],[/(http:\/\/share\.vrs\.sohu\.com\/[0-9a-zA-Z_]*\/v\.swf)(\S*)$/ig,"$1&autoplay=false"],[/http:\/\/v\.youku\.com\/v_show\/id_([0-9a-zA-Z_]+)\.html/ig,"http://player.youku.com/player.php/sid/$1/v.swf"],[/http:\/\/www\.tudou\.com\/programs\/view\/([0-9a-zA-Z]*)\/?$/ig,"http://www.tudou.com/v/$1/v.swf"],[/http:\/\/v\.ku6\.com\/show\/([0-9a-zA-Z_\.&\?]+).html/ig,"http://player.ku6.com/refer/$1/v.swf"],[/http:\/\/v\.ku6\.com\/special\/([0-9a-zA-Z_\.&\?]+).html/ig,"http://player.ku6.com/refer/$1/v.swf"],[/http:\/\/www\.56\.com\/u([0-9a-zA-Z_]+)\/([0-9a-zA-Z_\.&\?]+).html/ig,"http://player.56.com/$2.swf"]],convertToMp4:[],convert:function(n,m){var p=m,q=n;for(var o=0;o<p.length;o++){n=n.replace(p[o][0],p[o][1])}return n},auto_params:[["client.joy.cn","playstatus",/playstatus=/ig,"0"],["//v.ifeng.com","AutoPlay",/AutoPlay=/ig,"false"],["m1905.com","autoplay",/autoplay=/ig,"0"],["kankanews.com","otherLink",/otherLink=/ig,"false"]],filter_param:function(o){if(o.indexOf("share.vrs.sohu.com")<0){o=o.replace(/(\&)?\w*auto\w*=[\w\d]+/ig,"")}var q=this.auto_params;for(var m=0;m<q.length;m++){var n=q[m];if(o.indexOf(n[0])>-1){o=o.replace(n[2],"old_invalid=");o+=(o.indexOf("?")>-1?"&":"?")+n[1]+"="+n[3]}}return o},videoUrlRec:function(n,m,r,p){var t=this;var o=n;var q="";n=t.convert(n,t.convert_urls);if(!t.isWhiteList_video(n)){return n}q=t.convert(o,t.convertToMp4);if(q==o){q=""}n=t.filter_param(n);Stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=urlVideoRec&st_value=1");return t.createVideoFromUrl(n,o,q)},isWhiteList_video:function(o){var m=this.editor.config.flashWhiteList;for(var p=0,n=m.length;p<n;p++){if(o.indexOf(m[p])==0){return true}}return false},dealWithImages:function(){this.editor.saveCursor();var n=this.editor.editArea.getElementsByTagName("img");var m=false;for(var o=0;o<n.length;o++){var p=n[o].className;if(p=="BDE_Image"||p=="BDE_Smiley"||p=="BDE_Flash"||p=="BDE_Music"||p=="BDE_Empty"||n[o].getAttribute("id")=="editor-tmp-img"){continue}if(this.bdInputTimer){clearTimeout(this.bdInputTimer);this.bdInputTimer=null}m=true;var q=document.createElement("img");var r=n[o].getAttribute("src");if(!(/\.gif|\.png|\.bmp|\.jpeg|\.jpg$/.test(r))){r+=".gif"}if(!(/^http/).test(r)){r="http://"+document.domain+r}q.setAttribute("src",r);q.className="BDE_Image";q.setAttribute("onload","TED.EditorCore.ResizeImage(this)");n[o].parentNode.replaceChild(q,n[o])}this.bdPasteImage=m;this.editor.ensureCursor()},autoRecognizeImgUrl:function(){this.editor.saveCursor();var o=this;var m=/(?:<img.*?>)|(?:<emb.*?>)|(?:http:\/\/((?:[a-zA-Z\d\-]+\.)+[a-zA-Z\d]+(?:\:[\d]{2,5})?)\/([^\s]+?)\.(jpg|jpeg|gif|png|bmp))/gi;var n=this.editor.editArea.innerHTML;n=n.replace(m,function(r,p,v,t,q,u){if(r.charAt(0)=="<"){return r}else{o.sendStatistics(1);return o.createImageTagFromUrl(r)}});this.editor.editArea.innerHTML=n;this.editor.ensureCursor()},preFilte:function(){var n=this;this.editor.saveCursor();var m=this.editor.editArea.innerHTML;this.editor.editArea.innerHTML=m.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(/<\/ ?tr[^>]*>/gi,"[br]").replace(/<\/ ?td[^>]*>/gi,"&nbsp;&nbsp;").replace(/<(ul|dl|ol)[^>]*>/gi,"[br]").replace(/<(li|dd)[^>]*>/gi,"[br]").replace(/<p [^>]*>/gi,"[br]").replace(/<span[^>]*class="?edit_font_normal"?[^>]*>/gi,'[span class="edit_font_normal"]').replace(/<span[^>]*class="?edit_font_color"?[^>]*>/gi,'[span class="edit_font_color"]').replace(/<font[^>]*color=(\")?#E10602(\")?[^>]*>/gi,'[font color="#E10602"]').replace(/<font[^>]*color=(\")?#333333(\")?[^>]*>/gi,'[font color="#333333"]').replace(/<font[^>]*>/gi,'[font color="#333333"]').replace(new RegExp('<span([^>]*class="?at"?[^>]*)>',"gi"),"[span$1]").replace(/<span[^>]*>/gi,'<span class="edit_font_normal">').replace(new RegExp("<(/?(?:"+this.editValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.editValidHTML.join("|")+"|img|span)[^\\]]*)\\]","gi"),"<$1>");if(!$.browser.mozilla){this.editor.editArea.innerHTML=this.editor.editArea.innerHTML.replace(/\r?\n/gi,"<br>")}this.editor.ensureCursor()},sendStatistics:function(m){if(m==1){Stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=urlimagerec&st_value=1");if(this.isFirstTimeImgRec){this.sendStatistics(3);this.isFirstTimeImgRec=false}}else{if(m==2){Stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=urlimagefail&st_value=1")}else{if(m==3){Stats.sendRequest("fr=tb0_forum&st_mod=editor&st_type=urlimageposts&st_value=1")}else{return}}}}};window.TED["EditorPlugins"]["InterestSmiley"]=b;function b(m,n,p){this.con=m;this.ele=n;m.addClass("clearfix");var o=m.find(".tb-editor-wrapper");o.css({border:"none","float":"left"});m.css({border:"1px solid #DFDFDF",backgroundColor:"#FAFAFA"});this.container=$('<div class="e_inter_wrapper"></div>');m.append(this.container);n.width(980);this.dataPostor=p;$("#editor").css("clear","both");setTimeout(function(){var r=$(".right_section"),q=$(".left_section"),t=r.height(),w=q.height();if(t>w){var s=$("#thread_theme_4"),x=$("#j_core_title_wrap"),v=$("#j_p_postlist");var u=t-x.height()-v.height();s.height(u)}},1000)}b.prototype={constructor:b,init:function(n){var o=$('<div class="e_inter_title">\u795e\u6765\u4e00\u53e5</div>');var p=$('<div class="e_inter_smile clearfix"></div>');this.container.append(o).append(p);var m=this;_.Module.use("common/component/InterestSmiley",[{container:p,dataPostor:m.dataPostor}],function(q){m.interestSmile=q;m.interestSmile.generic()})}};window.TED["EditorPlugins"]["SaveDraft"]=f;function f(n,p,o,m){this.isPb=!!m;this.key="d-"+n+"-"+p+"-"+o}f.prototype={saveInterval:5000,timer:null,savedHtml:null,maxNum:3,storageKey:"tb_editor_storage",init:function(n){if(!l.isSupport()){return}this.editor=n;this.initTip();this.get();var m=this;if(n.focused){this.save()}n.on("blur",function(){clearInterval(this.timer)},this);n.on("focus",function(){this.save()},this);n.on("gethtml",function(){clearInterval(this.timer);this.clearData()},this)},save:function(){var m=this;this.timer=setInterval(function(){if(m.savedHtml!==m.editor.editArea.innerHTML){m.set();m.savedHtml=m.editor.editArea.innerHTML}},this.saveInterval)},clearData:function(){var o=l.get(this.storageKey);if(o===null){return}o=o.split("_");for(var n=0,m=o.length;n<m;n++){if(o[n]===this.key){o.splice(n,1);if(o.length===0){l.remove(this.storageKey)}else{l.set(this.storageKey,o.join("_"))}l.remove(this.key);return}}},set:function(){var n=l.get(this.storageKey);if(n===null){l.set(this.storageKey,this.key);l.set(this.key,this.editor.editArea.innerHTML)}else{n=n.split("_");var m=this.isInArray(this.key,n);if(m===false){if(n.length>=this.maxNum){l.remove(n.shift())}n.push(this.key);l.set(this.storageKey,n.join("_"))}l.set(this.key,this.editor.editArea.innerHTML)}if(this.tip){this.tip.onSave(new Date().getTime())}},get:function(){var m=l.get(this.key);if(m===null){return}$("#postorTip").remove();this.editor.setHtml(m);if(this.tip){this.tip.show()}},isInArray:function(o,p){for(var n=0,m=p.length;n<m;n++){if(p[n]===o){return n}}return false},initTip:function(){this.tip=new g(this,!this.isPb)}};function g(m,n){this.storage=m;this.needBlink=n===undefined?true:n;this.holder=document.createElement("div");this.holder.innerHTML="\u4f60\u4e0a\u6b21\u672a\u53d1\u8868\u7684\u5185\u5bb9\u5df2\u81ea\u52a8\u6062\u590d";this.holder.className="storageTip";this.holder.style.display="none";this.storage.editor.wrapper.appendChild(this.holder)}g.prototype={holder:null,setDateCount:0,needBlink:true,show:function(){if(this.storage.editor.isEmpty()){return}$(this.holder).fadeIn()},onSave:function(m){if(this.storage.editor.isEmpty()){$(this.holder).fadeOut();return}else{this.holder.style.display="block"}this.setDate(m)},setDate:function(m){this.holder.innerHTML="\u4f60\u6b63\u5728\u8f93\u5165\u7684\u5185\u5bb9\u5df2\u81ea\u52a8\u4fdd\u5b58,"+new Date(m).toLocaleTimeString();if(!this.needBlink){return}if(this.setDateCount%5===0){$(this.holder).css("backgroundColor","yellow").animate({backgroundColor:"#efefef"},500,function(){this.style.backgroundColor=""})}this.setDateCount++}};window.TED["EditorPlugins"]["FontEditPlugin"]=k;function k(m){this.c_sign_num=m;this.power=this._getPower()}k.prototype={init:function(o){var v=this,n=v.power;if(n=="none"){return}this.editorRef=o;o.toolbar.holder.innerHTML+='<span class="font_strong" unselectable="on" data-cmd="fontStrong"></span><span class="font_color '+(n=="bold"?"font_color_disable":"")+'" unselectable="on" data-cmd="fontColor"></span>';var s=$(o.wrapper);var q={content:"\u4fdd\u6301\u8fde\u7eed\u7b7e\u523010\u5929\u53ca\u4ee5\u4e0a\uff0c\u9009\u4e2d\u6587\u5b57\u70b9\u51fb\u52a0\u7c97",arrow_dir:"up",bubble_css:{top:-45,right:-20,width:180},arrow_pos:{left:30},attr:" id='tb_postor_b_tip' ",wrap:s};var t=new UiBubbleTipBase(q),r,m;t.j_bubble.find(".j_ui_triangle").hide();s.find(".font_strong").hover(function(){r=setTimeout(function(){t.showBubble()},1000)},function(){clearTimeout(r);t.hideBubble()});var p={content:"\u4fdd\u6301\u8fde\u7eed\u7b7e\u523020\u5929\u53ca\u4ee5\u4e0a\uff0c\u9009\u4e2d\u6587\u5b57\u70b9\u51fb\u6807\u7ea2",arrow_dir:"up",bubble_css:{top:-45,right:-20,width:180},arrow_pos:{left:30},attr:" id='tb_postor_c_tip' ",wrap:s};var u=new UiBubbleTipBase(p);u.j_bubble.find(".j_ui_triangle").hide();s.find(".font_color").hover(function(){m=setTimeout(function(){u.showBubble()},1000)},function(){clearTimeout(m);u.hideBubble()});if(n=="bold"){$(o.container).find(".font_strong").mousedown(function(w){document.execCommand("bold",false,"");$.stats.sendRequest("fr=tb0_forum&st_mod=postor&st_type=sign&st_value=bold");w.preventDefault()})}if(n=="all"){$(o.container).find(".font_color ").mousedown(function(y){var w=document.queryCommandValue("forecolor")?document.queryCommandValue("forecolor").toString():"";var x=$.trim(w);if(x=="#E10602"||x=="132833"||x=="rgb(225, 6, 2)"){document.execCommand("forecolor",false,"#333333")}else{document.execCommand("forecolor",false,"#E10602")}$.stats.sendRequest("fr=tb0_forum&st_mod=postor&st_type=sign&st_value=color");y.preventDefault()});$(o.container).find(".font_strong").mousedown(function(w){document.execCommand("bold",false,"");$.stats.sendRequest("fr=tb0_forum&st_mod=postor&st_type=sign&st_value=bold");w.preventDefault()})}},_getPower:function(){var m=this.c_sign_num;if(m<4){return"none"}else{if(m<10){return"show"}else{if(m<20){return"bold"}else{return"all"}}}}};window.TED["EditorPlugins"]["IdiskPlugin"]=h;function h(m,o,p,n){this.power=m;this.fid=o;this.max_length=p;this.max_size=n;this.remainder_lenght=p;this.capacity=0}h.prototype={buttonId:"idisk_btn",flashCntClassName:"idisk_flash_cnt",flashInited:false,isOtherOpend:false,init:function(n){this.editorRef=n;var m=this;this.overlay=new c(n.wrapper,n);this.overlay.on("close",function(){n.focus()});n.overlay.bind("open",function(){if(this.overlay.isOpen){this.overlay.close()}},this);this.overlay.on("open",function(){if(this.editorRef.overlay.isOpen){this.editorRef.overlay.close()}},this);n.toolbar.holder.innerHTML+='<label></label><span class="idisk" data-cmd="idisk"></span>';n.toolbarcmd_idisk=function(o){if(!m.power){return[false]}m.overlay.toggle();if(!m.flashInited){$.getJSON("http://pcs.baidu.com/rest/2.0/pcs/quota?app_id=419237&method=info&callback=?",function(p){if(p.error_code){$("#idisk_btn").next().html("\u8fde\u63a5\u5931\u8d25")}else{m.capacity=p.quota-p.used;$("#idisk_btn").show().next().hide();$.JsLoadManager.use(n.config.rootPath+"editor_dialog/idisk/idisk.js",function(){m.initFlash();m.flashInited=true})}})}return[false]};n.toolbar_hovercmd_idisk=function(o){if(!m.power){var p=$(".idisk").offset().left-$(".tb-editor-toolbar").offset().left-140;this.hoveroverlay.open(p+"px","43px","290px","55px","160px","http://tieba.baidu.com/tb/editor/v2/idisk/noright.html?t=201211201108",o)}return[false]};n.toolbar_hoverendcmd_idisk=function(o){if(!m.power){this.hoveroverlay.close()}return[false]}},initFlash:function(){var m=this;var n=this.overlay.uploadBtn;var o=$(n).position();this.$flashCnt=$("<div>").css({left:o.left+"px",top:o.top+"px",position:"absolute"}).appendTo(n.offsetParent);this.fileUploader=new FileUploader({width:n.offsetWidth,height:n.offsetHeight,container:this.$flashCnt[0],UIContainer:this.editorRef.editAreaWrapper,url:this.editorRef.config.rootPath+"editor_dialog/idisk/FileLoaderPlus.swf?_t=201211292"},{max_length:this.max_length,forum_id:this.fid,upload_size_limit:this.max_size,storage_capacity:this.capacity,upload_url:"http://pcs.baidu.com/rest/2.0/pcs/file?method=upload&dir=%2fapps%2ftieba&ondup=newcopy&app_id=419237&BDUSS="+$.cookie("BDUSS")});this.fileUploader.on("file_added",function(){if(this.overlay.isOpen){this.overlay.close()}if(m.remainder_lenght>0){m.remainder_lenght--;$("#attachmentNumberCount").text(m.remainder_lenght)}},this);this.fileUploader.on("remove_file",function(p){if(m.remainder_lenght<m.max_length){m.remainder_lenght++;$("#attachmentNumberCount").text(m.remainder_lenght)}this.editorRef.fireEvent("idisk_remove_file",null,[p])},this);this.fileUploader.on("upload_complete",function(p){this.editorRef.fireEvent("idisk_upload_complete",null,[p])},this);this.fileUploader.on("uploading_file_start",function(p){this.editorRef.fireEvent("idisk_uploading_start")},this);this.fileUploader.on("uploading_file_stop",function(p){this.editorRef.fireEvent("idisk_uploading_stop")},this)}};function c(m,o){c.superclass.call(this);var n=this;this.editorRef=o;this.max_size=this.byte2str(option_editor.upload_max_size);this.max_length=option_editor.upload_max_length;this.$holder=$("<div>").attr("class",this.holderClass).css("left","-1000px").html('<div class="idisk_btn_container"><button id="'+this.uploadBtnId+'" style="display: none;">\u4e0a\u4f20\u6587\u4ef6</button><span>\u6b63\u5728\u8fde\u63a5\u767e\u5ea6\u4e91\uff0c\u8bf7\u7a0d\u5019...</span></div>\u8fd8\u80fd\u4e0a\u4f20<em id="attachmentNumberCount">'+this.max_length+"</em>\u4e2a\u9644\u4ef6\uff0c\u6bcf\u4e2a\u9644\u4ef6\u5c0f\u4e8e<em>"+this.max_size+'</em><br/>\u9644\u4ef6\u5c06\u540c\u6b65\u5230\u767e\u5ea6\u4e91\u7f51\u76d8\uff0c\u60a8\u7684\u5269\u4f59\u7a7a\u95f4\uff1a<em id="idisk_unused"></em> <a href="http://pan.baidu.com/" target="_blank">\u6574\u7406\u7f51\u76d8</a>').append('<div class="close"></div>').find(".close").click(function(){n.onClose()}).end().append('<div class="arrow"></div>').appendTo(m);this.uploadBtn=this.$holder.find("button")[0]}j(c,d,{holderClass:"tb-editor-overlay idisk_holder",uploadBtnId:"idisk_btn",isOpen:false,onClose:function(){this.close()},close:function(){this.$holder.css("left","-1000px");this.isOpen=false;this.fireEvent("close")},open:function(){var n=this;$.getJSON("http://pcs.baidu.com/rest/2.0/pcs/quota?app_id=419237&method=info&callback=?",function(q){if(q.error_code){$("#idisk_unused").text("\u8bfb\u53d6\u51fa\u9519")}else{$("#idisk_unused").text(n.byte2str(q.quota-q.used))}});if(TED.Editor.Status.isPicassoOpen===true){var p=this;var m=$.dialog.confirm('<div id="maincontent" style="position:absolute;"><img style="margin:10px 10px 10px 10px;width:68px;height:68px;" src="http://static.tieba.baidu.com/tb/editor/v2/picasso/alarm.gif" /><div id="tipscontent" style="position:absolute;left:100px;top:15px;width:270px;font-size:14px;font-family:\u5b8b\u4f53" ><b>\u60a8\u6b63\u5728\u7f16\u8f91\u6d82\u9e26\uff0c\u73b0\u5728\u9000\u51fa\u5c06\u4e0d\u4f1a\u4fdd\u5b58\uff0c\u60a8\u786e\u5b9a\u8981\u9000\u51fa\uff1f</b></div></div>',{title:"\u6d82\u9e26\u7f16\u8f91\u5668",acceptValue:"\u786e\u5b9a",cancelValue:"\u53d6\u6d88"});m.width(420);m.height(90);m.bind("onaccept",function(){TED.Editor.Status.isPicassoOpen=false;p.editorRef.overlay.close(true);p.$holder.css("visibility","visible");p.isOpen=true;p.fireEvent("open")})}else{var o=$(".idisk").offset().left-$(".tb-editor-toolbar").offset().left-345;this.$holder.css("left",o+"px");this.isOpen=true;this.fireEvent("open")}},toggle:function(){if(this.isOpen){this.close()}else{this.open()}},byte2str:function(m){m=parseInt(m);if(m<1024){return m+"byte"}var n=(m/1024).toFixed(2);if(n<1024){return n+"KB"}var o=(n/1024).toFixed(2);if(o<1024){return o+"MB"}return(o/1024).toFixed(2)+"GB"}})})();;(function(){var g=TED.EditorCore,i=TED.extend,c=TED.EventDispatcher,a=TED.Overlay,d=TED.HoverOverlay,j=TED.Event,k=TED.EditorInstanceManager,h=TED.augmentObject,b=TED.SimpleAjax;window.TED["Editor"]=f;function f(l){if(this.ua.mobile||this.isUCWeb()||this.isAndroidOS()){return new TED.TextInput(l)}f.superclass.call(this,l)}f.defaultConfig={height:"200px",width:"655px",maxHeight:null,autoFocus:false,autoEnable:true,autoHeight:true,wrapperClassName:"tb-editor-wrapper",editAreaClassName:"tb-editor-editarea",editAreaWrapperClassName:"tb-editor-editarea-wrapper",disabledEditAreaClassName:"tb-editor-editarea tb-editor-editarea-disabled",disabledWrapperClassName:"tb-editor-wrapper tb-editor-wrapper-disabled",imageClassName:"BDE_Image",smileyClassName:"BDE_Smiley",musicClassName:"BDE_Music",flashClassName:"BDE_Flash",flashNumLimit:10,rootPath:"/tb/static-common/",enableRefer:true,emptyClassName:"BDE_Empty",didaDelay:300,imageWidthLimit:570};f.Status={isPicassoOpen:false};i(f,g,{getHtml:function(){return this.img2embed(f.superclass.prototype.getHtml.call(this,this.editArea.innerHTML))},hasPicassoAuth:function(){if(this.config.picasso&&!this.config.no_post_pic){return true}return false},enable:function(){this.toolbar.enable();f.superclass.prototype.enable.call(this)},disable:function(){this.toolbar.disable();if(this.overlay.isOpen){this.overlay.close()}f.superclass.prototype.disable.call(this)},getFlashNum:function(){return this.getTagNum("img","BDE_Flash")},getMusicNum:function(){return this.getTagNum("img","BDE_Music")},getConfig:function(){return this.config},overlay:null,toolbar:null,hoveroverlay:null,initComponents:function(m){f.superclass.prototype.initComponents.call(this,m);var l=this;_.Module.use("common/component/EditorLayer",[{container:$(this.wrapper)}],function(n){l.overlay=n;window.PAGEEDITORLAYER=l.overlay;l.overlay.bind("close",function(){l.focus()},l);l.hoveroverlay=new d(l.wrapper)});l.toolbar=new e(l.wrapper,l.hasPicassoAuth());setTimeout(function(){if(l.getConfig().can_local_upload==1){l.initBubble()}},1000)},initBubble:function(){if($.cookie("ed_clu")==1){return false}var m={content:"\u89c6\u9891\u652f\u6301\u672c\u5730\u4e0a\u4f20\u5566~",arrow_dir:"up",bubble_css:{top:30,left:46,color:"black",width:130},arrow_pos:{left:70},wrap:$(".tb-editor-toolbar"),closeBtn:true,level:1,arrowReq:true};var l=new UiBubbleTipBase(m);l.showBubble();l.bind("onclose",function(){$.cookie("ed_clu",1,{expires:365})},true)},attachEvents:function(){f.superclass.prototype.attachEvents.call(this);this.toolbar.on("command",this.toolbarcmd,this);this.toolbar.on("hovercommand",this.toolbarhovercmd,this);this.toolbar.on("hoverendcommand",this.toolbarhoverendcmd,this)},detachEvents:function(){f.superclass.prototype.detachEvents.call(this);this.toolbar.remove("command",this.toolbarCommand);this.toolbar.remove("hovercommand",function(){});this.toolbar.remove("hoverendcommand",function(){})},toolbarcmd:function(m,l){if(m&&typeof this["toolbarcmd_"+m]==="function"){this["toolbarcmd_"+m](l)}},toolbarhovercmd:function(m,l){if(m&&typeof this["toolbar_hovercmd_"+m]==="function"){this["toolbar_hovercmd_"+m](l)}},toolbarhoverendcmd:function(m,l){if(m&&typeof this["toolbar_hoverendcmd_"+m]==="function"){this["toolbar_hoverendcmd_"+m](l)}},toolbarcmd_smiley:function(n){var m={layerPos:{left:0,top:-315},layerSize:{height:315,width:552},arrowPos:{left:263,bottom:-7},content:{height:313},arrowType:"down",layerType:""};var l=this;if(this.smileLayer){this.overlay.toggle(m,this.smileLayer,this,n)}else{_.Module.use("common/component/EditorSmiley",[],function(o){l.smileLayer=o;l.overlay.toggle(m,l.smileLayer,l,n)})}$.stats.hive("toolbar_similey");return[false]},toolbarcmd_image:function(n){var m={layerPos:{left:0,top:-111},layerSize:{height:111,width:314},arrowPos:{left:30,bottom:-7},content:{height:108},arrowType:"white_down",layerType:""};var l=this;if(this.imageLayer){this.overlay.toggle(m,this.imageLayer,this,n)}else{_.Module.use("common/component/EditorPic",[],function(o){l.imageLayer=o;l.overlay.toggle(m,l.imageLayer,l,n)})}$.stats.hive("toolbar_images");return[false]},toolbarcmd_music:function(n){var m={layerPos:{left:3,top:-122},layerSize:{height:122,width:500},arrowPos:{left:180,bottom:-7},content:{height:119},arrowType:"white_down",layerType:""};var l=this;if(this.musicLayer){this.overlay.toggle(m,this.musicLayer,this,n)}else{_.Module.use("common/component/EditorMusic",[],function(o){l.musicLayer=o;l.overlay.toggle(m,l.musicLayer,l,n)})}$.stats.hive("toolbar_music");return[false]},toolbarcmd_flash:function(n){var m={layerPos:{left:3,top:-91},layerSize:{height:91,width:414},arrowPos:{left:94,bottom:-7},content:{height:88},arrowType:"white_down",layerType:""};var l=this;if(this.videoLayer){this.overlay.toggle(m,this.videoLayer,this,n)}else{_.Module.use("common/component/EditorVideo",[],function(o){l.videoLayer=o;l.overlay.toggle(m,l.videoLayer,l,n)})}$.stats.hive("toolbar_video");return[false]},toolbarcmd_picasso:function(m){var l=this;if(this.hasPicassoAuth()){if(this.editorSketchpad){this.overlay.openPicasso(this.editorSketchpad,m,l)}else{_.Module.use("common/component/EditorSketchpad",[],function(n){l.editorSketchpad=n;l.overlay.openPicasso(l.editorSketchpad,m,l)})}}$.stats.hive("toolbar_picasso");return[false]},toolbarcmd_unabled_cut:function(n){var m={layerPos:{left:280,top:-50},layerSize:{height:50,width:320},arrowPos:{left:150,bottom:-7},content:{height:47},arrowType:"white_down",layerType:""};var l=this;this.overlay.toggle(m,'<p style="width:270px;margin-top:13px;margin-left:7px;font-family:\u5b8b\u4f53;font-size:12px ">\u7528\u8d34\u5427\u795e\u5668\uff0c\u622a\u56fe\u53d1\u8d34\u66f4\u65b9\u4fbf\u3002<a href="http://go.client.baidu.com/?linkid=114" onmousedown="$.stats.sendRequest("fr=tb0_postor&st_mod=postor&st_type=download&st_value=download");" id="download">\u5feb\u53bb\u8bd5\u8bd5\u8d34\u5427\u795e\u5668</a></p>',this,n);$.stats.sendRequest("fr=tb0_postor&st_mod=postor&st_type=unablecut&st_value=unablecut");return[false]},toolbarcmd_dis_picasso:function(n){var m={layerPos:{left:234,top:-63},layerSize:{height:63,width:286},arrowPos:{left:116,bottom:-7},content:{height:60},arrowType:"white_down",layerType:""};var l=this;if(this.config.no_post_pic){this.overlay.toggle(m,'<div style="padding:13px 13px 0px 13px;font-family:\u5b8b\u4f53;font-size:12px ">\u7531\u4e8e\u672c\u5427\u8bbe\u7f6e\uff0c\u6682\u65f6\u65e0\u6cd5\u4f7f\u7528\u6d82\u9e26\u529f\u80fd\u3002</div>',this,n)}else{this.overlay.toggle(m,'<div style="padding:13px 13px 0px 13px;font-family:\u5b8b\u4f53;font-size:12px ">\u54a6\uff0c\u6b64\u529f\u80fd\u9700\u8981\u62e5\u6709\u672c\u54276\u7ea7\u5934\u8854\u624d\u80fd\u4f7f\u7528\uff0c\u518d\u52aa\u529b\u4e00\u4e0b\uff01&nbsp;<a target="_blank" href="http://tieba.baidu.com/f/like/level?kw=%CC%F9%B0%C9%B5%C8%BC%B6#level_main">\u67e5\u770b\u5347\u7ea7\u79d8\u7c4d</a></div>',this,n)}return[false]},jumpTo_picasso:function(){if(this.hasPicassoAuth()){this.overlay.open("105px","43px","500px","370px","244px",this.config.rootPath+"editor_dialog/picasso/picasso.html?id="+this.id);f.Status.isPicassoOpen=true}return[false]},toolbarcmd_cut_screen:function(n){var o=this,m=$.ajax({url:"http://tieba.baidu.com/dc/common/imgtbs",dataType:"json"}),l=window.external.GetNextReqID("id");$.stats.hive("toolbar_cutscreen");window.cutScreen=function(p,q){if(p!=l||!q||!(q=$.parseJSON(q))||q.result==="error"||!q.content||!q.content.url){return}o.execCommand("inserthtml",'<img unselectable="on" class="BDE_Image" onload="TED.EditorCore.ResizeImage(this);"  src="'+q.content.url+'">');o.execCommand("insertlinebreak")};m.done(function(p){if(p.no==0){try{window.external.StartRequest(l,"bdbrowser.extension.tiebacmdToLibEx","cutScreen",'{"cmd":"PageSnapStart","fid":"'+o.config.forum_id+'","tbs":"'+p.data.tbs+'"}',window,"")}catch(q){}}});$.stats.sendRequest("fr=tb0_postor&st_mod=postor&st_type=cutscreen&st_value=cut_screen");return[false]},toolbar_hovercmd_smiley:function(l){return[false]},toolbar_hoverendcmd_smiley:function(l){return[false]},toolbar_hovercmd_image:function(l){return[false]},toolbar_hoverendcmd_image:function(l){return[false]},toolbar_hovercmd_music:function(l){return[false]},toolbar_hoverendcmd_music:function(l){return[false]},toolbar_hovercmd_flash:function(l){return[false]},toolbar_hoverendcmd_flash:function(l){return[false]},toolbar_hovercmd_disableimage:function(l){this.hoveroverlay.open("0px","43px","268px","40px","13px",this.config.rootPath+"editor_dialog/image/image_noright.html?t=201210161100",l)},toolbar_hoverendcmd_disableimage:function(l){this.hoveroverlay.close()},toolbar_hovercmd_picasso:function(l){return[false]},toolbar_hoverendcmd_picasso:function(l){return[false]},toolbar_hovercmd_unabled_cut:function(l){return[false]},toolbar_hoverendcmd_unabled_cut:function(l){this.hoveroverlay.close();return[false]},getMusiNum:function(){var l=this.getTagNum("embed",this.config.musicClassName);if(!this.ua.ie){l+=this.getTagNum("img",this.config.musicClassName)}return l},getLocalFlashNum:function(){var l=$(this.editArea),m=0;l.find("."+this.config.flashClassName).each(function(){var n=$(this).attr("data-pkey");if(n!=null&&n!=""){if(n.substr(0,5)=="pkey_"){m++}}});return m},getFlashFileId:function(){var m=$(this.editArea),n=0,l="";m.find("."+this.config.flashClassName).each(function(){var p=$(this).attr("data-pkey");if(p!=null&&p!=""){var o=p.split("_");if(o[0]=="pkey"){l=o[1]}}});return l},getFlashNum:function(){var l=this.getTagNum("embed",this.config.flashClassName);l+=this.getTagNum("img",this.config.flashClassName);return l},cmd_insertmusic:function(l){var m="";m='<img unselectable="on" class="BDE_Music" src="'+this.config.rootPath+'editor_img/music.png"';m+=' title="'+l+'"';m+=' width="400" height="95"';m+=' data-width="400" data-height="95">';this.execCommand("inserthtml",m);return[false]},cmd_insertflash:function(m,l,r,q,s,p){var o="";var t=450,n=500;if(m.toLowerCase().indexOf("baidu.com")>-1){n=480;t=410}else{if(m.toLowerCase().indexOf("player.video.qiyi.com")>-1){n=500;t=415}else{n=500;t=450}}o='<img unselectable="on" class="BDE_Flash" src="'+this.config.rootPath+'editor_img/flash.png"';if(l){o+=' data-video_url="'+l+'"'}if(p){o+=' data-html5_url="'+p+'"'}if(q){o+=' data-vsrc="'+l+'"';o+=' data-pkey="'+q+'"';if(s){o+=' data-vpic="'+s+'"'}else{o+=' data-vpic="null"'}}else{o+=' data-vsrc="null"';o+=' data-pkey="null"';o+=' data-vpic="null"'}if(r){o+=' video_mp4_url="'+r+'"'}o+=' title="'+m+'"';o+=' width="219" height="175"';o+=' data-width="'+n+'" data-height="'+t+'"/>';this.execCommand("inserthtml",o);this.execCommand("insertlinebreak");return[false]},img2embed:function(l){return l.replace(/<img[^>]*class="?(?:BDE_Flash|BDE_Music)[^>]*>/gi,function(x){var n=x.replace(/.* title\="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),o=x.replace(/.* data\-width\="?([^\s">]+).*/i,"$1"),w=x.replace(/.* data\-height\="?([^\s">]+).*/i,"$1"),u=x.replace(/.* class="?([^\s">]+).*/i,"$1"),m="",p="",r='<embed allowfullscreen="true" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" scale="noborder"'+(n.toLowerCase().indexOf("http://player.ku6.com")==0?' flashvars="adss=0"':" ")+'src="'+n+'"  class="'+u+'" width="'+o+'" height="'+w+'" ';if(u=="BDE_Flash"){m=x.replace(/.* data-video_url="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");p=x.match(/.* data-html5_url="?([^\s">]+).*/i);if(p){p=p[1].replace(/&amp;/gi,"&");r+=' vhsrc="'+p+'"'}var q=x.replace(/.* data-vsrc="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");var t=x.replace(/.* data-pkey="?([^\s">]+).*/i,"$1");var v=x.replace(/.* data-vpic="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");if(t!="null"&&t.length<40){r+=' vsrc="'+q+'"';if(v!="null"){r+=' vpic="'+v+'"'}r+=' pkey="'+t+'"'}}r+=" >";return r})},quoteContainer:null,quote:function(p,l,q){p=parseInt(p);if(p>1){if(this.quoteContainer===null){this.quoteContainer=document.createElement("div");this.quoteContainer.className="editor-quote";this.wrapper.insertBefore(this.quoteContainer,this.editAreaWrapper)}var o=document.getElementById("post_content_"+l).innerHTML.replace(/<img[^>]*>/gi,"[\u56fe\u7247]").replace(/<embed[^>]*>/gi,"[\u89c6\u9891]").replace(/<br[^>]*>/gi," ").replace(/<a[^>]*>/gi,"").replace(/<\/a>/gi,"").subByte(270);this.quoteContainer.innerHTML='<blockquote class="quote_change"><fieldset><legend ><a href="javascript:void(0);" onmousedown="return false;" style="font-weight:bold;color:#989898; position:absolute;right:5px; top:12px;text-decoration:none;font-size:15px;line-height:15px;font-weight:bold;font-family:\u5fae\u8f6f\u96c5\u9ed1" onclick="TED.Editor.getInstanceById(\''+this.id+'\').unQuote();Stats.sendRequest(\'fr=tb0_forum&st_mod=pb&st_type=quote&st_value=delete\');" class="close" title="\u5220\u9664\u5f15\u7528">\u2573</a>\u5f15\u7528&nbsp;'+q+'&nbsp;(<a href="#'+l+'" style="color:#989898;">'+p+'\u697c</a>)</legend><p style="margin-left: 5px;padding: 0 5px;width: 505px;" class="quote_content">'+o+"</p></fieldset></blockquote>";this.quoteContainer.style.display="block";this.fireEvent("quote",null,[l])}else{this.unQuote();var n="";if(l==="is_p_reply_first"){n="is_p_reply_first"}else{n="rp_reply"}Stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=quote&st_value="+n)}var m=this;setTimeout(function(){m.focus()},300)},unQuote:function(){if(this.quoteContainer){this.quoteContainer.style.display="none"}this.fireEvent("unquote")}});function e(l,m){e.superclass.call(this);this.hovertimer=null;this.hoverendtimer=null;this.container=l;this.enablepicasso=m;this.initialize()}i(e,c,{disabled:true,initialize:function(){this.holder=document.createElement("div");this.holder.className="tb-editor-toolbar tb-editor-toolbar-disabled";var m='<span class="image" data-cmd="image"></span><label></label><span class="flash" data-cmd="flash"></span><label></label><span class="music" data-cmd="music"></span><label></label><span class="smiley" data-cmd="smiley"></span><label></label>',l,n=this;if(this.enablepicasso){m+='<span class="picasso" data-cmd="picasso"></span>'}else{m+='<span class="picasso" data-cmd="dis_picasso"></span>'}try{l="baidubrowser.tieba"==window.external.GetVersion("version")?true:null}catch(o){l=null}if(l){m+='<label></label><span class="cut_screen" data-cmd="cut_screen">'}else{}this.holder.innerHTML=m;this.container.appendChild(this.holder);j.addEvent(this.holder,"click",function(q){if(n.disabled){return}var p=q.target||q.srcElement;if(p.tagName.toLowerCase()==="span"){n.fireEvent("command",null,[p.getAttribute("data-cmd"),p])}if(q.stopPropagation){q.stopPropagation()}else{q.cancelBubble=true}});j.addEvent(this.holder,"mouseover",function(q){if(n.disabled){return}var p=q.target||q.srcElement;if(p.tagName.toLowerCase()==="span"){if(n.hoverendtimer){clearTimeout(n.hoverendtimer)}n.hovertimer=setTimeout(function(){n.fireEvent("hovercommand",null,[p.getAttribute("data-cmd"),p])},800)}});j.addEvent(this.holder,"mouseout",function(q){if(n.disabled){return}if(n.hovertimer){clearTimeout(n.hovertimer)}var p=q.target||q.srcElement;if(p.tagName.toLowerCase()=="span"){n.hoverendtimer=setTimeout(function(){n.fireEvent("hoverendcommand",null,[p.getAttribute("data-cmd"),p])},400)}})},disable:function(){this.disabled=true;this.holder.className="tb-editor-toolbar tb-editor-toolbar-disalbed"},enable:function(){this.disabled=false;this.holder.className="tb-editor-toolbar"},disableInsertImage:function(){this.holder.firstChild.setAttribute("data-cmd","disableimage");this.holder.firstChild.className="image_disabled"},enableInsertImage:function(){this.holder.firstChild.setAttribute("data-cmd","image");this.holder.firstChild.className="image"}});h(f,k)})();;_.Module.define({path:"common/component/htmlx_img_editor",requires:["common/component/image_uploader"],sub:{initial:function(){this.options={width:650,height:460,asideWidth:165,barHeight:50,imgMaxWidth:1600};this.img=null;this._zoom=1;this._pluginList=[];this._imgList={};this._baseImg=null;this._sourceOptions=null;this._locked=false;this._buildUI();this._initCanvas();this._addEnterButton();this._bindEvent()},_buildUI:function(){this._container=$('<div class="xeditor_ctn"></div>');this.dialog=new $.dialog({title:"\u7f8e\u5316\u56fe\u7247",html:this._container[0],holderClassName:"xeditor_dialog",width:this.options.width,height:this.options.height,show:false,hideOnclose:true,fixed:false,draggable:false});this.dialog.showTitle=true;this._wraper=$('<div class="xeditor_wraper"></div>').appendTo(this._container);this.main=$('<div class="xeditor_main clearfix"></div>').appendTo(this._wraper);this.aside=$('<div class="xeditor_aside clearfix"></div>').appendTo(this._wraper);this.viewer=$('<div class="xeditor_viewer"></div>').appendTo(this.main);this._message=$('<span class="xeditor_message"><img src="/tb/static-common/img/editor/loading.gif" /><span></span></span>').appendTo(this.viewer);this._bottons=$('<div class="xeditor_btns"><a href="#" class="cancel" onclick="return false;">&nbsp</a><a href="#" class="ui_btn ui_btn_m j_btnOk" onclick="return false;"><span><em>\u786e\u8ba4</em></span></a><a href="#" class="restart" onclick="return false;">\u91cd\u65b0\u5f00\u59cb</a>').appendTo(this._container);var a='<dl class="xeditor_tools"><dt class="switch_title"><a class="selected j_switch">\u57fa\u672c\u64cd\u4f5c</a><a class="">\u7f8e\u5316</a></dt><dd class="switch_content"><ul class="xeditor_handle selected"><li class="xeditor_clip">\u88c1\u526a</li><li class="xeditor_rl">\u5de6\u65cb\u8f6c</li><li class="xeditor_rr">\u53f3\u65cb\u8f6c</li></ul><ul class="xeditor_filter"></ul></dd></dl>';this.aside.html(a);this._imgWrapperClass="j_htmlxImageWrapper";this._imgWrapper=$('<div class="'+this._imgWrapperClass+'" contenteditable="false" style="position: relative;display:inline-block;"></div>');this._imgMask=$("<div style=\"position:absolute;border: 1px solid gray;display: table-cell;text-align: center;vertical-align: middle;background-color: rgba(0,0,0,.3);filter:progid:DXImageTransform.Microsoft.gradient(enabled='true',startColorstr='#4C000000', endColorstr='#4C000000');\"></div>").appendTo(this._imgWrapper);this._cancelButton=this._bottons.find(".cancel");this._restartButton=this._bottons.find(".restart");this._submitButton=this._bottons.find(".j_btnOk");this._setContainerHeight()},_setContainerHeight:function(){var c=this.options.height-this.options.barHeight;this.aside.css({width:this.options.asideWidth,height:c});this.main.css({width:this.options.width-this.aside.outerWidth()-parseInt(this.main.css("padding-left"))*2-2,height:c-parseInt(this.main.css("padding-left"))*2});var a=this.aside.find(".switch_title"),b=this.aside.find(".switch_content");b.css({height:c-35})},_initCanvas:function(){this.canvas=document.createElement("canvas");this._canvasStack=[];this.preCanvas=document.createElement("canvas");this.viewer.append(this.preCanvas);this.context=this.canvas.getContext("2d");this.preContext=this.preCanvas.getContext("2d")},addImage:function(b,c,a){this._imgList[b]={sourceData:c,options:a||{}}},_addEnterButton:function(){var a=this;this._enterButton=$('<a contenteditable="false" href="#" class="xeditor_enter_btn1" onclick="return false;"></a>').appendTo(this._imgWrapper);this._enterButton.on("click",function(b){if(!a.pluginLoded){a.addPlugin("clip","htmlx_img_clip");a.addPlugin("rotate","htmlx_img_rotate");a.addPlugin("filter","htmlx_img_filter");a.pluginLoded=true}a.dialog.show();a.dialog.setPosition();a.restart();a.dialog.modal.element.height(a.dialog.modal.height());$.stats.sendRequest("fr=tb0_forum&st_mod=htmlximgeditor&st_value=dialogshow")})},_initImage:function(){var b=this._baseImg;if(b.width>this.options.imgMaxWidth){var e=b.height/b.width;b.width=this.options.imgMaxWidth;b.height=this.options.imgMaxWidth*e}var d=b.width,a=b.height,c=this.canvas;c.width=d;c.height=a;this.context.drawImage(b,0,0,d,a);this.pushOperation("init",this.canvas)},pushOperation:function(a,c){var b=c.cloneNode();b.getContext("2d").drawImage(c,0,0);this._canvasStack.push({operation:a,canvas:b});this.trigger("change",{operation:a})},getLastOperation:function(a,d){for(var c=this._canvasStack.length-1;c>=0;c--){var b=this._canvasStack[c];if((b.operation!=a)==d){return b}}return this._canvasStack[0]},setCanvas:function(b){var a=b.cloneNode();a.getContext("2d").drawImage(b,0,0);this.canvas=null;this.context=null;this.canvas=a;this.context=a.getContext("2d")},initPreviewer:function(){var d=this.canvas,e=d.width,b=d.height,g=this.viewer.width(),a=this.viewer.height(),c=this.preCanvas;var f=e/b;if(e>g&&f>=1){c.width=g;c.height=c.width/f}else{if(b>a&&f<1){c.height=a;c.width=c.height*f}else{c.width=d.width;c.height=d.height}}this._zoom=e/c.width;this.preContext.drawImage(d,0,0,c.width,c.height);this.setImagePosition()},setImagePosition:function(){var c=this.viewer.width(),a=this.viewer.height(),b=this.preCanvas;$(this.preCanvas).css({left:(c-b.width)/2,top:(a-b.height)/2})},_bindEvent:function(){var b=this,c=this.aside.find(".switch_title a"),d=this.aside.find(".switch_content"),a=this.aside.find(".xeditor_filter");c.each(function(e){$(this).on("click",function(f){c.removeClass("selected");$(this).addClass("selected");$(d.find("ul").hide().get(e)).show()})});this._imgWrapper.on("mouseleave",function(){b.hideButton();if(b.richEditor){b.richEditor.editorPlugins.draft.save()}});this._cancelButton.bind("click",function(){b.dialog.hide()});this._restartButton.bind("click",function(){if(confirm("\u91cd\u65b0\u5f00\u59cb\u5c06\u64a4\u9500\u6240\u6709\u6b65\u9aa4\u5e76\u6062\u590d\u5230\u539f\u56fe\uff0c\u60a8\u786e\u5b9a\u5417\uff1f")){b.restart();$.stats.sendRequest("st_mod=htmlximgeditor&fr=tb0_forum&st_value=restart")}});this._submitButton.bind("click",function(){if(!b.isLocked()){b._submit()}});a.bind("mousewheel",function(g){var f=g.originalEvent;if(f.wheelDelta){f.preventDefault();d[0].scrollTop-=f.wheelDelta}})},addDelegateContainer:function(b,a){var c=this;this._imgContainer=$(b);this._imgSelector=a;this.clearAllButton();$(b).delegate(a,"mouseover",function(d){if(c.richEditor){clearInterval(c.richEditor.editorPlugins.draft.timer)}c.detectImage(this)}).delegate(a,"mouseout",function(d){}).css("position","relative")},setRichEditor:function(b){this.richEditor=b;var a=this;$(b.editArea).on("scroll",function(c){if(a.isButtonVisible()){a.setButtonPosition()}})},detectImage:function(c){var f=c.src;if(!this._imgList[f]){return}if(c.width<120||c.height<120){return}if(this.img===c){this.showButton();return}this.img=c;var e=this._imgList[f],d=e.sourceData,b=this;this._sourceOptions=e.options;if(d.size){var a=new FileReader();a.onload=function(h){a.onload=null;_dataURI=h.target.result;var g=new Image();g.src=_dataURI;g.onload=function(){b._baseImg=g;b.showButton();delete g}};a.readAsDataURL(d)}else{if(typeof d=="string"){var c=new Image();c.src=d;c.onload=function(){b._baseImg=c;b.showButton();delete c}}else{if(/canvas/i.test(d.toString())){this._baseImg=d;this.showButton()}}}},showButton:function(){if(this.isButtonVisible()){this.setButtonPosition();return false}this._imgWrapper.find("img").remove();var a=$(this.img);a.before(this._imgWrapper);this._imgWrapper.append(a).css({width:a.outerWidth(true),height:a.outerHeight(true)});var c={left:this.img.offsetLeft,top:this.img.offsetTop},b={width:a.width(),height:a.height()};this._imgMask.css({top:c.top-1,left:c.left-1,width:b.width,height:b.height});this.setButtonPosition()},setButtonPosition:function(){var e=$(this.img);var b=this._enterButton,d=this._imgWrapper.position(),h={width:e.width(),height:e.height()},g={width:b.width(),height:b.height()},c;var f=this.richEditor.editArea,j=d.top<0?-d.top:0,i=f.clientHeight,a;if(d.top<0){a=h.height-j;a=Math.min(a,i)}else{a=i-d.top;a=Math.min(a,h.height)}c={left:h.width/2-g.width/2,top:j+a/2-g.height/2};this._enterButton.css({display:"block",top:c.top,left:c.left})},isButtonVisible:function(){return jQuery.contains(this._imgWrapper[0],this.img)},hideButton:function(){if(!this.img){return}var a=this;this.img.parentNode.removeChild(this.img);this._imgWrapper.after(this.img);this._imgWrapper[0].parentNode.removeChild(this._imgWrapper[0])},clearAllButton:function(){var a=this._imgSelector;this._imgContainer.find("."+this._imgWrapperClass).each(function(c,d){var e=$(d);if(e.find(a).length){var b=e.find(a)[0];b.parentNode.removeChild(b);e.after(b)}d.parentNode.removeChild(d)})},restart:function(){this._initImage();this.initPreviewer();for(var a in this._pluginList){this._pluginList[a].trigger("restart")}this.releaseLock();this.hideMessage()},clip:function(e){var a=Math.floor(e.x*this._zoom),f=Math.round(e.y*this._zoom),b=Math.round(e.width*this._zoom),d=Math.round(e.height*this._zoom);a=a>0?a:0;f=f>0?f:0;if(a+b>this.canvas.width){b-=a+b-this.canvas.width}if(f+d>this.canvas.height){d-=f+d-this.canvas.height}var c={x:a,y:f,width:b,height:d};this._clipCanvas(this.canvas,c);this.pushOperation("clip",this.canvas);this.initPreviewer();$.stats.sendRequest("fr=tb0_forum&st_mod=htmlximgeditor&st_value=clip")},_clipCanvas:function(b,c){var a=b.getContext("2d"),d=a.getImageData(c.x,c.y,c.width,c.height);a.clearRect(0,0,b.width,b.height);b.width=c.width;b.height=c.height;a.putImageData(d,0,0)},_submit:function(){this.showMessage("\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u540e...");this.addLock("submit");var a=$.ajax({url:"http://tieba.baidu.com/dc/common/imgtbs",dataType:"json"});self=this;a.done(function(d){if(Number(d.no)===0){var b="http://upload.tieba.baidu.com/upload/pic?tbs="+d.data.tbs+(self._sourceOptions.isWater?"&is_wm=1":""),e=self.use("common/component/image_uploader",b),c=self.canvas.cloneNode();c.getContext("2d").drawImage(self.canvas,0,0);e.bind("success",function(g,h,f){self._updateImage(f,c)});e.upload(self.canvas)}else{self.richEditor.setStatsRequest("tbsgeterror")}}).fail(function(){self.richEditor.setStatsRequest("tbsgeterror")});$.stats.sendRequest("fr=tb0_forum&st_mod=htmlximgeditor&st_value=imgupload")},_updateImage:function(c,e){var f=c.info.pic_id_encode,g=c.info.fullpic_width,b=c.info.fullpic_height,h=c.info.pic_water,d=this.img,a=TED.EditorCore.defaultConfig.imageWidthLimit;if(!this._sourceOptions.isWater&&!f){this.showMessage("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25",true,2000);this.canvas=e;this.releaseLock();return false}d.src="";d.width=g;d.height=b;if(g>a){d.width=a;$(d).removeAttr("height");$(d).attr("changedsize",true)}else{$(d).removeAttr("changedsize")}if(this._sourceOptions.isWater&&h){d.src=h}else{d.src="http://imgsrc.baidu.com/forum/pic/item/"+f+".jpg"}this.dialog.hide();this.img=null;this.addImage(d.src,e,{isWater:this._sourceOptions.isWater})},addPlugin:function(b,c){var a=this,d;_.Module.use("common/component/"+c,[this],function(e){a._pluginList[b]=e;e.trigger("add_to_editor_success")})},addLock:function(a){this._locked=true;this._locker=a},releaseLock:function(){this._locked=false},isLocked:function(){return this._locked},showMessage:function(e,c,f){this._message.find("span").html(e);this._message.find("img")[c?"hide":"show"]();var g=this.viewer,a=this._message.outerWidth(),d=this._message.outerHeight();this._message.css({left:(g.width()-a)/2,top:(g.height()-d)/2}).show();if(f){var b=this;setTimeout(function(){b.hideMessage()},f)}},hideMessage:function(){this._message.hide()}}});var FORUM_POST_PREFIX="/f/commit/";var FORUM_POST_URL={threadAdd:FORUM_POST_PREFIX+"thread/add",postAdd:FORUM_POST_PREFIX+"post/add",threadVoteAdd:FORUM_POST_PREFIX+"vote/add ",forumCreate:FORUM_POST_PREFIX+"forum/create",threadDelete:FORUM_POST_PREFIX+"thread/delete",postDelete:FORUM_POST_PREFIX+"post/delete",goodAdd:FORUM_POST_PREFIX+"thread/good/add",goodCancel:FORUM_POST_PREFIX+"thread/good/cancel",threadTopAdd:FORUM_POST_PREFIX+"thread/top/add",threadTopCancel:FORUM_POST_PREFIX+"thread/top/cancel",threadTopicAdd:"/zhibo/commit/add",threadTopicCancel:"/zhibo/commit/set",get_tbs:"/dc/common/tbs"};var FORUM_ERROR_INFO={24:"\u767b\u5f55\u9519\u8bef\uff0c\u53ef\u80fd\u8f93\u5165\u7684\u7528\u6237\u540d\u548c\u53e3\u4ee4\u4e0d\u6b63\u786e\uff0c\u8bf7\u5355\u51fb\u786e\u5b9a\u91cd\u8bd5",102:"\u6ce8\u518c\u7528\u6237email\u975e\u6cd5",103:"\u6ce8\u518c\u7528\u6237\u4e2a\u4eba\u4fe1\u606f\u975e\u6cd5",107:"\u7528\u6237\u540d\u6216\u81ea\u6211\u4ecb\u7ecd\u7684\u6587\u5b57\u4e2d\u542b\u6709\u4e00\u4e9b\u4e0d\u6070\u5f53\u7684\u8bcd\u6c47\uff0c\u8bf7\u60a8\u91cd\u65b0\u63d0\u4ea4\u6ce8\u518c\u4fe1\u606f",108:"\u7528\u6237\u540d\u4e3a\u7a7a",266:"\u6dfb\u52a0\u597d\u53cb\u91cd\u590d",205:"\u5bf9\u4e0d\u8d77\uff0c\u60a8\u6ca1\u6709\u6b64\u4fee\u6539\u6743\u9650\uff0c\u8bf7\u5230\u60a8\u6ce8\u518c\u7684\u7cfb\u7edf\u4e2d\u4fee\u6539\u4fe1\u606f",305:"\u6dfb\u52a0\u8bcd\u8bed\u5230\u8fbe\u6700\u5927\u503c",306:"\u6dfb\u52a0\u8bcd\u8bed\u5230\u8fbe\u6700\u5927\u503c",309:"\u6dfb\u52a0\u8bcd\u8bed\u5230\u8fbe\u6700\u5927\u503c",260:"\u8ba8\u8bba\u533a\u5df2\u6ee1\u4e09\u4e2a\u5427\u4e3b",261:"\u8be5\u7528\u6237\u5df2\u7ecf\u662f\u8be5\u5427\u7684\u5427\u4e3b",262:"\u8be5\u7528\u6237\u5df2\u7ecf\u662f\u4e09\u4e2a\u8d34\u5427\u7684\u5427\u4e3b",263:"\u7528\u6237\u6307\u5b9a\u597d\u53cb\u540d\u4e0d\u5b58\u5728",264:"\u7528\u6237\u597d\u53cb\u6570\u5230\u8fbe\u6700\u5927",265:"\u7528\u6237\u672a\u767b\u9646",267:"\u6dfb\u52a0\u6536\u85cf\u5939\u5230\u6700\u5927\u503c",300:"\u8fbe\u5230\u7cfb\u7edf\u6700\u5927\u8fc7\u6ee4\u7528\u6237\u5bb9\u91cf",301:"\u8fbe\u5230\u7cfb\u7edf\u6700\u5927\u8fc7\u6ee4IP\u5bb9\u91cf",302:"\u7ba1\u7406\u5458\u6307\u5b9a\u7684\u5173\u952e\u5b57\u4e0d\u5b58\u5728\u8d34\u5427",303:"\u7ba1\u7406\u5458\u6307\u5b9a\u7684\u7528\u6237\u540d\u4e0d\u5b58\u5728",304:"\u7ba1\u7406\u5458\u6307\u5b9a\u7684IP\u6709\u8bef",316:"\u64cd\u4f5c\u5931\u8d25\uff01\u8be5IP\u5730\u5740\u4e3a\u624b\u673a\u4e0a\u7f51\u4f7f\u7528\uff0c\u65e0\u6cd5\u76f4\u63a5\u5c01\u7981\u3002",401:"\u6839\u636eforum_id \u4e0d\u80fd\u5f97\u5230\u8ba8\u8bba\u540d",402:"\u5f97\u5230\u7684\u8d34\u5427\u540d\u592a\u957f",870:"\u697c\u9ad8\u4eba\u591a\uff0c\u8bf7\u52ff\u63a8\u5012",871:"\u697c\u9ad8\u614e\u63a8\uff0c\u51b7\u9759\u4f1a\u513f\u5427",872:"\u7cbe\u54c1\u6765\u7684\u4e0d\u6613\uff0c\u8bf7\u52ff\u64c5\u81ea\u5220\u9664",874:"\u5427\u520a\u6765\u5f97\u4e0d\u6613\uff0c\u8bf7\u52ff\u64c5\u81ea\u5220\u9664"};;var Thread_add_result={resultNo:0,fid:"",tid:"",vid:"",sign:"",bdauditreason:0,bdQueryWordEnc:"",autoMsg:"",is_login:0,init:function(a){if(Thread_add_result&&a.data&&typeof(a.data)=="object"){for(var b in a.data){Thread_add_result[b]=a.data[b]}}Thread_add_result.resultNo=a.no},isNeedWaitForCheck:function(){var a=false;switch(this.resultNo){case 9:case 20:case 23:a=true;break;default:break}return a},isNeedBindPhone:function(){return this.resultNo==4010},Action_FocusTitle:"focusTitle",Action_FocusContent:"focusContent",Action_ClearYZM:"clearYZM",Action_FocusUrl:"focusUrl",Action_GoToHead:"goToHead",Action_FlushAndGoToHead:"flushAndGoToHead",getActionType:function(){var a="";switch(this.resultNo){case 10:case 14:case 501:case 15:case 36:case 41:case 42:case 43:case 46:case 9001:a=this.Action_FocusContent;break;case 11:case 20:a=this.Action_FocusTitle;break;case 17:case 0:a=this.Action_FlushAndGoToHead;break;case 22:case 9:case 23:case 119:case 44:case 100:case 703:case 704:case 705:a=this.Action_GoToHead;break;case 38:case 39:case 40:a=this.Action_ClearYZM;break;case 1120:case 1121:a=this.Action_FocusUrl;break;default:break}return a},getMessage:function(){var a="",b=null;if(this.resultNo>=901&&this.resultNo<=950){return Thread_add_result.autoMsg}if(b==null){b=(PageData.forum)?PageData.forum.id:null}if(b==null){b=PageData.forum_id}if(b==null){b=PageData.forumID}if(b==null){b=good_add_data.fid?good_add_data.fid:null}switch(this.resultNo){case 10:a="\u8d34\u5b50\u5185\u5bb9\u5305\u542b\u592a\u5c11\u7684\u6587\u5b57";break;case 11:a="\u8d34\u5b50\u6807\u9898\u548c\u5185\u5bb9\u592a\u957f";break;case 12:if(b!=null){a="\u64cd\u4f5c\u5931\u8d25\uff0c\u60a8\u7684\u8d26\u53f7\u56e0\u8fdd\u89c4\u64cd\u4f5c\u800c\u88ab\u5c01\u7981&nbsp;&nbsp;<a href='/upc/userinfo?fid="+b+'\' target="_blank">\u67e5\u770b\u5c01\u7981\u4fe1\u606f</a>'}else{a="\u64cd\u4f5c\u5931\u8d25"}break;case 13:if(b!=null){a="\u64cd\u4f5c\u5931\u8d25\uff0c\u60a8\u7684\u7f51\u7edc\u5730\u5740\u7531\u4e8e\u975e\u6cd5\u64cd\u4f5c\u88ab\u5c01<br/><a href='/upc/userinfo?fid="+b+'\' target="_blank">\u67e5\u770b\u5c01\u7981\u4fe1\u606f</a>'}else{a="\u60a8\u7684\u7f51\u7edc\u5730\u5740\u7531\u4e8e\u975e\u6cd5\u64cd\u4f5c\u88ab\u5c01 "}break;case 14:a="\u60a8\u53d1\u5e03\u7684\u8d34\u5b50\u5df2\u7ecf\u5b58\u5728";break;case 501:case 15:a="\u8bf7\u4e0d\u8981\u53d1\u8868\u542b\u6709\u4e0d\u9002\u5f53\u5185\u5bb9\u7684\u7559\u8a00<br>\u8bf7\u4e0d\u8981\u53d1\u8868\u5e7f\u544a\u8d34";break;case 16:a="\u5bf9\u4e0d\u8d77\uff0c\u60a8\u6240\u8f93\u5165\u7684\u8d34\u5427\u4e0d\u5b58\u5728\u3002\u7531\u4e8e\u7cfb\u7edf\u5347\u7ea7\u7ef4\u62a4\uff0c\u65b0\u5efa\u8d34\u5427\u529f\u80fd\u6682\u505c\uff0c\u5e0c\u671b\u5f97\u5230\u60a8\u7684\u8c05\u89e3\uff01";break;case 19:case 200:case 201:case 202:a="\u60a8\u7684\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u586b\u5199\u6709\u8bef\uff0c\u8bf7\u786e\u8ba4\u540e\u518d\u53d1\u8868";break;case 20:a="\u60a8\u53d1\u8868\u7684\u8d34\u5b50\u7684\u6807\u9898\u6216\u6b63\u6587\u5305\u542b\u592a\u5c11\u7684\u6587\u5b57\uff0c\u8bf7\u4fee\u6539\u540e\u518d\u53d1\u8868";break;case 17:a="\u672c\u5427\u5f53\u524d\u53ea\u80fd\u6d4f\u89c8\uff0c\u4e0d\u80fd\u53d1\u8d34\uff01";break;case 18:case 21:a="\u5176\u4ed6\u672a\u77e5\u539f\u56e0";break;case 22:a="\u60a8\u53d1\u8868\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u7531\u4e8e\u7279\u6b8a\u539f\u56e0\u6211\u4eec\u9700\u8981\u6838\u5b9e\u8be5\u8d34\u5185\u5bb9\u662f\u5426\u542b\u6709\u4e0d\u826f\u4fe1\u606f\uff0c\u6211\u4eec\u4f1a\u572810\u5206\u949f\u5185\u786e\u8ba4\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85\uff01";break;case 9:a=this.getCheckMessage(this.bdauditreason);break;case 33:if(Thread_add_result.is_login==1){a="\u60a8\u53d1\u8d34\u592a\u5feb\u4e86:) \u8bf7\u7a0d\u540e\u518d\u53d1"}else{a="\u60a8\u53d1\u8d34\u901f\u5ea6\u592a\u5feb\u4e86\u3002\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u8d34\uff0c\u7cfb\u7edf\u5bf9\u533f\u540d\u53d1\u8d34\u8fdb\u884c\u4e25\u683c\u7684\u63a7\u5236\uff0c\u767b\u5f55\u7528\u6237\u4e0d\u53d7\u5f71\u54cd"}break;case 34:if(Thread_add_result.is_login==1){a="\u60a8\u8bf4\u8bdd\u592a\u5feb\u4e86:) \u8bf7\u5148\u505c\u4e0b\u6765\u559d\u676f\u8336\u5427\uff0c\u6216\u8005\u53ef\u4ee5\u53bb\u522b\u7684\u5427\u770b\u770b\u54e6\uff0c\u4e00\u5b9a\u4f1a\u53d1\u73b0\u8fd8\u6709\u60a8\u611f\u5174\u8da3\u7684\u8bdd\u9898"}else{a="\u60a8\u53d1\u8d34\u901f\u5ea6\u592a\u5feb\u4e86\u3002\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u5e16\uff0c\u7cfb\u7edf\u5bf9\u533f\u540d\u53d1\u8d34\u8fdb\u884c\u4e25\u683c\u7684\u63a7\u5236\uff0c\u767b\u5f55\u7528\u6237\u4e0d\u53d7\u5f71\u54cd"}break;case 220034:a="\u60a8\u8bf4\u8bdd\u592a\u5feb\u4e86:) \u8bf7\u5148\u505c\u4e0b\u6765\u559d\u676f\u8336\u5427\uff0c\u6216\u8005\u53ef\u4ee5\u53bb\u522b\u7684\u5427\u770b\u770b\u54e6\uff0c\u4e00\u5b9a\u4f1a\u53d1\u73b0\u8fd8\u6709\u60a8\u611f\u5174\u8da3\u7684\u8bdd\u9898";break;case 35:if(Thread_add_result.is_login==1){a="\u60a8\u3002\u3002\u3002\uff01"}else{a="\u60a8\u53d1\u8d34\u901f\u5ea6\u592a\u5feb\u4e86\u3002\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u8d34\uff0c\u7cfb\u7edf\u5bf9\u533f\u540d\u53d1\u8d34\u8fdb\u884c\u4e25\u683c\u7684\u63a7\u5236\uff0c\u767b\u5f55\u7528\u6237\u4e0d\u53d7\u5f71\u54cd"}break;case 36:a="\u8bf7\u4e0d\u8981\u53d1\u5e7f\u544a\u8d34\uff01";break;case 37:a="\u60a8\u5df2\u5c1d\u8bd5\u63d0\u4ea4\u591a\u6b21\u4e86\uff0c\u8bf7\u8fd4\u56de\u540e\u5237\u65b0\u9875\u9762\uff0c\u65b9\u53ef\u91cd\u65b0\u53d1\u8d34";break;case 38:a="\u9a8c\u8bc1\u7801\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165";break;case 39:a="\u7531\u4e8e\u60a8\u591a\u6b21\u8f93\u9519\u9a8c\u8bc1\u7801\uff0c\u8bf7\u60a8\u8fd4\u56de\u540e\u5237\u65b0\u9875\u9762\uff0c\u65b9\u53ef\u91cd\u65b0\u53d1\u8d34";break;case 40:a="\u9a8c\u8bc1\u7801\u8f93\u5165\u9519\u8bef\uff0c\u8bf7\u60a8\u8fd4\u56de\u540e\u91cd\u65b0\u8f93\u5165";break;case 41:a="\u60a8\u7684\u8d34\u5b50\u53ef\u80fd\u5305\u542b\u4e0d\u5408\u9002\u7684\u5185\u5bb9\uff0c\u8bf7\u60a8\u786e\u5b9a\u540e\u518d\u63d0\u4ea4";break;case 42:a="\u60a8\u7684\u53d1\u8d34\u884c\u4e3a\u88ab\u7cfb\u7edf\u8ba4\u4e3a\u6709\u53d1\u5e7f\u544a\u5acc\u7591\uff0c\u8bf7\u60a8\u7a0d\u540e\u518d\u53d1";break;case 43:a="\u60a8\u7684\u53d1\u8d34\u884c\u4e3a\u6216\u8d34\u5b50\u5185\u5bb9\u6709\u5e7f\u544a\u6216\u4e0d\u5408\u9002\u7684\u7279\u5f81\uff0c\u8bf7\u60a8\u786e\u5b9a\u540e\u518d\u53d1\u9001";break;case 23:a="\u60a8\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u9700\u8981\u7cfb\u7edf\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u5efa\u7acb\u8d34\u5427";break;case 119:a="\u5bf9\u4e0d\u8d77\uff0c\u672c\u4e3b\u9898\u7684\u56de\u590d\u6570\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\uff0c\u611f\u8c22\u60a8\u7684\u53c2\u4e0e\uff0c\u6b22\u8fce\u60a8\u6d4f\u89c8\u672c\u5427\u7684\u5176\u5b83\u4e3b\u9898";break;case 1120:a="\u62b1\u6b49\uff0c\u60a8\u8f93\u5165\u7684\u56fe\u7247\u3001\u89c6\u9891\u94fe\u63a5\u5730\u5740\u9519\u8bef\uff0c\u60a8\u53ef\u4ee5\u70b9\u51fb<a href='http://www.baidu.com/search/post_img.html' target='_blank'>\u67e5\u770b\u76f8\u5173\u5e2e\u52a9</a>\u6216\u8fd4\u56de\u4fee\u6539";break;case 1121:a="\u62b1\u6b49\uff0c\u89c6\u9891\u670d\u52a1\u5347\u7ea7\u4e2d\uff0c\u60a8\u6682\u65f6\u65e0\u6cd5\u53d1\u8868\u5e26\u6709\u89c6\u9891\u7684\u8d34\u5b50\uff0c\u7ed9\u60a8\u5e26\u6765\u7684\u4e0d\u4fbf\u8bf7\u539f\u8c05";break;case 44:a="\u5bf9\u4e0d\u8d77\uff0c\u672c\u5427\u6682\u65f6\u9650\u5236\u90e8\u5206\u7528\u6237\u53d1\u8868\u4e3b\u9898\u8d34\u5b50\uff0c\u60a8\u53ef\u4ee5\u6d4f\u89c8\u6216\u56de\u590d\u672c\u5427\u5176\u5b83\u5185\u5bb9\uff0c\u7ed9\u60a8\u5e26\u6765\u4e0d\u4fbf\u5e0c\u671b\u5f97\u5230\u60a8\u7684\u8c05\u89e3\u3002";break;case 100:a="\u5bf9\u4e0d\u8d77\uff0c\u672c\u5427\u6682\u65f6\u9650\u5236\u90e8\u5206\u7528\u6237\u4f7f\u7528\u5b8c\u6574\u7684\u8d34\u5427\u529f\u80fd\uff0c\u60a8\u53ef\u4ee5\u6d4f\u89c8\u672c\u5427\u5176\u5b83\u5185\u5bb9\uff0c\u7ed9\u60a8\u5e26\u6765\u4e0d\u4fbf\u5e0c\u671b\u5f97\u5230\u60a8\u7684\u8c05\u89e3\u3002";break;case 701:a="\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u5e16\uff0c\u672c\u5427\u4e0d\u5141\u8bb8\u672a\u767b\u5f55\u7528\u6237\u53d1\u8d34\uff0c\u767b\u5f55\u7528\u6237\u4e0d\u53d7\u5f71\u54cd\uff0c\u7ed9\u60a8\u5e26\u6765\u7684\u4e0d\u4fbf\u6df1\u8868\u6b49\u610f";break;case 702:a="\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u5e16\uff0c\u672c\u5427\u9650\u5236\u90e8\u5206\u7528\u6237\u53d1\u8d34\uff0c\u7ed9\u60a8\u5e26\u6765\u7684\u4e0d\u4fbf\u6df1\u8868\u6b49\u610f";break;case 703:a="\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u5e16\uff0c\u672c\u5427\u88ab\u8bbe\u7f6e\u4e3a\u4ec5\u672c\u5427\u4f1a\u5458\u624d\u80fd\u53d1\u8d34\uff0c\u7ed9\u60a8\u5e26\u6765\u7684\u4e0d\u4fbf\u6df1\u8868\u6b49\u610f\u3002<a href='/f?kw="+this.bdQueryWordEnc+"#1' target=_blank>\u70b9\u6b64\u7533\u8bf7\u52a0\u5165</a>\u672c\u5427\u4f1a\u5458";break;case 704:a="\u4e3a\u4e86\u51cf\u5c11\u6076\u610f\u704c\u6c34\u548c\u5e7f\u544a\u5e16\uff0c\u672c\u5427\u88ab\u8bbe\u7f6e\u4e3a\u4ec5\u672c\u5427\u7ba1\u7406\u56e2\u961f\u624d\u80fd\u53d1\u8d34\uff0c\u7ed9\u60a8\u5e26\u6765\u7684\u4e0d\u4fbf\u6df1\u8868\u6b49\u610f";break;case 705:a="\u672c\u5427\u5f53\u524d\u53ea\u80fd\u6d4f\u89c8\uff0c\u4e0d\u80fd\u53d1\u8d34\uff01";break;case 706:a="\u62b1\u6b49\uff0c\u672c\u8d34\u6682\u65f6\u65e0\u6cd5\u56de\u590d\u3002";break;case 45:a="\u62b1\u6b49\uff0c\u60a8\u63d0\u4ea4\u7684\u8d34\u5427\u540d\u79f0\u542b\u7279\u6b8a\u5b57\u7b26\uff0c\u76ee\u524d\u65e0\u6cd5\u521b\u5efa\uff0c\u63a8\u8350\u60a8\u4f7f\u7528\u6c49\u5b57\u3001\u5b57\u6bcd\u6216\u6570\u5b57\u4f5c\u4e3a\u8d34\u5427\u540d\u79f0";break;case 46:a="\u62b1\u6b49\uff0c\u60a8\u7684\u8d34\u5b50\u8fc7\u957f\uff0c\u65e0\u6cd5\u6b63\u5e38\u63d0\u4ea4\u3002\u5efa\u8bae\u60a8\u7cbe\u7b80\u6216\u5206\u6bb5\u540e\u91cd\u65b0\u63d0\u4ea4\uff0c\u8c22\u8c22!";break;case 800:break;case 801:break;case 802:break;case 803:break;case 804:break;case 805:break;case 806:break;case 807:break;case 808:break;case 809:break;case 814:break;case 815:a="\u62b1\u6b49\uff0c\u60a8\u5df2\u9000\u51fa\u767b\u5f55\u6216\u672a\u8d2d\u4e70\u97f3\u4e50\u9053\u5177\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5";break;case 900:a="\u4e3a\u62b5\u5fa1\u6316\u575f\u5371\u5bb3\uff0c\u672c\u5427\u5427\u4e3b\u5df2\u653e\u51fa\u8d34\u5427\u795e\u517d--\u8d85\u7ea7\u9759\u6b62\u86d9\uff0c\u672c\u8d34\u6682\u65f6\u65e0\u6cd5\u56de\u590d\u3002";break;case 961:a="\u53d1\u8d34\u5931\u8d25\uff0c\u60a8\u8f93\u5165\u7684\u56fe\u7247\u5730\u5740\u6709\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u66f4\u6b63\u540e\u518d\u6b21\u53d1\u5e03\uff1a\uff09";break;case 9001:a="\u7531\u4e8e\u533f\u540d\u72b6\u6001\u6216\u672c\u5427\u8bbe\u7f6e\uff0c\u65e0\u6cd5\u53d1\u8868\u5e26\u6709\u56fe\u7247\u7684\u4e3b\u9898\u3002";break;case 2100:a="\u5185\u5bb9\u542b\u6709\u9ad8\u7ea7\u5b57\u4f53\u6548\u679c\uff0c\u4fdd\u6301\u8fde\u7eed\u7b7e\u5230\u5c31\u80fd\u4f7f\u7528\u54e6~~";break;case 4010:a="\u60a8\u7684\u8d26\u53f7\u5b58\u5728\u5b89\u5168\u98ce\u9669\u6682\u4e0d\u80fd\u53d1\u8d34\uff0c\u8bf7\u5148\u8fdb\u884c\u624b\u673a\u7ed1\u5b9a\u540e\u518d\u53d1\u8d34\u5427\u3002";break;case 9000:a="\u60a8\u8fd8\u6ca1\u6709\u7528\u6237\u540d\uff0c\u4e0d\u80fd\u5728\u672c\u5427\u53d1\u8d34\u3002\u8bf7\u5148\u586b\u5199\u7528\u6237\u540d\u3002";break;default:a="\u672a\u77e5\u9519\u8bef";break}return a},getCheckMessage:function(b){var a="";switch(b){case -61:a="\u60a8\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u4e3a\u4e86\u4fdd\u8bc1\u8d34\u5b50\u8d28\u91cf\uff0c\u672c\u5427\u6240\u53d1\u7684\u8d34\u5b50\u5f85\u7cfb\u7edf\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u663e\u793a\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85";break;case -62:a="\u60a8\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u4e3a\u4e86\u4fdd\u8bc1\u8d34\u5b50\u8d28\u91cf\uff0c\u672c\u5427\u8d34\u56fe\u7684\u8d34\u5b50\u9700\u8981\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u663e\u793a\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85";break;case -74:case -75:case -60:a="\u60a8\u53d1\u8868\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u7cfb\u7edf\u9700\u8981\u6838\u5b9e\u8be5\u8d34\u5b50\u5185\u5bb9\u662f\u5426\u542b\u6709\u4e0d\u826f\u4fe1\u606f\uff0c\u8d34\u5b50\u5728\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u663e\u793a\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85";break;case -70:a="\u60a8\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u4e3a\u4e86\u63a7\u5236\u5e7f\u544a\u8d34\uff0c\u9700\u8981\u901a\u8fc7\u5ba1\u6838\u540e\u624d\u80fd\u53d1\u5e03\u3002\u767b\u9646\u7f72\u540d\u53d1\u8d34\u4e0d\u53d7\u6b64\u9650\u5236\u3002";break;case -71:a="\u60a8\u53d1\u8868\u7684\u5e16\u5b50\u592a\u957f\u4e86\u3002\u4e3a\u4e86\u9632\u6b62\u704c\u6c34\uff0c\u9700\u7cfb\u7edf\u5ba1\u6838\u540e\u624d\u80fd\u663e\u793a\uff0c\u8bf7\u7a0d\u540e\u67e5\u770b";break;default:a="\u60a8\u53d1\u8868\u7684\u8d34\u5b50\u5df2\u7ecf\u6210\u529f\u63d0\u4ea4\uff0c\u4f46\u7cfb\u7edf\u9700\u8981\u6838\u5b9e\u8be5\u8d34\u5b50\u5185\u5bb9\u662f\u5426\u542b\u6709\u4e0d\u826f\u4fe1\u606f\uff0c\u8d34\u5b50\u5728\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u663e\u793a\uff0c\u8bf7\u60a8\u8010\u5fc3\u7b49\u5f85";break}return a}};;var SignNameApply={fillPanelId:"signNamePanel",getUrl:"/f/user/sign_list?t="+new Date().getTime().toString(36),isFirst:true,isUsed:0,data:{},template:function(){var b='<div id="signNameWrapper">';b+='<input type="checkbox" id="useSignName" name="useSignName"><label for="useSignName">\u4f7f\u7528\u7b7e\u540d\u6863</label>&nbsp;';b+='<span id="signNameShow"'+((this.isUsed==0)?'style="display:none;"':"")+">";if(this.data.signs.length>0){b+='<select id="sign_id" name="sign_id">';for(var d=0,c=this.data.signs.length;d<c;d++){var a=this.data.signs[d];b+='<option value="'+a.id+'"'+((a.id==this.data.used_id)?"selected=selected":"")+">"+a.name+"</option>"}b+="</select>";b+='&nbsp;<a style="color:#0449BE" target="_blank" href="/i/sys/jump?type=signsetting">\u67e5\u770b\u5168\u90e8</a>'}else{b+='\uff08\u60a8\u76ee\u524d\u6ca1\u6709\u53ef\u4f7f\u7528\u7684\u7b7e\u540d\u6863\uff0c&nbsp;<a style="color:#0449BE" target="_blank" href="/i/sys/jump?type=signsetting">\u67e5\u770b\u5168\u90e8</a>)'}b+="</span>";b+="</div>";return b},active:function(){if(this.isFirst){this.isFirst=false;var a=this.getUrl;this.postProcess(a,null,this.build)}},postProcess:function(url,data,callback){var self=this;if(data==null){$.get(url,function(xhr){var json=eval("("+xhr+")");if(json.no==0){if(typeof callback=="function"){callback(self,json)}}})}else{$.post(url,SignNameApply._convertToQueryString(data),function(xhr){var json=eval("("+xhr+")");if(json.no==0){if(typeof callback=="function"){callback(self,json)}}})}},_convertToQueryString:function(b){var c=[];for(var a in b){c.push(encodeURIComponent(a)+"="+encodeURIComponent(b[a]))}return c.join("&")},build:function(a,b){a.data=b.data;a.isUsed=b.data.need;a.fillToPage()},fillToPage:function(){$("#"+this.fillPanelId).html(this.template());this.initPage()},showList:function(){if(this.isUsed==1){$("#signNameShow").css("display","")}else{$("#signNameShow").css("display","none")}},initPage:function(){if(this.isUsed==1){$("#useSignName").attr("checked",true)}else{$("#useSignName").attr("checked",false)}this.showList();this.handlerEven()},setisUsed:function(a){if(a){this.isUsed=1}else{this.isUsed=0}this.showList();this.postProcess("/f/user/cm/sign_setneed",{need:this.isUsed,tbs:PageData.tbs},null)},handlerEven:function(){var a=this;$("#useSignName").click(function(){a.setisUsed(this.checked)})}};;var PostHandler={post:function(a,b,d,c){$.ajax({type:"post",async:false,dataType:"json",url:a,data:b,success:function(e){if(d){d(e)}}})},execute:function(b,c,d){var a=FORUM_POST_URL[b];PostHandler.post(a,c,d)}};;if(!UTSTART){var UTSTART=new Date().getTime()}if(!MOUSEPWD_CLICK){var MOUSEPWD_CLICK=0}var MousePwd=(function(){var n={ea:[],ma:[]};var h={};var c=false;var i=(new Date()).getTime();var o={};var j=[];var q=[];function k(u){if(!u){var u=window.event}var t=0;var v=0;if(u.pageX||u.pageY){t=u.pageX;v=u.pageY}else{if(u.clientX||u.clientY){t=u.clientX+document.body.scrollLeft;v=u.clientY+document.body.scrollTop}}return[t,v]}function b(t){return t.offsetParent?(t.offsetLeft+b(t.offsetParent)):t.offsetLeft}function a(t){return t.offsetParent?(t.offsetTop+a(t.offsetParent)):t.offsetTop}function p(t){if(t.preventDefault){t.preventDefault()}else{window.event.returnValue=false}}function s(A){A.stopPropagation();var v=k(A);var x=n[this.id];if(x){if(!x.hover){x.hover=true;x.count++}}else{var w=b(this);var y=a(this);var z=w+this.offsetWidth;var u=y+this.offsetHeight;x=n[this.id]={hover:true,count:1,left:w,top:y,right:z,buttom:u}}if(!x["mouse"+x.count]){x["mouse"+x.count]=[];x["time"+x.count]={start:(new Date()).getTime()};n.ma.push(x["mouse"+x.count])}x["mouse"+x.count].push(v);q.push("1")}function r(v){v.stopPropagation();var t=k(v);var u=n[this.className];if(u&&u.hover){if(t[0]&&t[0]>u.left&&t[0]<u.right&&t[1]&&t[1]>u.top&&t[1]<u.buttom){return}u["time"+u.count].end=(new Date()).getTime();u.hover=false}q.push("0")}function e(){var t=n.ma.length;if(t>0){var u=n.ma[t-1];return u[u.length-1]}}function f(){var u="";var t=q.length;if(t>10){q=q.slice(t-10)}u=q.join(",");return u}function l(){if(c){return h}var t=[e(),f(),(new Date()).getTime()-UTSTART,[screen.width,screen.height].join(",")].join("\t");h.c=d(t)+","+i+""+MOUSEPWD_CLICK;c=true;return h}function d(y){var t=[];var w={};var x=i%100;for(var v=0,u=y.length;v<u;v++){var z=y.charCodeAt(v)^x;t.push(z);if(!w[z]){w[z]=[]}w[z].push(v)}return t}function g(){return this.className}function m(t){this.elements=t;$.each(t,function(u,v){$("."+v.toString()).bind("mouseover",s);$("."+v.toString()).bind("mouseout",r);o[v.toString()]=u});$("body").bind("click",function(){MOUSEPWD_CLICK=1})}return{start:m,report:l,time:i}})();;_.Module.define({path:"common/component/WordLimit",requires:[],sub:{checkTimer:null,isShow:false,exceed:false,initial:function(b){var a={container:$("body"),inputObj:null,checkDelay:200,showLimit:10,maxNum:120,isLimitInput:false,autoPos:true,numStyle:{},limitStyle:{}};var c=$.extend(true,a,b);this.container=$(c.container);this.inputObj=$(c.inputObj);this.showLimit=c.showLimit;this.option=c;this.holder=$('<div class="w_limit_wrapper "></div>');this.container.append(this.holder)},init:function(){var c=this.option,b=this;if(c.inputObj==null){return}var a=$(c.inputObj);if(c.isLimitInput){$.subInput(a,c.maxNum)}a.keydown(function(d){b.handlerEvent(d);return true});a.focus(function(d){b.handlerEvent(d);return true});a.bind("input",function(d){b.handlerEvent(d);return true});a.bind("propertychange",function(d){b.handlerEvent(d);return true});b.check()},setLimitStyle:function(a){this.holder.css(a)},hideWordLimit:function(){this.holder.hide();this.isShow=false;clearTimeout(this.checkTimer)},autoPosition:function(){var c=this.inputObj.offset(),b=this.inputObj.width(),a=$(document).width();this.holder.css({top:c.top-this.holder.height()-5,right:a-b-c.left-9})},handlerEvent:function(b){clearTimeout(this.checkTimer);var c=this.option;var a=this;a.blur=false;this.checkTimer=setTimeout(function(){a.check()},c.checkDelay)},check:function(b){var d=this.option;var c=d.maxNum-$.tb.getByteLength(this.inputObj.val().trim());if(c<=this.showLimit){if(d.autoPos){this.autoPosition()}else{this.trigger("onSetPosition")}this.holder.show();this.isShow=true;var a=Math.ceil(c/2);if(c<0){a=Math.floor(c/2);if(!this.exceed){this.trigger("overflow");this.exceed=true}this.holder.html('\u5df2\u7ecf\u8d85\u51fa<span class="w_limit_num" style="color:#f00;">'+-a+"</span>\u4e2a\u5b57")}else{if(this.exceed){this.trigger("unoverflow");this.exceed=false}if(c==0){this.holder.html('\u8fd8\u53ef\u8f93\u5165<span class="w_limit_num" style="color:#ff0000;">'+a+"</span>\u4e2a\u5b57")}else{this.holder.html('\u8fd8\u53ef\u8f93\u5165<span class="w_limit_num" style="color:#929292;">'+a+"</span>\u4e2a\u5b57")}}}else{if(this.isShow){this.holder.hide();this.isShow=false;if(this.exceed){this.trigger("unoverflow");this.exceed=false}}}}}});_.Module.define({path:"common/component/EditorLayer",requires:[],sub:{closeButton:null,container:null,holder:null,content:null,currentOpen:null,isOpen:false,initial:function(c){var b={container:$("body"),closeBtn:false,arrow:true};var d=$.extend({},b,c);this.container=d.container;var a=this;this.j_holder=$('<div class="tb_layer_wrapper"></div>');this.holder=this.j_holder[0];this.j_holder.hide();this.j_content=$('<div class="layer_content"></div>');this.content=this.j_content[0];if(d.closeBtn){this.addCloseBtn()}if(d.arrow){this.addArrow()}this.j_holder.append(this.content);this.container.append(this.holder);this.j_holder.click(function(f){f.stopPropagation()})},addArrow:function(){this.j_arrow=$('<span class="arrow"></span>');this.arrow=this.j_arrow[0];this.j_holder.append(this.arrow)},addCloseBtn:function(){this.j_closeBtn=$('<span class="close"></span>');this.closeBtn=this.j_closeBtn[0];var a=this;$(this.closeBtn).bind("click",function(){a.close()});this.j_holder.append(this.closeBtn)},open:function(e,b,d,c){this.j_holder.css(e.layerPos);this.j_holder.css(e.layerSize);this.j_content.css(e.content);this.setArrowStyle(e.arrowPos,e.arrowType);this.editor=d;if(window.PAGESMILELAYER&&window.PAGESMILELAYER.isOpen){window.PAGESMILELAYER.normalClose()}if(window.PAGEEDITORLAYER&&window.PAGEEDITORLAYER.isOpen){window.PAGEEDITORLAYER.normalClose()}if(c=="smile"){$("#editor").find(".j_editor_windex").css({zIndex:0})}else{$("#editor").find(".j_editor_windex").css({zIndex:10})}d.saveCursor();this.j_holder.show();if($.type(b)=="string"){this.j_content.html(b)}else{b.init(this.j_content,d)}this.isOpen=true;var a=this;var f=function(g){$(document).one("click."+g+"",function(j){var h=j.target||j.srcElement,i=$(h);if(i.closest(".tb_layer_wrapper").length==0&&i.closest(".tb-editor-toolbar").length==0&&i.attr("id")!="qiyifileupload"){if(!window.PicUploaderShow){a.close()}}if(i.attr("id")=="qiyifileupload"){f("second")}})};f("first");this.trigger("open")},setLayerStyle:function(a){this.j_holder.css(a.layerPos);this.j_holder.css(a.layerSize);this.j_content.css(a.content);this.setArrowStyle(a.arrowPos,a.arrowType)},setPosition:function(a){this.j_holder.css(a)},setArrowStyle:function(b,a){this.j_arrow.attr("class","arrow "+a);if($.browser.msie&&$.browser.version<7){if(b.bottom){b.bottom-=3}}this.j_arrow.css(b)},setSize:function(a){this.j_holder.css(a)},close:function(a){this.j_holder.hide();this.isOpen=false;this.editor&&this.editor.ensureCursor();this.trigger("close");this.trigger("closeVideo");if(a){a.destroy()}},normalClose:function(){this.j_holder.hide();this.isOpen=false},openPicasso:function(a,c,b){this.close();a.init(c,b);this.layerCom=a},toggle:function(f,b,e,d,c){var a=this;if(this.currentOpen&&this.currentOpen===d&&a.isOpen){this.close();$(d).removeClass("open").addClass("close")}else{$(d).removeClass("close").addClass("open");this.currentOpen=d;this.open(f,b,e,c)}}}});var RichPostor=function(option){var eidtor=$("#"+option.editorDom);this.$element=eidtor;this._data_postor=eval("("+eidtor.attr("data-postor")+")");this._data_editor=eval("("+eidtor.attr("data-editor")+")");var data_temp=this._data_editor;this._option=option;this._isPosting=false;this._check_post_thread=null;this._maxMusicNum=10;this._elements={music_num:0,image_num:0,smiley_num:0,flash_num:0};this._reloadUrl="";this._event={};if(data_temp.is_readonly!=1&&data_temp.forbid_flag!=6){var tpl=$("#"+option.tpl_id)[0].innerHTML+"";this._generi_dom_id(option);var userInfo=option.userInfo;tpl=$.tb.format(tpl,this._dom_id);eidtor[0].innerHTML=tpl;this._compatibleOld();var domId=this._dom_id,op_temp=this._option;this._headInit(op_temp.header);var login=data_temp.is_login,can_post=data_temp.can_post,no_un=op_temp.no_un,forbid_flag=data_temp.forbid_flag;this._statInit(login,can_post,no_un,forbid_flag);if(this._option.prefix_needSug){this.pickPrefix($("#title1"),this._option.prefix_sughtml)}}};RichPostor.prototype={constructor:RichPostor,_compatibleOld:function(){var e=this._option,d=this._dom_id;if(!e.page){if(e.title){this._option.page="frs";var c=$("#editor"),b=c.attr("class");if(b=="frs_rich_editor"){this._option.header="\u53d1\u8868\u65b0\u5e16"}else{this._option.header=""}}else{this._option.page="pb";this._option.header="\u53d1\u8868\u56de\u590d"}var a=$("#"+d.editor_banned_tip);a.css({top:"60px"});$("#"+d.reply_h).hide()}},_spamming:function(){$("body").append('<div id="anttongji" style="display:none"></div>');var a=$(document.createElement("script")),b="http://tongji.tieba.baidu.com/common/js/gettopic.js";a.attr({src:b,type:"text/javascript"});$("body").append(a)},_sendPamming:function(){var a=$.cookie("GET_TOPIC");if(a&&a==PageData.user.id){}else{this._spamming();$.cookie("GET_TOPIC",PageData.user.id,{expires:0.5,path:"/"})}},_headInit:function(c){var a=this,b=this._option;$("#"+b.editorDom).find(".editor_title_txt").html(c)},_statInit:function(b,e,c,d){var f=this._option,a=this;if(!b){this._cannotPost(f.page);this._showBannedTip(1);return}if(b&&e!=1){this._cannotPost(f.page);this._showBannedTip(2);return}if(b&&e==1&&c){this._cannotPost(f.page);this._showBannedTip(3);return}if(this._option.is_block){this._cannotPost(f.page);this._showBannedTip("is_block");return}if(b&&e==1&&(!c&&d==0)){this._canPost(f.page);this._userBarInit(5);if(this._option.no_post_pic){a._editor.toolbar.disableInsertImage()}this._sendPamming();return}if(b&&e==1&&(!c&&d>0)){this._canPost(f.page);this._userBarInit(5);if(this._option.no_post_pic){a._editor.toolbar.disableInsertImage()}this._sendPamming();return}},_cannotPost:function(a){if(a&&a.indexOf("frs")!=-1){this._titleInit("disable")}this._editorInit("disable");this._userBarInit(1);this._captchaInit();this._postBtnInit("disable");this._setContainerDisable()},_canPost:function(a){if(a&&a.indexOf("frs")!=-1){this._titleInit("enable")}this._editorInit("enable");this._captchaInit();this._postBtnInit("enable");this._showBannedTip(4)},_titleInit:function(c){var a=this;var e=this._dom_id;var f=this._option;switch(c){case"enable":$("#"+e.title_tr).show();var d=$("#"+f.title);d.focus(function(){$(this).addClass("edit_field_focus");a._initCaptchaAndSign(a)});d.blur(function(){$(this).removeClass("edit_field_focus")});var b={container:$("body"),inputObj:d,checkDelay:200,showLimit:10,maxNum:60,isLimitInput:true,numStyle:{},limitStyle:{}};_.Module.use("common/component/WordLimit",[b],function(g){a.wordLimit=g;a.wordLimit.init()});break;case"disable":this._setDisable(a._option.title,true);$("#"+e.title_tr).show();break}},_editorInit:function(e){var f=this._dom_id,d=this._option,a=d.userInfo,b=this;var c={container:f.editorInput,uid:a.user["id"],flashNumLimit:d.media_conf["flashLimite"],flashWhiteList:d.media_conf["flashWhiteList"],imageLimite:d.media_conf["imageLimite"],height:"193px",width:"633px",forum_name:this._data_postor.kw,forum_id:this._data_postor.fid,user_name:a.user_name,picasso:d.picasso,no_post_pic:d.no_post_pic,bavl:d.bavl,is_ipad:d.is_ipad,can_local_upload:d.can_local_upload,page_units:{bde_flash_tip:PageUnit.load("rich_postor_flashtip")}};switch(e){case"enable":c.autoEnable=true;b._editor=new TED.Editor(c);b._editorEvent();break;case"disable":c.autoEnable=false;b._editor=new TED.Editor(c);break}},_editorEvent:function(){var l=this;var a=this._data_editor,h=this._option;var d=this._dom_id;var k=h.userInfo;if(!this._editor.isMobile){try{this._editor.addPlugin("autoheight",new TED.EditorPlugins.AutoHeightPlugin());this._editor.addPlugin("filtehtml",new TED.EditorPlugins.FilteHtmlPlugin(this._option.no_post_pic?false:true,this));this._editor.addPlugin("imageeditor",new TED.EditorPlugins.ImageEditor());this._editor.addPlugin("draft",new TED.EditorPlugins.SaveDraft(k.user["id"],this._data_postor.fid,this._data_postor.tid,h.isPb));if(h.page=="pb"&&h.interestSmiley==1){var f=this._data_postor;var g={canPostor:{isBlock:h.is_block,noUn:h.no_un,forbidFlag:a.forbid_flag,login:a.is_login,canPost:a.can_post},data:{kw:f.kw,ie:"utf-8",rich_text:"1",floor_num:f.floor_num,fid:f.fid,tbs:h.tbs,tid:f.tid,lp_type:h.thread_topic_type,lp_sub_type:h.thread_topic_subtype}};this._editor.addPlugin("interestSmiley",new TED.EditorPlugins.InterestSmiley($("#"+d.editorInput),l.$element,g))}var c=$("#"+d.add_post_submit);if(this._option.open_idisk){this._editor.addPlugin("idisk",new TED.EditorPlugins.IdiskPlugin(this._option.power_idisk,this._data_postor.fid,this._option.upload_max_length,this._option.upload_max_size));this._editor.on("idisk_upload_complete",function(e){var m=this.getPostorDataObj("files");m=m||[];m.push(e);this.setPostorDataObj("files",m)},this);this._editor.on("idisk_remove_file",function(n){var o=this.getPostorDataObj("files");if(!o){return}if(n.md5){for(var m=0,e=o.length;m<e;m++){if(o[m].path===n.path){o.splice(m,1);if(o.length===0){this.setPostorData("files",undefined)}else{this.setPostorDataObj("files",o)}return}}}},this);this._editor.on("idisk_uploading_start",function(){l._isPosting=true;l.setPostingStatus(true);c.attr("disabled",true);c.removeClass("subbtn_bg").addClass("subbtn_bg_banned")},this);this._editor.on("idisk_uploading_stop",function(){l._isPosting=false;l.setPostingStatus(false);c.attr("disabled",false);c.removeClass("subbtn_bg_banned").addClass("subbtn_bg")},this)}this._editor.addPlugin("FontEdit",new TED.EditorPlugins.FontEditPlugin(h.c_sign_num));MousePwd.start(["tb-editor-wrapper"])}catch(j){}}this._editor.on("quote",function(e){this.setPostorData("quote_id",e)},this);this._editor.on("unquote",function(){this.setPostorData("quote_id",0)},this);var i=this._editor,b=i.editArea;this._editor.on("focus",function(){$(b).addClass("edit_field_focus");if(l.wordLimit){if($.browser.msie){setTimeout(function(){l.wordLimit.hideWordLimit()},20)}else{l.wordLimit.hideWordLimit()}}setTimeout(function(){l._initCaptchaAndSign(l)},0)});this._editor.on("click",function(){$(b).addClass("edit_field_focus");setTimeout(function(){l._initCaptchaAndSign(l)},0)});this._editor.on("blur",function(){$(b).removeClass("edit_field_focus")})},_tipConfig:{"0":'\u4e00\u8d77\u4e3a\u96c5\u5b89\u7948\u798f\uff01<br />\u70b9\u51fb\u94fe\u63a5\u53bb<a target="_blank" style="cursor:pointer;" href="http://tieba.baidu.com/f?ie=utf-8&kw=%E9%9B%85%E5%AE%89%E5%9C%B0%E9%9C%87">\u96c5\u5b89\u5730\u9707\u5427</a>\u53d1\u5e03\u6c42\u52a9\u548c\u5bfb\u4eba\u4fe1\u606f\u3002'},_postorTip:function(){var d=this,e=this._tipConfig[0],f=this._data_postor.fid,a=$("#"+this._dom_id.editorInput).find(".tb-editor-editarea-wrapper"),c=$.trim($(this._editor.editArea).text()),b;if(f==15401){return}if(e&&c==""){b=$("<div id='postorTip' style='color:#999;position: absolute;top: 18px;left: 24px;'>"+e+"</div>");a.append(b);d._editor.on("focus",function(){b.remove()})}},_captchaInit:function(){var c=this._dom_id,b=this._data_editor;var a={container:"#"+c.captcha_div,onInputFocus:function(g,f){var d=f.getInputValue();if(d!=""){f.hideErrorTip()}}};this._captcha=PostorCaptchaReq.getCaptchaInstance(a)},_userBarInit:function(h){var e=this._dom_id,f=$("#"+e.post_user),a=$("#"+e.post_login);var c=$("#"+e.post_anonym_con),j=this;var b=this._data_editor,i=b.forbid_flag;switch(h){case 1:f.hide();return;case 2:a.attr("checked",true);a.attr("disabled",false);a.click(function(){PostorCaptchaReq.isAnonymous=false;j.isAnonymous=false;j._initCaptchaAndSign(j);j._captcha.changeContent("loginUser")});c.hide();var g=document.getElementById(e.msg_cannot_anonym);var d="\uff08"+this._tip[i][1]+"\uff09";g.innerHTML=d;break;case 3:a.click(function(){PostorCaptchaReq.isAnonymous=false;j.isAnonymous=false;j._initCaptchaAndSign(j);j._captcha.changeContent("loginUser")});$("#"+e.post_anonym).click(function(){PostorCaptchaReq.isAnonymous=true;j.isAnonymous=true;j._initCaptchaAndSign(j);j._captcha.changeContent("anonym");if(!j._option.no_post_pic){j.onClickAnonym()}});a.attr("checked",true);c.show();break;case 5:f.find(".pt_uname").html("");a.attr("checked",true);f.find("label").hide();break}f.show()},_userBarEvent:function(){},_signInit:function(){},_postBtnInit:function(c){var b=this,d=this._dom_id,a=$("#"+d.add_post_submit);switch(c){case"enable":a.attr("disabled",false);a.className="subbtn_bg";b._postBtnEvent();break;case"disable":a.attr("disabled",true);a.className="subbtn_bg_banned";break}},_postBtnEvent:function(){var d=this._dom_id,b=this,a=$("#"+d.add_post_submit),c=$("#"+d.post);a.mouseover(function(){$(this).attr("class","subbtn_bg_hover")});a.mouseout(function(){$(this).attr("class","subbtn_bg")});a.mousedown(function(){$(this).attr("class","subbtn_bg_active")});c.submit(function(){b._submit();return false});c.keydown(function(f){var g=f||window.event;if((g.ctrlKey&&g.keyCode==13)||(g.altKey&&g.keyCode==83)){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}setTimeout(function(){b._submit()},0)}})},_tip:[[""],["","\u672c\u5427\u76ee\u524d\u4ec5\u9650\u767b\u5f55\u7528\u6237\u53d1\u8d34\uff0c\u4e0d\u80fd\u4f7f\u7528\u533f\u540d\u53d1\u8d34\u529f\u80fd"],["\u62b1\u6b49\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53ca\u6ce8\u518c\u6ee1\u4e00\u5b9a\u65f6\u95f4\u7684\u8001\u7528\u6237\u53d1\u8d34","\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53ca\u6ce8\u518c\u6ee1\u4e00\u5b9a\u65f6\u95f4\u7684\u8001\u7528\u6237\u53d1\u8d34\uff0c\u4e0d\u80fd\u4f7f\u7528\u533f\u540d\u53d1\u8d34\u529f\u80fd"],["\u62b1\u6b49\uff0c\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u5141\u8bb8","\u672c\u5427\u76ee\u524d\u4ec5\u9650\u4f1a\u5458\u53d1\u8d34\uff0c\u4e0d\u80fd\u4f7f\u7528\u533f\u540d\u53d1\u8d34\u529f\u80fd"],["\u62b1\u6b49\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53d1\u8d34","\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53d1\u8d34\uff0c\u4e0d\u80fd\u4f7f\u7528\u533f\u540d\u53d1\u8d34\u529f\u80fd"],["\u62b1\u6b49\uff0c\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u672c\u5427\u76ee\u524d\u53ea\u80fd\u6d4f\u89c8\uff0c\u4e0d\u80fd\u53d1\u8d34","\u62b1\u6b49\uff0c\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u672c\u5427\u76ee\u524d\u53ea\u80fd\u6d4f\u89c8\uff0c\u4e0d\u80fd\u53d1\u8d34"]],_showBannedTip:function(f){var e=null;var c=this._dom_id,a=this._data_editor;var d=this._option,i=a.forbid_flag;var b="",e=document.getElementById(c.editor_banned_tip);switch(f){case 1:b='<div class="editor_banned_tip_info">'+this._tip[i][0];b=b+(i==1?"":"<br />");var j="<a href=\"#\" onclick=\"$.stats.sendRequest('fr=tb0_forum&st_mod=editor&st_type=count_action&st_value=login');_.Module.use('common/component/LoginDialog', ['', 'editor"+(PageData.page_id||"")+"']);return false;\">\u767b\u5f55</a> | <a href=\"#\" onclick=\"$.stats.sendRequest('fr=tb0_forum&st_mod=editor&st_type=count_action&st_value=reg');TbCom.process('User','buildRegisterFrame',null,null,null,'editor"+(PageData.page_id||"")+"');return false;\">\u6ce8\u518c</a>&nbsp;";b=b+(i==1?"\u672c\u5427\u53d1\u8d34\uff0c\u8bf7\u5148 ":"\u4f60\u53ef\u4ee5\u5148 ")+j;b+="</div>";break;case 2:b='<div class="editor_banned_tip_info">'+this._tip[i][0];var h='<a href="http://tieba.baidu.com/f/like/level?kw=d8" >4\u7ea7\u5934\u8854</a><br />\u4ee5\u4e0a\u4f1a\u5458\u53d1\u8d34\u3002';b=b+(i==3?h:"");b+="</div>";break;case 3:b="<div class=\"editor_banned_tip_info\">\u60a8\u8fd8\u6ca1\u6709\u7528\u6237\u540d\uff0c\u4e0d\u80fd\u5728\u672c\u5427\u53d1\u8d34\u3002\u8bf7\u5148<a href=\"#\" onclick=\"TbCom.process('User','buildUnameFrame','\u586b\u5199\u7528\u6237\u540d',' ');return false;\">\u586b\u5199\u7528\u6237\u540d</a></div>";break;case 4:if(e!=null){e.style.display="none"}break;case"is_block":var g=['<div class="editor_banned_tip_info">'];g.push(PageUnit.load("rich_postor_blocktippart1"));g.push(PageUnit.load("rich_postor_blocktippart2"));g.push(PageUnit.load("rich_postor_blocktippart3"));g.push("</div>");b=g.join("");b=b.replace(/(href=\")(.*?)(\")/,"$1$2"+this._data_postor.fid+"$3");break}if(e){e.innerHTML=b}},_setContainerDisable:function(){$("#editor").find("td").css("color","#CCCCCC")},jumpToTry:function(d){var c=this._data_editor;if(c.is_login&&c.can_post==1){var b=this._editor.toolbar;var a=this._editor.overlay;if(d==6){this._editor.jumpTo_picasso()}else{a.open("120px","43px","420px","355px","123px",this._editor.config.rootPath+"smiley.html?id="+this._editor.id+"&bavl=true")}}},_generi_dom_id:function(a){var b=new Date().valueOf();this._dom_id={post:"pt"+b,editor_banned_tip:"ebt"+b,editorInput:"eInput"+b,coError:"co"+b,post_login:"pl"+b,post_user:"pu"+b,post_anonym_con:"pac"+b,post_anonym:"pa"+b,msg_cannot_anonym:"mca"+b,signPanel:"sp"+b,captcha_container:"cc"+b,captcha_div:"cd"+b,add_post_submit:"aps"+b,uname:a.userInfo["user_name"],title_tr:"tt"+b,title_div:"td"+b,reply_h:"rh"+b,tiError:"tE"+b,prefix_value:a.prefix_value,prefix_mode:a.prefix_mode};if(a.title){this._dom_id.title=a.title}else{this._dom_id.title="title"}},_limitTitle:function(g,e){var b=[8,9,16,17,18,20,13,27,37,38,39,40,33,34,35,36,45,46,112,113,114,115,116,117,118,119,120,121,122,123,144,145];var f=g;var a=-1;for(var d=0;d<b.length;d++){if(b[d]==f.keyCode){a=d;break}}if(a>=0){return true}var c=e.value.toString();if(f.ctrlKey||f.altKey){return true}if(c.getByteLength()==60){return false}if(c.getByteLength()>60){e.value=c.subByte(60)}return true},bind:function(b,a,c){var d={stat:c?true:false,fun:a};if(this._event[b]){this._event[b].push(d)}else{this._event[b]=[];this._event[b].push(d)}},triggerEvent:function(b){var a=Array.prototype.slice.call(arguments,0);a.shift();if(this._event[b]){var d=this._event[b];for(var c=0;c<d.length;c++){if(d[c].fun){d[c].fun.apply(this,a)}if(!d[c].stat){return false}}}return true},reply:function(a,b,e){var d=this._data_editor;var c=this._option;if(d.can_post!=1){return false}else{if(c.no_un&&d.forbid_flag>0){return false}}this._editor.quote(a,b,e);if(PageData.is_last_page&&PageData.is_lzl==0){$.stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=quote&st_value=rp_reply")}},_isExist:function(a){if(!a){return false}var b=document.getElementById(a);if(b){return true}return false},_initCaptchaAndSign:function(a){var e=a._dom_id;var g=document.getElementById(e.post_login);var c=this._option;var d=this._data_editor;if(this._isExist(e.signPanel)){if(d.is_login){if(!c.no_un){if(g.checked){document.getElementById(e.signPanel).style.display="";SignNameApply.fillPanelId=e.signPanel;SignNameApply.active()}else{var b=document.getElementById(e.signPanel);if(b){b.style.display="none"}}}}else{var b=document.getElementById(e.signPanel);if(b){b.style.display="none"}}}var f=function(){if(PostorCaptchaReq.needCaptcha){a._captcha.show();$("#"+e.captcha_container).show()}else{a._captcha.hide();$("#"+e.captcha_container).hide()}};if(!this._option.captcha_after_post){PostorCaptchaReq.antiProcess(f)}},_setDisable:function(b,c){var a=document.getElementById(b);if(!a){return}a.disabled=true;if(c){$("#"+b).addClass("notPostbg")}},_checkPostStatus:function(){var a=this;this._stopCheckPostStatus();this._check_post_thread=setTimeout(function(){var b=document.getElementById(a._dom_id.add_post_submit);if(b&&b.disabled){$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=add_post")}},10*1000)},_stopCheckPostStatus:function(){var a=this;if(a._check_post_thread){clearTimeout(a._check_post_thread)}},_doInputCount:function(){var b=this._editor;var a={music_num:b.getMusicNum(),image_num:b.getImageNum(),smiley_num:b.getSmileyNum(),flash_num:b.getFlashNum()};$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=count_input&num_music="+a.music_num+"&num_image="+a.image_num+"&num_smiley="+a.smiley_num+"&num_flash="+a.flash_num+"&page_id="+PageData.page_id+((PageData.is_last_page&&PageData.is_lzl==0)?"&last_page=1":""));this._elements=a},setPostorData:function(a,c){var b=this._data_postor;b[a]=c},getPostorData:function(a){var b=this._data_postor;return b[a]},setPostorDataObj:function(a,c){var b=this._data_postor;b[a]=$.json.encode(c)},removePostorData:function(a){var b=this._data_postor;delete b[a]},getPostorDataObj:function(a){var b=this._data_postor;return $.json.decode(b[a])},_getData:function(){var f=this._data_postor;var l=this._data_editor;var d=this._dom_id;var g=this._option;if(g.page!="pb"){var i=$("#"+g.title).attr("data-prefix");var q=$("#"+g.title).val().replace(/\u2006/g,"");f.prefix=i;if(q.indexOf(i)==-1){f.prefix=""}f.title=q.replace(f.prefix,"")}else{f.lp_type=g.thread_topic_type;f.lp_sub_type=g.thread_topic_subtype}var r=$("#"+g.editorDom),c=r.find(".BDE_Flash"),a=[],n=[];c.each(function(){var e=this,s=$(this),u=s.attr("data-video_url"),t=s.attr("video_mp4_url");if(u){a.push(u)}if(t){n.push(t)}});if(a.length>0){f.video_url=a.join(",")}if(n.length>0){f.video_mp4_url=n.join(",")}f.content=this._editor.getHtml();var h=l.is_login;var p=document.getElementById("useSignName");var b=document.getElementById(d.post_login);var k=document.getElementById("sign_id");if(!g.no_un&&h){if(b.checked&&p&&p.checked&&k){f.sign_id=k.value}}if(h){if(!g.no_un){f.anonymous=0}else{f.anonymous=1}}f.tbs=this._option.tbs;if(!this._option.captcha_after_post){var m=this._captcha.getInputValue();if(m!=""){f.vcode=m}f.vcode_md5=this._captcha.signStr}if(this._option.captcha_grid){f.tag=11}f.new_vcode=1;try{var o=window.external.GetVersion("version");if(o.indexOf("baidubrowser")>-1){f.browser_version="baidubrowser"}}catch(j){}return f},getEditor:function(){return this._editor},_validator:function(){if(this._option.title){var a=this._data_editor;if((!a.is_notitle)&&!this._validFrsPostTitle()){return false}}else{var c=this._dom_id;var b=document.getElementById(c.coError);if(this._editor.isEmpty()){b.style.display="";b.innerHTML="\u56de\u590d\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a";b.className="postErrorContent";this._editor.focus();return false}}if(!this._validRichEditorContent()){return false}if(!this._option.captcha_after_post&&!this._captcha.validCaptcha()){return false}return true},_validRichEditorContent:function(){var d=this._dom_id,p=this;var n=this._data_editor;var b=document.getElementById(d.coError);var h=this._option.media_conf;var i=this._option;if(n.is_notitle){if($("#"+i.title).val().trim()==i.newTitieField_tip||$("#"+i.title).val().trim()==""){this.setPostorData("tfrom",2);$("#"+i.title).val("");if((this._editor.isEmpty()||!this._editor.getHtml().replace(/<[^>]*>|(&nbsp;)|[\s\u3000]*/g,""))){b.style.display="";b.innerHTML="\u53d1\u8d34\u5185\u5bb9\u9700\u5305\u542b\u6587\u5b57";this._editor.focus();return false}}}var a=this._editor.getImageNum();if(a>h.imageLimite){b.style.display="";b.innerHTML="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7"+h.imageLimite+"\u5f20\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";this._editor.focus();return false}var f=this._editor.getFlashNum();if(f>h.flashLimite){b.style.display="";b.innerHTML="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u89c6\u9891\u4e0d\u80fd\u8d85\u8fc7"+h.flashLimite+"\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";this._editor.focus();return false}var g=this._editor.getSmileyNum();if(g>h.smileyLimite){b.style.display="";b.innerHTML="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u8868\u60c5\u4e0d\u80fd\u8d85\u8fc7"+h.smileyLimite+"\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";this._editor.focus();return false}var o=this._editor.getMusicNum();if(o>this._maxMusicNum){b.style.display="";b.innerHTML="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u97f3\u4e50\u6570\u4e0d\u80fd\u8d85\u8fc7"+this._maxMusicNum+"\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";this._editor.focus();return false}try{var l=this._editor.editArea,m="";if($.browser.msie){m=l.innerText}else{m=l.textContent}var j=m.getByteLength();var c=(PageData.page_id!=1)?30000:10000;if(j>c){var q="\u62b1\u6b49\uff0c\u60a8\u7684\u8d34\u5b50\u8d85\u8fc7"+(c/2)+"\u5b57\uff0c\u5efa\u8bae\u60a8\u7cbe\u7b80\u6216\u5206\u6bb5\u540e\u518d\u63d0\u4ea4";p._errorTipShow(q);return false}}catch(k){}return true},_errorTipShow:function(c){var d=this._dom_id,a=this;var b=document.getElementById(d.coError);b.style.display="";b.innerHTML=c;this._editor.focus()},_errorTipHide:function(){var a=document.getElementById(this._dom_id.coError);a.style.display="none"},_validFrsPostTitle:function(){var e=this._dom_id;var c=document.getElementById(e.title);var d=$(c),a=d.attr("data-prefix"),b=d.val().replace(/\u2006/g,"");if(b.indexOf(a)!=-1){b=b.replace(a,"")}if(c.value.trim()==""){$("#"+e.tiError).html("\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a").show();c.focus();return false}else{if(b.trim()==""){$("#"+e.tiError).html("\u53ea\u6709\u524d\u7f00\u662f\u4e0d\u884c\u7684\u54df~\u8bf7\u5728\u524d\u7f00\u540e\u586b\u5199\u6b63\u5f0f\u6807\u9898\uff01").show();return false}else{$("#"+e.tiError).hide()}}return true},_submit:function(){if(PageData.page_id===1&&PageData.thread.is_ad===1){if(document.images){var h=new Image();h.src=PageData.ecomStatDomain+"reply.php?forumid="+(PageData.forum_id||"")+"&tid="+(PageData.thread.id||"")+"&userid="+(PageData.user.id||"")+"&username="+encodeURIComponent(PageData.user_name||"")+"&exp="+encodeURIComponent(PageData.ecomExp||"")+"&t="+new Date().getTime();h=null}}if(this._isPosting){return}if(window.localVideo&&window.localVideo._showDialog){var k=window.localVideo.lDialogOp.close();if(k==false){return}}try{var i=this;var f=this._dom_id;var m=document.getElementById(f.captcha_container);var d=document.getElementById(f.signPanel);if(m.style.display=="none"&&d.style.display=="none"){i._initCaptchaAndSign(i)}}catch(j){}if(this._validator()){this._isPosting=true;this.setPostingStatus(true);var f=this._dom_id;document.getElementById(f.add_post_submit).disabled=true;document.getElementById(f.add_post_submit).className="subbtn_bg_banned";this._checkPostStatus();var c=this.getLocalVideoPostor();var b=MousePwd.report();var l=MousePwd.time;var o=MOUSEPWD_CLICK;this.setPostorData("mouse_pwd",b.c);this.setPostorData("mouse_pwd_t",l);this.setPostorData("mouse_pwd_isclick",o);var g=this._getData();var n=this;PostHandler.post(c,g,function(a){$.cookie("GET_TOPIC","-",{expires:-1,path:"/"});n.showAddResult(a)},function(a){Statistics.sendRequest("st_mod=editor&fr=tb0_forum&st_type=add_post_error&e_text="+encodeURIComponent(a?a.status:""))});return false}},getLocalVideoPostor:function(){var b=this._option.url;if(this._editor.getLocalFlashNum()>0){b=this._option.page=="frs_rich"?"/vpost/addthread":"/vpost/addpost";var a=this._editor.getFlashFileId();this.setPostorData("file_id",a);this._submitType="localVideo"}else{this.removePostorData("file_id");this._submitType=""}return b},onClickAnonym:function(){var a=this;if(a.isAnonymState){return}a.isAnonymState=true;var b=a._editor.editorPlugins.draft;if(!a.notFirstTimeHere){$("#"+a._dom_id.post_login).click(function(){if(a.isAnonymState){a._editor.toolbar.enableInsertImage();a.isAnonymState=false;if(b&&b.tip.holder.innerHTML.charAt(0)==="<"){b.tip.holder.innerHTML=""}}});a.notFirstTimeHere=true}a._editor.toolbar.disableInsertImage();if(a._editor.getImageNum()>0&&b){b.tip.holder.style.display="block";b.tip.holder.innerHTML='<span style="color:red">\u533f\u540d\u72b6\u6001\u4e0b\uff0c\u5185\u5bb9\u542b\u6709\u56fe\u7247\u5c06\u65e0\u6cd5\u53d1\u8868\u6210\u529f\uff0c\u8bf7\u5207\u6362\u5230\u975e\u533f\u540d\u72b6\u6001</span>'}},_postSuccess:function(){var d=this._dom_id,e=$("#"+d.editor_banned_tip),b="",a=this._editor,c=a.editArea;e.css({top:"120px",left:"250px"});$(c).css({backgroundColor:"#F7F7F7"});if(this._editor.empty){this._editor.empty()}b+='<div class="editor_banned_tip_info"><span class="postor_success"></span><span style="font-weight:bold;">\u53d1\u8868\u6210\u529f\uff01</span></div>';e.html(b);e.show()},_showErrorTip:function(a,d){var b='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: "\u5b8b\u4f53";"><table style="width:90%"><tbody><tr><td width="60">'+a.image+'</td><td valign="middle" style="font-size:20px;line-height:22px;font-family: "\u9ed1\u4f53";">'+a.subMessage+"</td></tr></tbody></table>"+a.message+"</div>";var c=$.dialog.alert(b,a.dialogSet);c.bind("onclose",d)},setPostingStatus:function(b){var a=this.$element.find(".j_posting_status");if(b){a.addClass("pt_posting_loading")}else{a.removeClass("pt_posting_loading")}},pickPrefix:function(b,c){var g=$('<a class="pprefix-list"></a>'),h,i=-1;function d(){g.css({width:b.outerWidth()+"px",left:b.offset().left+"px",top:(b.offset().top+b.outerHeight()-1)+"px"}).show()}function a(){i=-1;h.removeClass("pprefix-item-shine");g.hide()}function f(k){var l=b.val(),j,m=b.attr("data-prefix");if(m&&l.indexOf(m)>-1){j=l.replace(m,k)}else{j=k}b.val(j).attr("data-prefix",k);setTimeout(function(){b.trigger("focus")},100)}function e(j,k){if(j=="up"){i-1<0?i=h.length-1:i--}else{if(j=="down"){i+1==h.length?i=0:i++}else{if(j=="mouse"){i=k}}}if(!g.is(":visible")){d();i=0}h.removeClass("pprefix-item-shine").eq(i).addClass("pprefix-item-shine")}g.css({display:"none","box-sizing":"border-box"}).html(c).appendTo("body");h=g.children();b.on("click.showPPrefix",d).on("blur.hidePPrefix",a).on("keydown",function(j){switch(j.keyCode){case 8:d();break;case 40:j.preventDefault();e("down");break;case 38:j.preventDefault();e("up");break;case 13:j.preventDefault();if(i!=-1){f($(".pprefix-item-shine").html());a()}break;case 27:if(g.is(":visible")){j.preventDefault();a()}default:i=-1;a()}});g.on("mousedown.pick",".pprefix-item",function(j){f($(this).html())}).on("mouseover",".pprefix-item",function(j){e("mouse",$(this).index())})},showAddResult:function(m){if(this._option.captcha_after_post){this.setPostorData("vcode","");this.setPostorData("vcode_md5","")}this._stopCheckPostStatus();var c=this._dom_id;var n=this;var j=null;var h=function(p){switch(p.getActionType()){case p.Action_FocusTitle:try{var s=c.title;var q=document.getElementById(s);if(q){q.focus();q.value=q.value}}catch(r){}break;case p.Action_FocusContent:n._editor.focus();break;case p.Action_ClearYZM:if(n._captcha){n._captcha.clear();n._captcha.focus();n._captcha.reload()}break;case p.Action_GoToHead:document.location.hash="pgTop";break;case p.Action_FlushAndGoToHead:n._postSuccess();setTimeout(function(){var e=n.triggerEvent("onsuccess",p);if(!e){return}document.location.href=n._reloadUrl||document.location.href.split("#")[0]},800);break;default:break}};var k=null;try{k=m;Thread_add_result.init(k)}catch(g){var i=g+"___";try{i+=m.responseText;i=i.substring(0,100)}catch(g){}$.stats.sendRequest("st_mod=editor&fr=tb0_forum&st_type=add_post_json_error&e_text="+encodeURIComponent(i))}var l=Thread_add_result.resultNo;if(l==0){var a=500;n._doInputCount();setTimeout(function(){if(n._submitType=="localVideo"){var e={image:'<img style="border:none;" src="http://static.tieba.baidu.com/tb/img/messageFace.gif">',subMessage:"\u89c6\u9891\u8f6c\u7801\u4e2d",message:"\u7a0d\u540e\u8f6c\u7801\u5b8c\u6210\u540e\u8d34\u5b50\u5c06\u81ea\u52a8\u53d1\u8868\u3002\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u8c22\u8c22\uff01",dialogSet:{width:380,height:105,title:"\u53d1\u8868\u8d34\u5b50"}};n._showErrorTip(e,function(){h(Thread_add_result);document.getElementById(c.add_post_submit).disabled=false;document.getElementById(c.add_post_submit).className="subbtn_bg";n._isPosting=false;n.setPostingStatus(false);window.location.reload();return true})}else{h(Thread_add_result)}},a)}else{if(Thread_add_result.isNeedWaitForCheck()){n._doInputCount();var o=Thread_add_result.getMessage();var d={image:'<img style="border:none;" src="http://static.tieba.baidu.com/tb/img/messageFace.gif">',subMessage:"\u7b49\u5f85\u5ba1\u6838...",message:o,dialogSet:{width:380,height:105,title:"\u53d1\u8868\u8d34\u5b50"}};n._showErrorTip(d,function(){h(Thread_add_result);document.getElementById(c.add_post_submit).disabled=false;document.getElementById(c.add_post_submit).className="subbtn_bg";n._isPosting=false;n.setPostingStatus(false);window.location.reload();return true})}else{if(Thread_add_result.isNeedBindPhone()){n._doInputCount();if(TED.Storage.isSupport()){n._editor.editorPlugins.draft.set()}var f=$.dialog.alert("<div style='margin: 15px;'>"+Thread_add_result.getMessage()+"</div>",{title:"\u53d1\u8d34\u5931\u8d25",acceptValue:"\u7ed1\u5b9a\u624b\u673a",width:410,onaccept:function(){var e=location.href;if(e.indexOf("#")!=-1){e=e.substring(0,e.lastIndexOf("#"))}location.href="http://passport.baidu.com/v2/?accountbindphone&tpl=tb&u="+encodeURIComponent(e+"#sub");return false},onclose:function(){var e=document.getElementById(c.add_post_submit);e.disabled=false;e.className="subbtn_bg";n._isPosting=false;n.setPostingStatus(false)}})}else{var o=Thread_add_result.getMessage();if(l==40){if(this._option.captcha_after_post&&m.data.vcode&&m.data.vcode.need_vcode==1){if(n.captchaDialog){n._isPosting=false;n.setPostingStatus(false);n.captchaDialog.setTip(m.data.vcode.str_reason);n.captchaDialog.updateCaptchaImg(m.data.vcode.captcha_vcode_str,m.data.vcode.captcha_code_type);n.captchaDialog.show();n.captchaDialog.focus()}else{_.Module.use("common/component/CaptchaDialog",{message:m.data.vcode.str_reason,vCode:m.data.vcode.captcha_vcode_str,vCodeType:m.data.vcode.captcha_code_type,forumName:this._data_postor.kw,forumId:this._data_postor.fid,isAnonymous:n.isAnonymous,postType:n._option.post_type,paramsCallback:function(){var e=n._getData();var p={content:e.content,title:e.title};if(n._option.post_type=="reply"){p.tid=PageData.thread.id}return p}},function(e){n.captchaDialog=e;n._isPosting=false;n.setPostingStatus(false);e.bind("onclose",function(){n._isPosting=false;n.setPostingStatus(false);var p=$("#"+c.add_post_submit);p.attr("disabled",false);p.removeClass("subbtn_bg_banned").addClass("subbtn_bg");e.hide();return false});e.bind("onaccept",function(){n.setPostorData("vcode",e.getInputValue());n.setPostorData("vcode_md5",e.getVCode());n._submit()});e.show()})}}else{n._captcha.showErrorTip(o);n._captcha.clear();n._captcha.focus();n._captcha.reload();var b=$("#"+c.add_post_submit);b.attr("disabled",false);b.removeClass("subbtn_bg_banned").addClass("subbtn_bg");n._isPosting=false;n.setPostingStatus(false)}}else{var d={image:'<img style="border:none;" src="http://static.tieba.baidu.com/tb/img/errorFace.gif">',subMessage:"\u53d1\u8d34\u5931\u8d25",message:o,dialogSet:{width:410,height:95,title:"\u53d1\u8868\u8d34\u5b50"}};n._showErrorTip(d,function(){h(Thread_add_result);document.getElementById(c.add_post_submit).disabled=false;document.getElementById(c.add_post_submit).className="subbtn_bg";n._isPosting=false;n.setPostingStatus(false);return true})}}}}}};(function(){var b=window.TED["Overlay"],a=window.TED["Event"];window.TED["EditorPlugins"]["InsertSmiley"]=c;function c(e){this.container=e;this.holder=document.createElement("div");this.holder.style.position="relative";this.holder.className="insertsmiley_holder";this.container.appendChild(this.holder)}c.prototype={init:function(f){this.editor=f;var e=this;this.overlay=new b(this.holder);_.Module.use("common/component/EditorLayer",[{container:$(this.holder)}],function(g){e.editor.overlay=g;window.PAGESMILELAYER=e.editor.overlay;a.addEvent(e.holder,"click",function(i){var h=i.target||i.srcElement;if(h===e.holder){e.clickHandler(i);if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}}})})},clickHandler:function(){var f={layerPos:{left:-472,top:29},layerSize:{height:315,width:552},arrowPos:{left:472,top:-7},content:{height:313},arrowType:"arrow_up",layerType:""};var e=this;if(this.smileLayer){e.editor.overlay.toggle(f,this.smileLayer,this.editor,e.holder,"smile")}else{_.Module.use("common/component/EditorSmiley",[],function(g){e.smileLayer=g;e.editor.overlay.toggle(f,e.smileLayer,e.editor,e.holder,"smile")})}},closeOverlay:function(){this.editor.overlay.close()}};window.TED["EditorPlugins"]["WordLimit"]=d;function d(e){this.maxNum=e||130;this.holder=document.createElement("div");this.holder.className="wordlimit-holder";this.holder.style.visibility="hidden"}d.prototype={showLimit:10,checkTimer:null,checkDelay:300,isShow:false,exceed:false,init:function(e){this.editor=e;this.container=e.wrapper;this.container.appendChild(this.holder);e.on("keyup",this.handlerEvent,this);e.on("focus",this.handlerEvent,this);this.check()},handlerEvent:function(g){clearTimeout(this.checkTimer);var f=this;this.checkTimer=setTimeout(function(){f.check()},this.checkDelay)},check:function(e){var f=this.maxNum-this.editor.getContentLength();if(f<=this.showLimit){this.holder.style.visibility="visible";this.isShow=true;if(f<0){if(!this.exceed){this.editor.fireEvent("overflow");this.exceed=true}this.holder.innerHTML='\u5df2\u7ecf\u8d85\u51fa<span style="font-size:18px;font-family:Arial;color:#f00;">'+-f+"</span>\u4e2a\u5b57"}else{if(this.exceed){this.editor.fireEvent("unoverflow");this.exceed=false}this.holder.innerHTML='\u8fd8\u80fd\u8f93\u5165<span style="font-size:18px;font-family:Arial;">'+f+"</span>\u4e2a\u5b57"}}else{if(this.isShow){this.holder.style.visibility="hidden";this.isShow=false;if(this.exceed){this.editor.fireEvent("unoverflow");this.exceed=false}}}}}})();;(function(){var d=TED.EditorCore,e=TED.extend,a=TED.EditorInstanceManager,b=TED.augmentObject;window.TED["SimpleEditor"]=c;function c(f){c.superclass.call(this,f)}c.defaultConfig={height:"100px",width:"400px",maxHeight:null,autoFocus:true,autoEnable:true,autoHeight:false,wrapperClassName:"tb-simpleeditor-wrapper",editAreaClassName:"tb-editor-editarea",editAreaWrapperClassName:"tb-editor-editarea-wrapper",disabledEditAreaClassName:"tb-editor-editarea tb-editor-editarea-disabled",disabledWrapperClassName:"tb-simpleeditor-wrapper tb-simpleeditor-wrapper-disabled",imageClassName:"BDE_Image",smileyClassName:"BDE_Smiley",rootPath:"/tb/static-common/",enableRefer:true,emptyClassName:"BDE_Empty",flashClassName:"BDE_Flash",flashNumLimit:10,didaDelay:300,imageWidthLimit:570};e(c,d,{getContentLength:function(){return Math.ceil(this.filteHTML(this.editArea.innerHTML,["img","br"]).replace(/<img[^>]*>/gi,"mm").replace(/<br[^>]*>/gi,"m").replace(/&nbsp;/gi,"m").replace(/[^\x00-\xff]/g,"mm").length/2)},filteEditHTML:function(){return html=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:br)[^>]*)>","gi"),"[$1]").replace(new RegExp('<span([^>]*class="?at"?[^>]*)>',"gi"),"[span$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.emptyClassName+"|"+this.config.smileyClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:br|img|span)[^\\]]*)\\]","gi"),"<$1>")},getConfig:function(){return this.config},filteSubmitHTML:function(){this.reLayout();var g=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+this.submitValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.submitValidHTML.join("|")+"|img)[^\\]]*)\\]","gi"),"<$1>");var f=document.createElement("div");f.innerHTML=g;this.parseURL(f);return f.innerHTML}});b(c,a)})();;var SimplePostor=function(d,c){this.option=d;this._edOp_t=c;var a=PageData.user.has_grade?PageData.user.grade_level:0;this._edOp_t.bavl=a;var b=$("#"+d.tpl_id).html();this.cur_sec=c.container;this.cur_sec.innerHTML=b;var e=$(c.container);this._bc=e.find(".lzl_panel_btn");this._enabled=true;this._eh=e.find(".lzl_panel_error");this._event={};this._statInit(d._login,d._can_post,d._no_un)};SimplePostor.prototype={constructor:SimplePostor,_statInit:function(d,f,e){var a=this.option;if(!d){this._cannotPost();return}if(d&&f==1&&e){this._cannotPost();return}if(d&&f!=1){this._cannotPost();return}if(a._reach_limit){this._cannotPost();return}if(a._is_block){this._cannotPost();return}if(d&&f==1&&!e){var c=this.cur_sec;var b=$(c).find(".editor_for_container")[0];this._buildNormalEditor(b);this._postBtnInit("enble")}},_cannotPost:function(){var a=this.cur_sec;this._buildLimitedEditor(a);this._postBtnInit("disable");return},_postBtnInit:function(d){switch(d){case"disable":this._disableEditor();this._disableSmile();break;case"enble":var a=this._bc,b=this;var c=a.find("span.j_lzl_p_sm");c.css("position","relative");if(!PageData.is_ipad){this._se.addPlugin("insertsmiley",new TED.EditorPlugins.InsertSmiley(c[0]))}else{c.hide()}this._se.addPlugin("WordLimit",new TED.EditorPlugins.WordLimit(140));c=a.find("span.j_lzl_p_sb");c.hover(function(){$(this).addClass("lzl_panel_submit_hover")},function(){$(this).removeClass("lzl_panel_submit_hover lzl_panel_submit_active")});c.bind("click",function(f){$(this).addClass("lzl_panel_submit_active");b.submitClick();f.target.blur()});break}},bind:function(b,a,c){var d={stat:c?true:false,fun:a};if(this._event[b]){this._event[b].push(d)}else{this._event[b]=[];this._event[b].push(d)}},triggerEvent:function(a){if(this._event[a]){var c=this._event[a];for(var b=0;b<c.length;b++){if(c[b].fun){c[b].fun()}if(!c[b].stat){return false}}}return true},_buildLimitedEditor:function(e){var b=this;if(!b._fe){var c=$("<div>");c.addClass("lzl_simple_wrapper");var a=this._edOp_t;var d=$(b.cur_sec).find(".editor_for_container");c.css({width:b._edOp_t.width,height:b._edOp_t.height,position:"static"});c.append(b._buildLimitedInfo());b._fe=c}d.append(b._fe)},_tip:["","\u53c2\u4e0e\u672c\u5427\u8ba8\u8bba\uff0c\u8bf7\u5148 ","\u62b1\u6b49\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53ca\u6ce8\u518c\u6ee1\u4e00\u5b9a\u65f6\u95f4\u7684\u8001\u7528\u6237\u53d1\u8d34","\u62b1\u6b49\uff0c\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u5141\u8bb8","\u62b1\u6b49\uff0c\u672c\u5427\u76ee\u524d\u4ec5\u9650\u5427\u52a1\u56e2\u961f\u53d1\u8d34","\u62b1\u6b49\uff0c\u6839\u636e\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u548c\u653f\u7b56\uff0c\u672c\u5427\u76ee\u524d\u53ea\u80fd\u6d4f\u89c8\uff0c\u4e0d\u80fd\u53d1\u8d34"],_buildLimitedInfo:function(){var e=$("<p>");var c='<div class="editor_banned_tip_info">',d=this.option,b=this;if(d._reach_limit){c+="<span>\u672c\u697c\u5c42\u56de\u590d\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u53c2\u4e0e\u5176\u4ed6\u697c\u5c42\u8ba8\u8bba</span>";c+="</div>";e.html(c);e.css({margin:"14px 0 0 14px"})}else{if(d._is_block){var a=["<span>"];a.push(PageUnit.load("simple_postor_blocktippart1"));a.push(PageUnit.load("simple_postor_blocktippart2"));a.push(PageUnit.load("simple_postor_blocktippart3"));a.push("</span></div>");c+=a.join("").replace(/(href=\")(.*?)(\")/,"$1$2"+PageData.forum_id+"$3");e.html(c);e.css({margin:"14px 0 0 14px"})}else{c+="<span>";if(d._can_post==1&&d._no_un){c+="\u60a8\u8fd8\u6ca1\u6709\u7528\u6237\u540d\uff0c\u4e0d\u80fd\u56de\u590d\u3002\u8bf7\u5148<a href=\"javascript:void(0)\"  onclick=\"TbCom.process('User','buildUnameFrame','\u586b\u5199\u7528\u6237\u540d',' ')\">\u586b\u5199\u7528\u6237\u540d</a>";c+="</span>";c+="</div>";e.html(c);e.css({margin:"4px 0 0 14px"})}else{c+=b._tip[d._forum_type];c+="</span>";if(d._forum_type==1){c+='<span class="lzl_login_wrapper">';c+="<a href=\"#\" onclick=\"_.Module.use('common/component/LoginDialog', ['', 'lzl']);return false;\">\u767b\u5f55</a>";c+="&nbsp;|&nbsp";c+="<a href=\"#\" onclick=\"TbCom.process('User', 'buildRegisterFrame', 'lzl');return false;\">\u6ce8\u518c</a>";c+="</span>"}else{if(d._forum_type==3){c+='<a href="http://tieba.baidu.com/f/like/level?kw=d8" >4\u7ea7\u5934\u8854</a>\u4ee5\u4e0a\u4f1a\u5458\u53d1\u8d34\u3002'}}c+="</div>";e.html(c);if(d._forum_type==3){e.css({margin:"5px 0 0 14px"})}else{e.css({margin:"14px 0 0 14px"})}}}}return e},_buildNormalEditor:function(e){var b=this,a=b.option;var c=b._edOp_t;c.container=e;var d=new TED.SimpleEditor(c);d.on("overflow",function(){b._overFlow()});d.on("unoverflow",function(){b._unoverFlow()});d.on("keydown",function(f){b._keyDown(f)});d.on("keyup",function(f){b._keyUp(f)});b._se=d},_overFlow:function(){this._disableEditor()},_unoverFlow:function(){this._enableEditor()},_keyDown:function(a){if(a.keyCode==17){this._ctrl_down=true}else{if(a.keyCode==13&&this._ctrl_down){this.submitClick();if(a.srcElement){a.srcElement.blur()}else{a.target.blur()}}}},_disableEditor:function(){var c=this;c._enabled=false;var a=c._bc.find("span.j_lzl_p_sb");a.removeClass("lzl_panel_submit");a.html("");a.addClass("lzl_panel_submit_disabled")},_disableSmile:function(){var c=this;var a=c._bc.find("span.j_lzl_p_sm");if(PageData.is_ipad){a.hide();return}c._enabled=false;a.removeClass("lzl_panel_smile");a.html("");a.addClass("lzl_panel_smile_disabled")},_enableEditor:function(){var c=this;c._enabled=true;var a=c._bc.find("span.j_lzl_p_sb");a.removeClass("lzl_panel_submit_disabled");a.addClass("lzl_panel_submit");a.html("\u53d1\u8868")},_keyDown:function(b){var a=this;if(b.keyCode==17){a._ctrl_down=true}else{if(b.keyCode==13&&a._ctrl_down){a.submitClick();if(b.srcElement){b.srcElement.blur()}else{b.target.blur()}}}if(b.altKey&&b.keyCode==83){if(b.preventDefault){b.preventDefault()}else{b.returnValue=false}setTimeout(function(){a.submitClick()},0)}},_keyUp:function(a){if(a.keyCode==17){this._ctrl_down=false}},_ie6RelativeHack:function(){var b=this,d=$(b.cur_sec),a=this._bc;d.find("div.insertsmiley_holder").hide();var e=d.find("div.wordlimit-holder");var c=a.find("span.j_lzl_p_sm");c.css("position","static");if(e.css("visibility")!="hidden"){d.find("div.wordlimit-holder").hide();b._hint_shown=true}else{b._hint_shown=false}d.find("div.lzl_simple_wrapper").css("position","static")},_ie6RelativeRecover:function(){var b=this,d=$(b.cur_sec),a=this._bc;d.find("div.insertsmiley_holder").show();var e=d.find("div.wordlimit-holder");if(this._hint_shown){e.show()}var c=a.find("span.j_lzl_p_sm");c.css("position","relative");d.find("div.lzl_simple_wrapper").css("position","relative")},_getHtml:function(){var a=this._se.getHtml();a=a.replace(/<br[^>]*>/gi," ").replace(/[\u3000\s]+/g," ").replace(/&nbsp;/g," ");return a},_data:{},submitClick:function(){if(PageData.thread.is_ad===1){if(document.images){var b=new Image();b.src=PageData.ecomStatDomain+"reply.php?forumid="+(PageData.forum_id||"")+"&tid="+(PageData.thread.id||"")+"&userid="+(PageData.user.id||"")+"&username="+encodeURIComponent(PageData.user_name||"")+"&exp="+encodeURIComponent(PageData.ecomExp||"")+"&t="+new Date().getTime();b=null}}var a=this;var d=$(a.cur_sec),c=d.find("div.insertsmiley_holder");d.find("span.close").click();c.css("position","static");if(!this._isValid()){c.css("position","relative");return}c.css("position","relative");this._submitData()},_isValid:function(){if(!this._enabled){return false}if(this._se.isEmpty()){this._se.focus();this._eh.html("\u53d1\u8d34\u5185\u5bb9\u9700\u5305\u542b\u6587\u5b57").show();return false}if(this._se.getSmileyNum()>10){this._eh.html("\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u8868\u60c5\u4e0d\u80fd\u8d85\u8fc710\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4").show();return false}return true},_submitData:function(){this._eh.hide();this._disableEditor();var a=this;$.tb.post(FORUM_POST_URL.postAdd,a._getData(),function(b){a._setPostData("vcode","");a._setPostData("vcode_md5","");if(b.no==0){var c=a.triggerEvent("onsuccess");a._se.empty();if(a.option.__data__){a.option.data=a.option.__data__;a.option.__data__=null}a._enableEditor();var c=a.triggerEvent("hide")}else{a._showAddResult(b);a._enableEditor()}return false})},_setData:function(a){this.option.__data__=this.option.data;this.option.data=$.extend(this.option.data,a)},_setPostData:function(a,b){this._data[a]=b},_getData:function(){var f=this.option,a=f.data,b=this;b._data.kw=PageData.forum_name;b._data.fid=PageData.forum_id;b._data.tid=PageData.thread.id;b._data.floor_num=a.floor_num;b._data.quote_id=a.pid;b._data.rich_text=1;b._data.tbs=PageData.tbs;b._data.content=b._getHtml();b._data.lp_type=f._thread_topic_type;b._data.lp_sub_type=f._thread_topic_subtype;b._data.new_vcode=1;b._data.tag=11;if(a.spid!=undefined){b._data.repostid=a.spid}else{b._data.repostid=a.pid}if(b._no_un==true){b._data.anonymous=1}else{b._data.anonymous=0}try{var c=window.external.GetVersion("version");if(c.indexOf("baidubrowser")>-1){b._data.browser_version="baidubrowser"}}catch(d){}return b._data},_errorTipShow:function(b){var a=this;a._eh.html(b).show();a._se.focus()},_showAddResult:function(b){var a=this;var c=function(f){switch(f.getActionType()){case f.Action_FocusContent:a._se.focus();break;case f.Action_ClearYZM:break;case f.Action_GoToHead:break;case f.Action_FlushAndGoToHead:a._se.empty();break;default:break}};Thread_add_result.init(b);if(b.no!=0){if(Thread_add_result.isNeedWaitForCheck()){var e='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5b8b\u4f53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/messageFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ed1\u4f53&quot;;">\u7b49\u5f85\u5ba1\u6838...</td></tr></tbody></table>'+Thread_add_result.getMessage()+"</div>";var d=$.dialog.alert(e,{width:380,height:105,title:"\u53d1\u8868\u8d34\u5b50"});d.bind("onclose",function(){a._se.empty();a._se.focus();return true})}else{if(b.no==901){var e="\u672c\u697c\u5c42\u56de\u590d\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u53c2\u4e0e\u5176\u4ed6\u697c\u5c42\u8ba8\u8bba";a._errorTipShow(e)}else{if(b.no==814){var e="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u63d2\u5165\u7684\u8868\u60c5\u4e0d\u80fd\u8d85\u8fc710\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";a._errorTipShow(e)}else{if(b.no==902){var e="\u62b1\u6b49\uff0c\u6bcf\u5c42\u697c\u8f93\u5165\u7684\u6587\u5b57\u4e0d\u80fd\u8d85\u8fc7140\u4e2a\uff0c\u8bf7\u4fee\u6539\u540e\u91cd\u65b0\u63d0\u4ea4";a._errorTipShow(e)}else{if(b.no==40){if(a.captchaDialog){a.captchaDialog.setTip(b.data.vcode.str_reason);a.captchaDialog.updateCaptchaImg(b.data.vcode.captcha_vcode_str,b.data.vcode.captcha_code_type);a.captchaDialog.show();a.captchaDialog.focus()}else{_.Module.use("common/component/CaptchaDialog",{message:b.data.vcode.str_reason,vCode:b.data.vcode.captcha_vcode_str,vCodeType:b.data.vcode.captcha_code_type,forumName:a._data.kw,forumId:a._data.fid,isAnonymous:a._data.anonymous,postType:"reply",paramsCallback:function(){var f=a._getData();var g={content:f.content};g.tid=PageData.thread.id;return g}},function(f){a.captchaDialog=f;f.bind("onclose",function(){a._enableEditor();f.hide();return false});f.bind("onaccept",function(){a._setPostData("vcode",f.getInputValue());a._setPostData("vcode_md5",f.getVCode());a._submitData()});f.show()})}}else{if(Thread_add_result.isNeedBindPhone()){$.dialog.alert("<div style='margin: 15px;'>"+Thread_add_result.getMessage()+"</div>",{title:"\u53d1\u8d34\u5931\u8d25",acceptValue:"\u7ed1\u5b9a\u624b\u673a",width:410,onaccept:function(){location.href="http://passport.baidu.com/v2/?accountbindphone&tpl=tb&u="+encodeURIComponent(location.href);return false},onclose:function(){c(Thread_add_result);return true}})}else{var e='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;\u5b8b\u4f53&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;\u9ed1\u4f53&quot;;">\u53d1\u8d34\u5931\u8d25</td></tr></tbody></table>'+Thread_add_result.getMessage()+"</div>";var d=$.dialog.alert(e,{width:410,height:95,title:"\u53d1\u8868\u8d34\u5b50"});d.bind("onclose",function(){c(Thread_add_result);return true})}}}}}}}}};window.Common_GoTop=function(e){var c=false,b={id:"goTop","class":"goTop goTop_self",href:"#"},d="<style>html{_background:url(about:blank) fixed;}</style>";if($.browser.msie&&$.browser.version<7){b["class"]+=" goTop_ie6";$("body").append(d)}$("<a>").attr(b).bind("click",function(){Common_ToTop(e);return false}).appendTo("body");var f=$("#goTop");var a=$("#container").offset().left-f.width()-5;if(a<0){f.addClass("goTop_1024")}var g;setTimeout(function(){$(window).bind("scroll",function(){if(g){clearTimeout(g)}g=setTimeout(function(){if($(window).scrollTop()>0){if(!c){f.fadeIn(500);c=true}}else{if(c){f.fadeOut();c=false}}},500)})},500)};window.Common_ToTop=function(b){var d=null;var c=$(window).scrollTop();if($.browser.msie||b){window.scrollTo(0,0)}else{function a(){c=Math.floor(c/2);window.scrollTo(0,c);if(c>2){d=setTimeout(a,40)}else{window.scrollTo(0,0);clearTimeout(d)}}a()}};_.Module.define({path:"pb/component/NoAutoVideo",sub:{_configs:{},initial:function(a){if(a!=null){this._configs=$.extend(this._configs,a)}this.postWrapper=$("#j_p_postlist");this.videoElem=null;this.run()},run:function(){this._delMusic();if(PageData.is_ipad){this._delIpadFlash()}else{this._delFlash()}},_delMusic:function(){var b=this.postWrapper.find(".BDE_Music"),a=this;$.each(b,function(d,e){var f=$.tb.escapeHTML($(e).attr("src"));f=f.replace(/autoplay=false/ig,"autoPlay=true");var c=$('<img style="cursor:pointer;display:block;" src="http://tb2.bdstatic.com/tb/static-pb/img/no_music_auto.png">');$(e).replaceWith(c);c.bind("click",function(){var g=a._genericMusicImage(f);$(this).fadeOut(100,function(){$(this).replaceWith(g)})})})},_genericMusicImage:function(b){var a='<embed width="402" height="95" class="BDE_Music" src="'+b+'" scale="noborder" allowscriptaccess="never" menu="false" loop="false" play="true" wmode="transparent" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" allowfullscreen="true" style="display:block;">';return $(a)},_delIpadFlash:function(){var a=this,b=this.postWrapper.find(".BDE_Flash");$.each(b,function(d,f){if($(f).attr("id")=="voteFlash"){return true}var g=$(f).attr("vsrc"),e=null;if(g&&g!==""){g=$.tb.escapeHTML(g);e=a._getReplaceElem($(f).attr("vpic"));var c=$('<a target="_blank" href="'+g+'"></a>');c.append(e);$(f).replaceWith(c);c.bind("click",function(h){h.preventDefault();window.open($(this).attr("href"))})}else{e=$('<img src="http://tb2.bdstatic.com/tb/static-pb/img/noflash.png" alt="\u8be5\u8bbe\u5907\u6682\u4e0d\u652f\u6301\u6b64\u89c6\u9891\u64ad\u653e">');$(f).replaceWith(e)}})},_delFlash:function(){var b=this,c=this.postWrapper.find(".BDE_Flash");if(c.length<1){return}var a=true;$.each(c,function(f,i){if($(i).attr("id")=="voteFlash"){return true}var e=b._getAttrs(i);var h=e.vsrc;var g=false;if(PageData.thread.is_ad===1&&a){var j=$(i).parents("div.l_post");var d=$.parseJSON(j.attr("data-field"));if(d.content.floor==1||d.content.floor==2){g=true}else{a=false}}if(g){b.videoElem=b._getAdReplaceElem()}else{b.videoElem=b._getReplaceElem(e.vpic)}$(i).replaceWith(b.videoElem);b._bindPlayEvent(e)})},_getReplaceElem:function(a){var c,b=this;if(a){c=b._getVideoPic(a)}else{c=b._getBaiduPicElem(a)}return c},_getVideoPic:function(a){var b='<div class="vpic_wrap"><img class="vpic_img" src="'+a+'"/><span class="vpic_play"></span></div>';var c=$(b);c.hover(function(){$(this).addClass("vpic_hover")},function(){$(this).removeClass("vpic_hover")});return c},_getBaiduPicElem:function(a){var b="http://tb2.bdstatic.com/tb/static-pb/img/no_autovideo_1.png",d="http://tb2.bdstatic.com/tb/static-pb/img/no_autovideo_2.png",c=$(document.createElement("img"));c.attr("src",b);c.css("cursor","pointer");c.hover(function(){$(this).attr("src",d)},function(){$(this).attr("src",b)});return c},_getAdReplaceElem:function(){var c=$(document.createElement("div"));c.attr({id:"ad_video_area","class":"ad_video_area"});var b=$('<div class="ad_video_bg"></div>');b.css({background:"url('"+(PageData.thread.video_url||"")+"')"});var a=$('<div class="ad_play_btn"></div>');c.append(b).append(a).append($('<div class="ad_play_bar"></div>'));c.hover(function(){a.css({"background-position":"0 -64px"})},function(){a.css({"background-position":"0 0"})});c.bind("click",function(){if(document.images){var d=new Image();d.src=PageData.ecomStatDomain+"video.php?page=pb&forumid="+(PageData.forum_id||"")+"&tid="+(PageData.thread.id||"")+"&t="+new Date().getTime();d=null}});return c},_getAttrs:function(b){var a={};a.src=$.tb.escapeHTML($(b).attr("src"));a.width=$(b).attr("width");a.height=$(b).attr("height");a.scale=$(b).attr("scale");a.allowscriptaccess=$(b).attr("allowscriptaccess");a.menu=$(b).attr("menu");a.loop=$(b).attr("loop");a.play=$(b).attr("play");a.wmode=$(b).attr("wmode");a.type=$(b).attr("type");a.pluginspage=$(b).attr("pluginspage");a.allowfullscreen=$(b).attr("allowfullscreen");a.flashvars="playMovie=true&auto=1&adss=0&isAutoPlay=true";a.vsrc=$.tb.escapeHTML($(b).attr("vsrc")||"");a.vpic=$.tb.escapeHTML($(b).attr("vpic")||"");return a},_bindPlayEvent:function(b){var a=this,c=a.videoElem;if($.browser.msie){c.bind("click",function(){var e;var d=b.src.match(/[\w]+\.[\w]+(?=\/)/i)[0];if(d!=null&&d.indexOf("cntv")>=0){e=$(a._createVideoTagForOtherBrowser(b))}else{e=$(a._createVideoTagForIEBrowser(b))}$(this).replaceWith($(e));$(e).css("display","block");a._clickStats(b.src)})}else{c.bind("click",function(){var d=a._createVideoTagForOtherBrowser(b);var e=$(d);$(this).replaceWith($(e));$(e).css("display","block");a._clickStats(b.src)})}},_createVideoTagForOtherBrowser:function(a){var b=new Array();b.push('<embed type="'+a.type+'" ');b.push(' class="BDE_Flash"');b.push(' src="'+a.src+'"');b.push(' width="'+a.width+'"');b.push(' height="'+a.height+'"');b.push(' scale="'+a.scale+'"');b.push(' allowscriptaccess="never"');b.push(' menu="'+a.menu+'"');b.push(' loop="'+a.loop+'"');b.push(' play="true"');b.push(' womode="'+a.wmode+'"');b.push(' pluginspage="'+a.pluginspage+'"');b.push(' allowfullscreen="true"');b.push(' flashvars="'+a.flashvars+'"');b.push(' style="visibility:visible;">');b.push("</embed>");return b.join("")},_createVideoTagForIEBrowser:function(c){var b=this;var e='<object style="visibility:visible" class="BDE_Flash" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,22,0" width="'+c.width+'" height="'+c.height+'">';var a=new Array();a.push('<param name="FlashVars" value="'+c.flashvars+'">');a.push('<param name="Movie" value="'+c.src+'">');a.push('<param name="Src" value="'+c.src+'">');a.push('<param name="WMode" value="Transparent">');a.push('<param name="Play" value="0">');a.push('<param name="Loop" value="-1">');a.push('<param name="Quality" value="High">');a.push('<param name="Menu" value="0">');a.push('<param name="AllowScriptAccess" value="never">');a.push('<param name="Scale" value="NoScale">');a.push('<param name="DeviceFont" value="0">');a.push('<param name="EmbedMovie" value="0">');a.push('<param name="BGColor" value="">');a.push('<param name="MovieData" value="">');a.push('<param name="AllowNetworking" value="all">');a.push('<param name="AllowFullScreen" value="true">');a.push(b._createVideoTagForOtherBrowser(c));var d=a.join("");return e+d+"</object>"},_clickStats:function(c){var a=c.match(/http:\/\/([^\/]*)\/.*/);if(a!=null&&a[1]!=null){var b=a[1];$.stats.sendRequest("fr=tb0_forum&st_type=videoclick&st_mod=pb&provider="+b)}}}});_.Module.define({path:"pb/component/UserVerify",sub:{pointCutConfig:null,initial:function(){if(PageData.is_uber){this.pointCutConfig=[];if(PageData.thread.thread_type!=1){this.pointCutConfig=this.pointCutConfig.concat([{target:"pb/widget/ForumTitle/Favthread",method:"excute_open_remind",loginframe_mark:"pbfavt"},{target:"pb/widget/ForumTitle/Favthread",method:"excute_open_kept",loginframe_mark:"pbfavt"},{target:"pb/widget/ForumTitle/Favthread",method:"excute_cancel_remind",loginframe_mark:"pbfavt"},{target:"pb/widget/ForumTitle/Favthread",method:"excute_cancel_kept",loginframe_mark:"pbfavt"},{target:"pb/widget/ForumTitle/Favthread",method:"handler_clickmain",loginframe_mark:"pbfavt"}])}}else{this.pointCutConfig=[{target:"pb/component/Posts/Concern",method:"excute",loginframe_mark:"concern"},{target:"pb/component/Posts/Concern",method:"cancel",loginframe_mark:"concern"}]}this.init()},init:function(){$.each(this.pointCutConfig,function(b,a){_.Module.aop("around",{target:a.target,method:a.method},function(c){if(PageData.user.is_login){return c.proceed()}else{TbCom.process("User","buildLoginFrame",null,null,null,a.loginframe_mark||"")}})})}}});(function(){var c=["\u541e\u566c\u661f\u7a7a","\u906e\u5929","\u6b66\u52a8\u4e7e\u5764","\u51e1\u4eba\u4fee\u4ed9\u4f20","\u795e\u5370\u738b\u5ea7","\u50b2\u4e16\u4e5d\u91cd\u5929","\u5c06\u591c","\u6740\u795e","\u5723\u738b","\u957f\u751f\u4e0d\u6b7b"];var a="THREAD_PAGE_TIMES";var d=function(){var f=PageData.thread.id;$("ul.l_posts_num").delegate("a","click",function(n){var o=$.cookie(a);var m={},l=null,j="",h=true;if(o){if(o.indexOf("@3")>0){return}l=o.split("|");for(var k=0,g=l.length;k<g;k++){j=l[k].split("@");m[j[0]]=j[1]}}if(!m[f]){m[f]=1}else{m[f]++;if(m[f]==3){b($(this).attr("href"));h=false}}e(m);return h})};var e=function(i){var f=[],h;for(var g in i){h=[g,"@",i[g]].join("");f.push(h)}$.cookie(a,f.join("|"))};var b=function(f){var i=new $.modal();i.show();var g=$("#lzonly_cntn");var h=$('<div><div class="lzonly_tip"></div><div class="iknow_btn"></div><div class="lzonly_tip_close"></div></div>');h.css({position:"absolute","z-index":$.getzIndex,left:g.offset().left-190,top:g.offset().top-10});$("body").append(h);$(window).scrollTop(0);$("div.iknow_btn,div.lzonly_tip_close").bind("click",function(){h.remove();i.remove();location.href=f});$(window).bind("resize",function(){h.css({left:g.offset().left-190})})};if(!PageData.is_login&&PageData.is_lzl==1&&PageData.is_uber&&$.inArray(PageData.forum_name,c)!=-1){d()}})();(function(d,e){var c;var b=function(){c=e.setInterval(function(){var f=(typeof(e.bdPass_api_loginLite_loaded)!="undefined");if(f){e.clearInterval(c);c=null;var g=PageData.user.is_login;if(!g){bdPass.api.loginLite.getSuggestFormIndexArray(1);TbCom.process("User","buildLoginFrame",null,null,null,"recallmaillogin")}}},200)};var a=d.tb.getDecodedSearch("src");if(a=="recallmail"){d(b)}})(jQuery,window);function HourGlass(c,b,a){this.hasEntered=false;this.beatId="";this.rate=c?c:20,this.paras=b;this.isActive=a||PageData.user.is_login}HourGlass.prototype={constructor:HourGlass,init:function(){if(this.isActive){$("body").bind("mouseover",{obj:this},function(a){a.data.obj.enter()});$("body").bind("mouseleave",{obj:this},function(a){a.data.obj.leave()})}},parasToQuery:function(){var b="";for(var a in this.paras){b+=a+"="+this.paras[a]+"&"}return b.substr(0,b.length-1)},enter:function(){if(!this.hasEntered){this.hasEntered=true;this.startBeat()}},leave:function(){if(this.hasEntered){this.hasEntered=false;this.stopBeat()}},startBeat:function(){var a=this;this.beatId=setInterval(function(){a.beat()},a.rate*1000)},stopBeat:function(){clearInterval(this.beatId)},beat:function(){var a=new Image();window["bd_hg2_"+(new Date().getTime())]=a;a.src="http://static.tieba.baidu.com/tb/img/hg/hg.gif?"+this.parasToQuery()+"&t="+new Date().getTime();a=null}};var PopWidowHandle=function(b){var a={url:{P_GET:"/app/pop/bws/popup",P_POST:"/app/pop/commit/click"},delay:15,from_forum:"",page:""};this._option=$.extend(true,a,b);this._init()};PopWidowHandle.prototype={constructor:PopWidowHandle,_init:function(){var a=this;$(document).ready(function(){setTimeout(function(){a._getPopWindow()},a._option.delay*1000)})},_getPopWindow:function(){var b=this._option,a=this;$.tb.get(b.url.P_GET,{from_forum:b.from_forum,position:b.page},function(c){if(c.no==0){if(c.data.task_id){a._showPopWindow(c.data)}}})},_showPopWindow:function(d){this.data=d;var a=this._option;var c={styleId:d.style_id,templateObj:{title:d.title,content:d.content,button:d.button,note:d.note,link:d.link}};this.popWindow=new PopWindow(c);var b=this.popWindow;b.bind("closeSuccess",function(){$.tb.post(a.url.P_POST,{task_id:d.task_id,type:1,count:d.count},function(){})},true);b.bind("clickBtn",function(){$.tb.post(a.url.P_POST,{task_id:d.task_id,type:2,count:d.count},function(){})},true);b.showPop()}};_.Module.define({path:"common/component/dimension_code_yl",sub:{_srcs:{common:PageUnit.load("dimension_code_yl_img_src")},_urls:{common:PageUnit.load("dimension_code_yl_img_url")},_isclosed:false,_first_class:"",_product:"",initial:function(b,c){var a=$.cookie("dimension_code_yl");this._first_class=b;this._product=c;if(a){return}else{this._buildDialogHTML()}if(document.body.clientWidth>1024){$("#j_dimension_yl").show()}else{$("#j_dimension_yl").hide()}},_initEvents:function(b){var a=this;var c=b;$(window).resize(function(){if(document.body.clientWidth>1024){$("#j_dimension_yl").show()}else{$("#j_dimension_yl").hide()}});$("#j_dimension_yl").on("mouseover",function(){}).on("mouseout",function(){}).on("click",function(){if(a._first_class==0){$.stats.sendRequest("fr=tb0_forum&st_mod=youliao&st_type=erweima_location")}else{if(a._first_class==1){$.stats.sendRequest("fr=tb0_forum&st_mod=youliao&st_type=erweima_university")}}}).delegate(".dimension_code_yl_out_close","click",function(d){if(d&&d.preventDefault){d.preventDefault()}else{window.event.returnValue=false}$.cookie("dimension_code_yl","true",{expires:3,path:"/"});$("#j_dimension_yl").hide();return false})},_buildDialogHTML:function(){var c=this._srcs.common;var b=this._urls.common;var a=[];a.push('<a id="j_dimension_yl" class="dimension_code_yl dimension_code_yl_old" href="'+b+'" target="_blank" style="display: inline;">');a.push('<div class="dimension_code_yl_span_mid">');a.push('<div class="dimension_code_yl_span_mid_title">\u6709\u804a\u5ba2\u6237\u7aef</div>');a.push('<img src="'+c+'">');a.push('<div class="dimension_code_yl_span_mid_text">\u6700\u8fd1\u8d34\u5427\u8d85\u6d41\u884c</div>');a.push("</div>");a.push('<div class="dimension_code_yl_out_close" >&nbsp;</div>');a.push("</a>");$("body").append(a.join(""));this._initEvents(b)}}});$(function(){if(!this.imgLikeAction){var b="fr=tb_pb_fav";var a={sourceURL:"http://tieba.baidu.com/p/"+PageData.thread.id,tags:"\u767e\u5ea6\u8d34\u5427,"+PageData.forum.name+"\u5427",descript:$.tb.subByte(PageData.thread.title,40,""),no_pic_pb:PageData.isPicBa?false:true,area:[{container:"#j_p_postlist",tag:".BDE_Image",offset:{x:-4,y:5},minSize:{width:170,height:80}},{container:"#j_p_postlist",tag:".j_user_sign",offset:{x:-4,y:5},minSize:{width:170,height:80}}]};this.imgLikeAction=new ImgLikeAction(a,PageData.user.is_login,PageData.user.no_un)}});