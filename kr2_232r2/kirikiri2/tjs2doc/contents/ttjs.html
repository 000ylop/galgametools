<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<!-- generated by to_html.pl from ttjs.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" />
	<title>tTJS</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="吉里吉里関連リファレンス用標準スタイル" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="トップページ" />
</head>
<body>
<h1><a id="id384" name="id384">tTJS とは</a>
</h1><div class="para"><div>
　TJS2 スクリプトエンジンのクラスです。このクラスのオブジェクトを通して TJS2 を操作することができます。<br />
</div></div>
<h1><a id="id385" name="id385">コンストラクタ</a>
</h1><div class="para"><div>
　tTJS のコンストラクタに引数はありません。<br />
　tTJS のオブジェクトは自動変数として作成できません。かならず new 演算子を用いて作成する必要があります。<br />
　作成直後の 参照カウンタは 1 になっています。これはそのまま Release メソッドを呼べば tTJS のオブジェクトが解放されると言うことです。<br />
</div></div>
<h1><a id="id386" name="id386">デストラクタ</a>
</h1><div class="para"><div>
　tTJS のデストラクタは保護部にあり、アクセスできません。<br />
　tTJS のオブジェクトを解放するには Release メソッドを使ってください。<br />
　また、tTJS のオブジェクトを解放する前には Shutdown メソッドを呼ぶことが推奨されます。<br />
</div></div>

<h1><a id="id387" name="id387">AddRef</a>
</h1><div class="para"><div>
void tTJS::AddRef()<br />
<br />
　TJS2 スクリプトエンジンの参照カウンタをインクリメントします。</div></div>
<h1><a id="id388" name="id388">Release</a>
</h1><div class="para"><div>
void tTJS::Release()<br />
<br />
　TJS2 スクリプトエンジンの参照カウンタをデクリメントします。<br />
　参照カウンタが 0 になれば tTJS オブジェクトは解放されます。</div></div>
<h1><a id="id389" name="id389">Shutdown</a>
</h1><div class="para"><div>
void tTJS::Shutdown()<br />
<br />
　スクリプトエンジンのシャットダウンを行います。<br />
<br />
　TJS2 スクリプトエンジンを解放するとき、Release メソッドの前にこのメソッドを呼ぶことを推奨します。<br />
</div></div>

<h1><a id="id390" name="id390">GetGlobal</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobal()<br />
<br />
　<a id="id391" name="id391" class="targanchor"><dfn>global オブジェクト</dfn></a>を取得します。<a target="main" class="jump" href="interface.html">iTJSDispatch2 インターフェース</a> 型のオブジェクトが返されます。<br />
　このメソッドは global オブジェクトを返すとき、その参照カウンタをインクリメントします。<br />
</div></div>



<h1><a id="id392" name="id392">GetGlobalNoAddRef</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobalNoAddRef()<br />
<br />
　global オブジェクトを取得します。GetGlobal と違うのは、global オブジェクトの参照カウンタをインクリメントしないと言うことです。<br />
</div></div>



<h1><a id="id393" name="id393">SetConsoleOutput</a>
</h1><div class="para"><div>
void tTJS::SetConsoleOutput(iTJSConsoleOutput *console);<br />
<br />
　<a id="id394" name="id394" class="targanchor"><dfn>コンソール</dfn></a>の出力先を指定します。<br />
　コンソールは、TJS2 の出すエラーメッセージなどが出力されるところです。<br />
<br />
以下の引数があります。<br />
<br />
<dl>
<dt>console</dt>
<dd>　コンソールの出力先を定義する、<a id="id395" name="id395" class="targanchor"><dfn>iTJSConsoleOutput</dfn></a> 型のオブジェクトを指定します。<br />
　iTJSConsoleOutput 型は tjs.h に定義されている基本抽象クラスで、以下のメソッドがあります。<br />
<br />
<dl>
<dt>void iTJSConsoleOutput::<a id="id396" name="id396" class="targanchor"><dfn>ExceptionPrint</dfn></a>(const tjs_char *msg)</dt>
<dd>　例外に関する情報を出力するためのメソッドです。msg がメッセージを表します。</dd>
<dt>void iTJSConsoleOutput::<a id="id397" name="id397" class="targanchor"><dfn>Print</dfn></a>(const tjs_char *msg)</dt>
<dd>　その他の情報を出力するためのメソッドです。msg がメッセージを表します。</dd></dl></dd></dl>
</div></div>

<h1><a id="id398" name="id398">GetConsoleOutput</a>
</h1><div class="para"><div>
tTJSConsoleOutput * tTJS::GetConsoleOutput() const<br />
<br />
　コンソールの出力先を取得します。<br />
</div></div>

<h1><a id="id399" name="id399">OutputToConsole</a>
</h1><div class="para"><div>
void tTJS::OutputToConsole(const tjs_char *msg) const<br />
<br />
　コンソールに文字列を出力します。msg は出力するメッセージです。<br />
</div></div>


<h1><a id="id400" name="id400">OutpuExceptionToConsole</a>
</h1><div class="para"><div>
void tTJS::OutpuExceptionToConsole(const tjs_char *msg) const<br />
<br />
　コンソールに例外の文字列を出力します。msg は出力するメッセージです。<br />
</div></div>



<h1><a id="id401" name="id401">OutputToConsoleWithCentering</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleWithCentering(const tjs_char *msg, tjs_uint width) const<br />
<br />
　コンソールに文字列をセンタリングして出力します。msg は出力するメッセージで、width は横幅です。<br />
　横幅よりも出力するメッセージの文字数が少ない場合は、指定した横幅の中央にセンタリングして出力します
 ( ただしすべての文字の幅を同一であると見なすため、全角が混じると崩れた表示になります )</div></div>





<h1><a id="id402" name="id402">OutputToConsoleSeparator</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleSeparator(const tjs_char *text, tjs_uint count) const<br />
<br />
　text で示された区切り記号を、count 個、コンソールに出力します。</div></div>




<h1><a id="id403" name="id403">Dump</a>
</h1><div class="para"><div>
void tTJS::Dump(tjs_uint width = 80) const<br />
<br />
　TJS2 の状態をコンソールに出力します。<br />
　各スクリプトブロック中の仮想マシンコードの逆アセンブル結果などが表示されます。<br />
　width には出力する横幅を指定します。</div></div>


<h1><a id="id404" name="id404">ExecScript</a>
</h1><div class="para"><div>
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　スクリプトを実行します。<br />
<br />
　以下の引数があります。<br />
<br />
<dl>
<dt>const tjs_char *script</dt>

<dt>const ttstr &amp;script</dt>
<dd>　実行するスクリプトを指定します。</dd>


<dt>tTJSVariant *result</dt>
<dd>　結果を受け取るための tTJSVariant 型の変数へのポインタを指定します。<br />
　NULL も指定できますが、NULL の場合は結果を受け取ることができません。</dd>
<dt>iTJSDispatch2 *context</dt>
<dd>　このスクリプトが実行されるコンテキストを指定します。<br />
　NULL を指定すると、スクリプトは global コンテキスト上で実行されます。<br />
　通常は NULL を指定しますが、スクリプトを特定のコンテキストで実行したい場合はそのコンテキストとなるオブジェクトを指定してください。</dd>


<dt>const tjs_char *name</dt>
<dd>　スクリプトの名前を指定します。通常、そのスクリプトのファイル名を指定します。<br />
　例外の通知の際にどこのスクリプトで例外が起こったかを知らせたりする目的で使用されます。</dd>

<dt>tjs_int lineofs</dt>
<dd>　スクリプト中の、そのスクリプトの始まった行(0〜)を指定します。<br />
　KAGシナリオ中に埋め込まれたTJSスクリプトのように、他のドキュメント中にTJSスクリプトが埋め込まれる場合に、そのTJSスクリプトの開始行を指定します。<br />
　例外の通知の際にどこのスクリプトで例外が起こったかを知らせたりする目的で使用されます。</dd>


</dl></div></div>

<h1><a id="id405" name="id405">EvalExpression</a>
</h1><div class="para"><div>
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　式を評価します。<br />
　引数については ExecScript を参照してください。<br />
<br />
　<a id="id406" name="id406" class="targanchor"><dfn>if 演算子</dfn></a>のように式の結果を得ることができない演算子の場合、その結果を得ようとして result に非 NULL を指定すると例外が発生します。この場合は result には NULL を指定する必要があります。</div></div>




<h1><a id="id407" name="id407">SetPPValue</a>
</h1><div class="para"><div>
void tTJS::SetPPValue(const tjs_char *name, const tjs_int32 value)<br />
<br />
　<a id="id408" name="id408" class="targanchor"><dfn>条件コンパイル</dfn></a>用の変数を設定します。name は変数の名前、value は設定する値です。<br />
</div></div>



<h1><a id="id409" name="id409">GetPPValue</a>
</h1><div class="para"><div>
tjs_int32 tTJS::GetPPValue(const tjs_char *name)<br />
<br />
　条件コンパイル用の変数を取得します。name は変数の名前です。変数が見つからなかった場合は 0 が帰ります。<br />
</div></div>




<h1><a id="id410" name="id410">DoGarbageCollection</a>
</h1><div class="para"><div>
tjs_int32 tTJS::DoGarbageCollection()<br />
<br />
　<a id="id411" name="id411" class="targanchor"><dfn>ガベージコレクション</dfn></a>を行います。TJS2 が保持しているキャッシュをクリアしたり、未処理のクリーンアップ処理を完了させます。<br />
</div></div>
	<script type="text/javascript" charset="Shift_JIS" src="documentid.js" ></script>
	<script type="text/javascript" charset="Shift_JIS" src="postcontent.js" ></script>
</body>
</html>
