ExtractData 1.20β5

制作者: Y羽
http://twin.tn.st/

_kh境:
Windows XP SP2, Core2Duo E6700, メモリ2GB
Visual C++ 2005 Express Edition SP1

幼鳝h境:
Windows XP

XPでのみ幼鞔_Jを行っています。
2000やVistaでも婴かもしれません。

Windows 98/Meについてはサポ`ト象外とします。


■はじめに

主にえろげのア`カイブファイルを展_するツ`ルです。
曜rについては「State.txt」を参照してください。

抽出したデ`タについては私的利用の欷虺えないようにしてください。


■使い方

メニュ`バ`の [ファイル] -> [ファイルを_く] で展_したいア`カイブファイルを_きます。
ウィンドウにドラッグ＆ドロップしても_けます。

そのファイルに辘筏皮い欷啸辚攻趣衰榨ˉぅ毪沃猩恧表示されます。

辘筏皮い胜龊悉仕鞔_Jダイアログが表示されます。
「はい」をクリックすると、AHX、BMP、JPG、MID、MPG、OGG、PNG、WAV、WMVをア`カイブファイル内から探します。

xkしたファイルだけを抽出するときは、リストに表示されているファイルをxkして、[抽出] -> [xk欷虺槌] で抽出します。
全てのファイルを抽出するときは、[抽出] -> [すべて抽出] で抽出します。
右クリックメニュ`からでも抽出できます。

[Qせずにxk欷虺槌] や [Qせずにすべて抽出] で抽出を行うと、ファイルのQが行われず、ア`カイブに格{されているままの状Bで抽出できます。
デバッグのときなどにご使用ください。
なお、Susieプラグインで_いたものにしては抗はありません。仕です。

xkしたファイルをダブルクリックすると、E?再生が出来ます。
E?再生元のファイルはテンポラリフォルダに出力されます。


■メニュ`目のh明

?ファイル
[ファイルを_く] …… ア`カイブファイルを_きます。
[]じる] …… _いているア`カイブファイルを]じます。
[K了] …… ExtractDataをK了します。

?抽出
[xk欷虺槌] …… xkしたファイルだけを抽出します。
[すべて抽出] …… 全てのファイルを抽出します。
[Qせずにxk欷虺槌] …… xkしたファイルだけをQせずに抽出します。
[Qせずにすべて抽出] …… 全てのファイルをQせずに抽出します。

?O定
[オプション] …… オプションダイアログを表示します。

?ヘルプ
[Readme.txt] …… Readme.txt(今ているもの)を_きます。
[History.txt] …… History.txtを_きます。
[State.txt] …… State.txtを_きます。
[バ`ジョン情] …… ExtractDataのバ`ジョンが_J出来ます。


■オプション目のh明

[基本O定]

?リストのO定
ファイル情螭虮硎兢工毳辚攻趣伪尘吧と文字色をO定します。
色の指定方法はRGBを16M数で述してください。RRGGBB形式です。

?仕鳏工毳榨ˉぅ
辘筏皮い胜ぅ`カイブファイルから、どのNのファイルを探すかをO定します。
ア`カイブされているファイルがわかっている龊悉摔稀それのみにチェックすることを推Xします(速度的な意味で)。

?仕骶度
OGGを"OggS"のみで探すか、もう少しチェックして探すかをO定します。
`食訾蚍坤挨郡帷⑵斩韦仕骶度を上げておくことを推Xします。


[抽出O定]

?フォルダごと抽出する
抽出するファイルのファイル名にフォルダ名が含まれている龊稀フォルダも生成します。

?OGGファイルのCRCを修正する
Ogg Vorbisファイル抽出rにCRCを修正して抽出します。
CRCを修正することで、CRC不一致により再生できないOgg Vorbisを再生できるようになるかもしれません。
普段はo郡摔筏皮くことを推Xします。

?易秃C能を有郡摔工
暗号化されているファイルにしてgな秃I理を施します。
今のところ、bmp、jpg、mpg、ogg、png、tlg、吉里吉里のスクリプトファイルのみが象です。
`幼鳏筏浃工い郡帷⑵斩韦o郡摔筏皮くことを推Xします。

?出力画像形式
出力する画像のファイル形式です。
PNGを指定すると画像抽出rの速度は落ちますが、ファイル容量を抑えられます。
Rsレベルは0がoRsで、9が最高Rsとなっています。
なお、元々のファイルがJPGやPNGの龊悉稀JPGやPNGのまま出力されます。

?αブレンドを行う
O定した背景色とアルファブレンドを行い、24bitで出力します。
アルファが必要な龊悉o郡摔筏皮ださい。

?背景色
アルファブレンドrに使用する背景です。
色の指定方法はRGBを16M数で述します。RRGGBB形式です。

?高速にI理する
アルファブレンドのI理をMMXを使用して高速にI理します。
ただし、MMXの仕(除算ができない)により、通常の速度でアルファブレンドした龊悉冉Y果が少しなります。
急いでいる龊悉韦哂郡摔工毪长趣蛲Xします。

?出力先
「盎刂付à工搿龊稀⒊槌訾蛐肖Δ郡婴顺隽ο趣蛑付à工毳昆ぅログが表示されます。
「入力先と同じフォルダ」の龊稀㈤_いたファイルがある鏊に、_いたファイルと同名のフォルダを作成し、その中に出力します。格{されているファイルが1つの龊悉稀その鏊と同名のフォルダを作成します。
「下のフォルダ」の龊稀⑾掠で指定したフォルダに出力します。

?バッファサイズ
ファイルを抽出するHに使用するメモリの大きさです。KBg位で指定します。
大きいほどメモリを消Mしますが、HDDにしくなる、ような荬します。

?テンポラリフォルダ
ダブルクリックでE?再生した龊悉恕⒁r的に抽出する鏊です。
一r的に抽出されたファイルは、ア`カイブファイルを_いたときや、ExtractDataをK了したときに削除されます。
削除できなかったファイルは「TmpFileList.txt」にhされ、次回削除されます。


[SusieO定]

?Susieプラグインを使用する
Susieプラグインを使用してファイルを_いたり抽出したりします。
なお、プラグインがiみzまれるタイミングは、ExtractData起rと、更新ボタンを押したときだけです。
Susieプラグインを使用しない龊悉膝抓楗哎ぅ螭握iみzみは行われません。

?Susieプラグインを先する
内iエンジンよりも先にSusieプラグインを使用して_いたり抽出したりします。
Susieプラグインの方がれている龊悉耸褂盲筏皮ださい。

?各プラグインのON/OFF
リストに表示されているファイルがF在iみzまれているSusieプラグインです。
チェックの有oによりプラグインの使用をO定できます。
他のプラグインが邪魔で正常に_けないときなどに使用してください。

?Susieプラグイン自身のO定
青色で表示されているプラグインはO定ダイアログをg装したプラグインです。
右クリックメニュ`からO定を呼び出すことが可能です。


■ショ`トカットキ`一E

Ctrl+O …… ファイルを_く
Ctrl+W …… ]じる
Ctrl+Q …… K了

Ctrl+S …… xk欷虺槌
Ctrl+Shift+S …… すべて抽出

Ctrl+E …… オプション

Ctrl+A …… すべてxk


■アンインスト`ル方法

フォルダごと削除してください。
レジストリには一切きzんでいません。


■蟾娴趣摔膜い皮巫⒁

バグ蟾妞摔膜い皮洗Z迎です。
そのHはバグが出たときの状r(どのような操作を行ったかなど)をできるだけしくいていただけると、こちらでもバグを容易に再Fでき、修正しやすくなります。

幼蟾妞摔膜い皮膝榨ˉぅ仕C能を使わずに_けたもののみ受け付けます。キリがない荬するので。
NScripterや吉里吉里を使用しているタイトルについては蟾妞丹欷皮辚辚攻趣溯dせません。というかdせ切れません。
ただし、tpmで暗号化されているタイトルは例外です。正常に抽出できた龊悉悉蟾妞ださい。リストにdせます。

リクエストについては受け付けておりません。
荬向いたときにしか解析しません。

ExtractData自体にするC能追加?改善等は受け付けます。
フレ`ムワ`クが完成するまではほいほいとg装できませんが。


■x辞

?nwa -> wavQに jagarl 氏の nwatowav のソ`スを参考にしました。
?XP3ア`カイブの展_に にっくる 氏の xp3dec のソ`スを参考にしました。
?MELTY BLOODのア`カイブ展_に hikobae 氏の mbextract のソ`スを参考にしました。
?最KYくじらのcpsの秃扭 hikobae 氏の Isana のソ`スを参考にしました。
?DSCとCompressedBGの秃扭 十一寒月 氏の nr のソ`スを参考にしました。
?FilePackVer1.0と2.0の展_に 十一寒月 氏の gage のソ`スを参考にしました。
?CPZ1とCPZ2の展_に 十一寒月 氏の cpz のソ`スを参考にしました。
?iarの画像展_に 十一寒月 氏の iar のソ`スを参考にしました。
?FilePackVer3.0の展_に asmodean 氏の exfp3 のソ`スを参考にしました。
?PS2版CLANNADの音声抽出に 191 氏の decahx のソ`スや、258 氏の makekoe のソ`スを参考にしました。
?rct/rc8の秃扭 Peter Jolly 氏の MAJIRO用のSusieプラグイン のソ`スを参考にしました。
?SummerDaysのア`カイブ展_に sdsplit のソ`スを参考にしました。
?TCD3のSPDC解訾 asmodean 氏の extcd3 のソ`スを参考にしました。
?アイコンを おとと 氏に作成していただきました。
上の件につきまして、この訾蚪瑜辘朴礼申し上げます。ありがとうございました。


■著作

?OGGのCRC修正C能は、Xiph.org Foundationが作成?配布しているソ`スを使って作られています。
?nbzの解訾稀Julian R Seward 氏の bzip2 のソ`スを使って作られています。


■今後の予定

?プレビュ`C能のg装
?フォルダiみzみC能のg装
?ファイル名仕C能のg装
?ファイル情螗偿冤`C能のg装
?MFCLフレ`ムワ`クの_k?Mz
?YKGのマスク合成
?dltの解析
?voice.datの解析